<?xml version="1.0" encoding="utf-8"?>
<DataSchemaModel FileFormatVersion="1.2" SchemaVersion="2.4" DspName="Microsoft.Data.Tools.Schema.Sql.Sql120DatabaseSchemaProvider" CollationLcid="1033" CollationCaseSensitive="False" xmlns="http://schemas.microsoft.com/sqlserver/dac/Serialization/2012/02">
	<Header>
		<CustomData Category="AnsiNulls">
			<Metadata Name="AnsiNulls" Value="True" />
		</CustomData>
		<CustomData Category="QuotedIdentifier">
			<Metadata Name="QuotedIdentifier" Value="True" />
		</CustomData>
		<CustomData Category="CompatibilityMode">
			<Metadata Name="CompatibilityMode" Value="120" />
		</CustomData>
		<CustomData Category="Reference" Type="Assembly">
			<Metadata Name="LogicalName" Value="WhereToBuy.sqldatabase.dll" />
			<Metadata Name="FileName" Value="C:\USERS\MARTA\DOCUMENTS\MARTA\PROJETOSTIC\WHERETOBUY\WHERETOBUY.SQLDATABASE\OBJ\DEBUG\WHERETOBUY.SQLDATABASE.DLL" />
			<Metadata Name="AssemblyName" Value="WhereToBuy.sqldatabase" />
			<Metadata Name="PermissionSet" Value="SAFE" />
			<Metadata Name="Owner" Value="" />
			<Metadata Name="GenerateSqlClrDdl" Value="True" />
			<Metadata Name="IsVisible" Value="True" />
			<Metadata Name="IsModelAware" Value="True" />
			<Metadata Name="SkipCreationIfEmpty" Value="True" />
			<Metadata Name="AssemblySymbolsName" Value="C:\Users\Marta\Documents\Marta\ProjetosTic\WhereToBuy\WhereToBuy.sqldatabase\obj\Debug\WhereToBuy.sqldatabase.pdb" />
		</CustomData>
		<CustomData Category="SqlCmdVariables" Type="SqlCmdVariable" />
	</Header>
	<Model>
		<Element Type="SqlDatabaseOptions">
			<Property Name="Collation" Value="SQL_Latin1_General_CP1_CI_AS" />
			<Property Name="IsAnsiNullDefaultOn" Value="True" />
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="IsAnsiWarningsOn" Value="True" />
			<Property Name="IsArithAbortOn" Value="True" />
			<Property Name="IsConcatNullYieldsNullOn" Value="True" />
			<Property Name="IsTornPageProtectionOn" Value="False" />
			<Property Name="IsFullTextEnabled" Value="True" />
			<Property Name="PageVerifyMode" Value="3" />
			<Property Name="DefaultLanguage" Value="" />
			<Property Name="DefaultFullTextLanguage" Value="" />
			<Relationship Name="DefaultFilegroup">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[PRIMARY]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlPrimaryKeyConstraint">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[__idMedidaDisponibilidade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="3" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[GetCotacaoValidadeFunction].[__id]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[GetCotacaoValidadeFunction]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="4" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[GetCotacaoStockSubstitutoFunction].[__id]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[GetCotacaoStockSubstitutoFunction]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="5" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[GetCotacaoPrecoFunction].[__id]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[GetCotacaoPrecoFunction]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="6" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[__idMedidaPreco]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[GetProdutoMedidasPrecoFunction]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="7" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[AvisosTipo]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[AvisosTipo].[Codigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[AvisosTipo].[Descricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[AvisosTipo].[Gravidade]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[AvisosTipo].[Notas]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[AvisosTipo].[Icon]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[AvisosTipo].[Inativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[AvisosTipo].[Criacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[AvisosTipo].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="8" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[BrandCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([Codigo]) FROM [dbo].[Marcas]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="542" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[BrandCount]&#xD;&#xA;&#x9;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[BrandDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Marcas] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Marcas] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D02] ' + 'O registo que pretende eliminar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].[Marcas] Where [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Marcas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Marcas].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandDelete].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Marcas].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandDelete].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Marcas].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandDelete].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandDelete].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1520" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[BrandDelete]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[BrandInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Criacao smalldatetime, @Versao datetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Criacao = GETDATE()
	SET @Versao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[Marcas] ([Codigo], [Descricao], [Inativo], [Criacao], [Versao]) 
					VALUES (@Codigo, @Descricao, @Inativo, @Criacao, @Versao);
		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Marcas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Marcas].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Marcas].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Marcas].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Marcas].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Marcas].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandInsert].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandInsert].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandInsert].[@Inativo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandInsert].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandInsert].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandInsert].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1110" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[BrandInsert]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Descricao nvarchar(50),&#xD;&#xA;&#x9;@Inativo bit&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[BrandMatchingCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([Codigo]) FROM [dbo].[MarcasMatching]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandMatchingCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandMatchingCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="558" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[BrandMatchingCount]&#xD;&#xA;&#x9;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[BrandMatchingDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[MarcasMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[MarcasMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D02] ' + 'O registo que pretende eliminar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].[MarcasMatching] Where [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandMatchingDelete].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandMatchingDelete].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandMatchingDelete].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandMatchingDelete].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandMatchingDelete].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandMatchingDelete].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1716" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[BrandMatchingDelete]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@Codigo nvarchar(128),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[BrandMatchingInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Criacao smalldatetime, @Versao datetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Criacao = GETDATE()
	SET @Versao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[MarcasMatching] ([FornecedorCodigo], [Codigo], [Descricao], [MapTo], [Inativo], [Criacao], [Versao]) 
					VALUES (@FornecedorCodigo, @Codigo, @Descricao, @MapTo, @Inativo, @Criacao, @Versao);
		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandMatchingInsert].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandMatchingInsert].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandMatchingInsert].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandMatchingInsert].[@MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandMatchingInsert].[@Inativo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandMatchingInsert].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandMatchingInsert].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandMatchingInsert].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandMatchingInsert].[@MapTo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandMatchingInsert].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1240" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[BrandMatchingInsert]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@Codigo nvarchar(128),&#xD;&#xA;&#x9;@Descricao nvarchar(128),&#xD;&#xA;&#x9;@MapTo nvarchar(5),&#xD;&#xA;&#x9;@Inativo bit&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[BrandMatchingSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT matching.[FornecedorCodigo], fornecedores.[Nome] as FornecedorNome, matching.[Codigo], matching.[Descricao], 
							matching.[MapTo], matching.[Inativo], matching.[Criacao], matching.[Versao]				
						FROM [dbo].[MarcasMatching] matching 
						INNER JOIN [dbo].[Fornecedores] fornecedores
							ON matching.[FornecedorCodigo] = fornecedores.[Codigo] AND fornecedores.[INATIVO]='+'''FALSE'''
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandMatchingSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandMatchingSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandMatchingSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandMatchingSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1114" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[BrandMatchingSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[BrandMatchingUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[MarcasMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[MarcasMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U02] ' + 'O registo que pretende alterar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NovaVersao datetime, @NumeroLinhasAfetadas int

	SET @NovaVersao = GETDATE()


	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[MarcasMatching] SET [Descricao] = @Descricao,
									[MapTo] = @MapTo,
									[Inativo] = @Inativo,
									[Versao] = @NovaVersao
								WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandMatchingUpdate].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandMatchingUpdate].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandMatchingUpdate].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandMatchingUpdate].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandMatchingUpdate].[@MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandMatchingUpdate].[@Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandMatchingUpdate].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandMatchingUpdate].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandMatchingUpdate].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandMatchingUpdate].[@MapTo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandMatchingUpdate].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandMatchingUpdate].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1960" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[BrandMatchingUpdate]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@Codigo nvarchar(128),&#xD;&#xA;&#x9;@Descricao nvarchar(128),&#xD;&#xA;&#x9;@MapTo nvarchar(5),&#xD;&#xA;&#x9;@Inativo bit,&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[BrandSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT marcas.[Codigo], marcas.[Descricao], marcas.[Inativo], marcas.[Criacao], marcas.[Versao]				
						FROM [dbo].[Marcas] marcas' 
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="836" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[BrandSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[BrandUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Marcas] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Marcas] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U02] ' + 'O registo que pretende alterar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NovaVersao datetime, @NumeroLinhasAfetadas int

	SET @NovaVersao = GETDATE()


	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[Marcas] SET [Descricao] = @Descricao,
									[Inativo] = @Inativo,
									[Versao] = @NovaVersao
								WHERE [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Marcas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Marcas].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandUpdate].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Marcas].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandUpdate].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Marcas].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandUpdate].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Marcas].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BrandUpdate].[@Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Marcas].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Marcas].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandUpdate].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandUpdate].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandUpdate].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BrandUpdate].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1713" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[BrandUpdate]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Descricao nvarchar(50),&#xD;&#xA;&#x9;@Inativo bit,&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[CatalogCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([Codigo]) FROM [dbo].[Catalogos]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CatalogCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CatalogCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="547" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[CatalogCount]&#xD;&#xA;&#x9;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[CatalogDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Catalogos] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Catalogos] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D02] ' + 'O registo que pretende eliminar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].[Catalogos] Where [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Catalogos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Catalogos].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CatalogDelete].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Catalogos].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CatalogDelete].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Catalogos].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CatalogDelete].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CatalogDelete].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1531" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[CatalogDelete]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[CatalogInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Criacao smalldatetime, @Versao datetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Criacao = GETDATE()
	SET @Versao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[Catalogos] ([Codigo], [Descricao], [Notas], [Inativo], [Criacao], [Versao]) 
					VALUES (@Codigo, @Descricao, @Notas, @Inativo, @Criacao, @Versao);
		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Catalogos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Catalogos].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Catalogos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Catalogos].[Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Catalogos].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Catalogos].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Catalogos].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CatalogInsert].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CatalogInsert].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CatalogInsert].[@Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CatalogInsert].[@Inativo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CatalogInsert].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CatalogInsert].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CatalogInsert].[@Notas]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CatalogInsert].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1156" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[CatalogInsert]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Descricao nvarchar(50),&#xD;&#xA;&#x9;@Notas nvarchar(256),&#xD;&#xA;&#x9;@Inativo bit&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Catalogos]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Catalogos].[Codigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Catalogos].[Descricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Catalogos].[Notas]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Catalogos].[Inativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Catalogos].[Criacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Catalogos].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="9" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[CatalogSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT c.[Codigo], c.[Descricao], c.[Notas], c.[Inativo], c.[Criacao], c.[Versao]				
						FROM [dbo].[Catalogos] c' 
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CatalogSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CatalogSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CatalogSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CatalogSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="822" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[CatalogSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[CatalogUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Catalogos] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Catalogos] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U02] ' + 'O registo que pretende alterar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NovaVersao datetime, @NumeroLinhasAfetadas int

	SET @NovaVersao = GETDATE()


	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[Catalogos] SET [Descricao] = @Descricao,
									[Notas] = @Notas,
									[Inativo] = @Inativo,
									[Versao] = @NovaVersao
								WHERE [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Catalogos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Catalogos].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CatalogUpdate].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Catalogos].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CatalogUpdate].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Catalogos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CatalogUpdate].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Catalogos].[Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CatalogUpdate].[@Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Catalogos].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CatalogUpdate].[@Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Catalogos].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Catalogos].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CatalogUpdate].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CatalogUpdate].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CatalogUpdate].[@Notas]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CatalogUpdate].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CatalogUpdate].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1776" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[CatalogUpdate]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Descricao nvarchar(50),&#xD;&#xA;&#x9;@Notas nvarchar(256),&#xD;&#xA;&#x9;@Inativo bit,&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Categorias]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Categorias].[Codigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Categorias].[Descricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Categorias].[PesoMedioUnidade]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Categorias].[PrecoMinimoPermitido]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Categorias].[PrecoMaximoPermitido]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Categorias].[PrecoAmplitudeMax]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Categorias].[Confianca]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Categorias].[Inativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Categorias].[Criacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Categorias].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="10" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[CategoriasMatching]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[CategoriasMatching].[FornecedorCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[CategoriasMatching].[Codigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[CategoriasMatching].[Descricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[CategoriasMatching].[MapTo]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[CategoriasMatching].[Inativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[CategoriasMatching].[Criacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[CategoriasMatching].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="11" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="12" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="13" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[CategoryCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([Codigo]) FROM [dbo].[Categorias]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="548" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[CategoryCount]&#xD;&#xA;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[CategoryDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Categorias] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Categorias] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D02] ' + 'O registo que pretende eliminar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].[Categorias] Where [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryDelete].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryDelete].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryDelete].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryDelete].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1536" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[CategoryDelete]&#xD;&#xA;&#x9;@Codigo nvarchar(20),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[CategoryInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Criacao smalldatetime, @Versao datetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Criacao = GETDATE()
	SET @Versao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[Categorias] ([Codigo], [Descricao], [PesoMedioUnidade],[PrecoMaximoPermitido],[PrecoMinimoPermitido], [PrecoAmplitudeMax], [Confianca], [Inativo], [Criacao], [Versao]) 
					VALUES (@Codigo, @Descricao, @PesoMedioUnidade, @PrecoMinimoPermitido, @PrecoMaximoPermitido, @PrecoAmplitudeMax, @Confianca, @Inativo, @Criacao, @Versao);
		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[PesoMedioUnidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[PrecoMaximoPermitido]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[PrecoMinimoPermitido]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[PrecoAmplitudeMax]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[Confianca]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryInsert].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryInsert].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryInsert].[@PesoMedioUnidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryInsert].[@PrecoMinimoPermitido]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryInsert].[@PrecoMaximoPermitido]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryInsert].[@PrecoAmplitudeMax]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryInsert].[@Confianca]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryInsert].[@Inativo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryInsert].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryInsert].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryInsert].[@PesoMedioUnidade]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryInsert].[@PrecoMinimoPermitido]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryInsert].[@PrecoMaximoPermitido]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryInsert].[@PrecoAmplitudeMax]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryInsert].[@Confianca]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryInsert].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1468" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[CategoryInsert]&#xD;&#xA;&#x9;@Codigo nvarchar(20),&#xD;&#xA;&#x9;@Descricao nvarchar(50),&#xD;&#xA;&#x9;@PesoMedioUnidade float,&#xD;&#xA;&#x9;@PrecoMinimoPermitido decimal(14,4),&#xD;&#xA;&#x9;@PrecoMaximoPermitido decimal(14,4),&#xD;&#xA;&#x9;@PrecoAmplitudeMax float,&#xD;&#xA;&#x9;@Confianca float,&#xD;&#xA;&#x9;@Inativo bit&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[CategoryMatchingCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([Codigo]) FROM [dbo].[CategoriasMatching]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryMatchingCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryMatchingCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="565" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[CategoryMatchingCount]&#xD;&#xA;&#x9;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[CategoryMatchingDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[CategoriasMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[CategoriasMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D02] ' + 'O registo que pretende eliminar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].[CategoriasMatching] Where [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryMatchingDelete].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryMatchingDelete].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryMatchingDelete].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryMatchingDelete].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryMatchingDelete].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryMatchingDelete].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1731" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[CategoryMatchingDelete]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@Codigo nvarchar(128),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[CategoryMatchingInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Criacao smalldatetime, @Versao datetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Criacao = GETDATE()
	SET @Versao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[CategoriasMatching] ([FornecedorCodigo], [Codigo], [Descricao], [MapTo], [Inativo], [Criacao], [Versao]) 
					VALUES (@FornecedorCodigo, @Codigo, @Descricao, @MapTo, @Inativo, @Criacao, @Versao);
		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryMatchingInsert].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryMatchingInsert].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryMatchingInsert].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryMatchingInsert].[@MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryMatchingInsert].[@Inativo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryMatchingInsert].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryMatchingInsert].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryMatchingInsert].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryMatchingInsert].[@MapTo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryMatchingInsert].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1248" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[CategoryMatchingInsert]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@Codigo nvarchar(128),&#xD;&#xA;&#x9;@Descricao nvarchar(128),&#xD;&#xA;&#x9;@MapTo nvarchar(20),&#xD;&#xA;&#x9;@Inativo bit&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[CategoryMatchingSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT matching.[FornecedorCodigo], fornecedores.[Nome] as FornecedorNome, matching.[Codigo], matching.[Descricao], 
							matching.[MapTo], matching.[Inativo], matching.[Criacao], matching.[Versao]				
						FROM [dbo].[CategoriasMatching] matching 
						INNER JOIN [dbo].[Fornecedores] fornecedores
							ON matching.[FornecedorCodigo] = fornecedores.[Codigo] AND fornecedores.[INATIVO]='+'''FALSE'''
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryMatchingSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryMatchingSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryMatchingSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryMatchingSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1121" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[CategoryMatchingSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[CategoryMatchingUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[CategoriasMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[CategoriasMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U02] ' + 'O registo que pretende alterar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NovaVersao datetime, @NumeroLinhasAfetadas int

	SET @NovaVersao = GETDATE()


	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[CategoriasMatching] SET [Descricao] = @Descricao,
									[MapTo] = @MapTo,
									[Inativo] = @Inativo,
									[Versao] = @NovaVersao
								WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryMatchingUpdate].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryMatchingUpdate].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryMatchingUpdate].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryMatchingUpdate].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryMatchingUpdate].[@MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryMatchingUpdate].[@Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryMatchingUpdate].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryMatchingUpdate].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryMatchingUpdate].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryMatchingUpdate].[@MapTo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryMatchingUpdate].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryMatchingUpdate].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1976" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[CategoryMatchingUpdate]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@Codigo nvarchar(128),&#xD;&#xA;&#x9;@Descricao nvarchar(128),&#xD;&#xA;&#x9;@MapTo nvarchar(20),&#xD;&#xA;&#x9;@Inativo bit,&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[CategorySelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT c.[Codigo], c.[Descricao], c.[PesoMedioUnidade], c.[PrecoMinimoPermitido], c.[PrecoMaximoPermitido], c.[PrecoAmplitudeMax], c.[Confianca], c.[Inativo], c.[Criacao], c.[Versao]				
						FROM [dbo].[Categorias] c' 
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategorySelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategorySelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategorySelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategorySelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="925" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[CategorySelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[CategoryUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Categorias] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Categorias] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U02] ' + 'O registo que pretende alterar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NovaVersao datetime, @NumeroLinhasAfetadas int

	SET @NovaVersao = GETDATE()


	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[Categorias] SET [Descricao] = @Descricao,
									[PesoMedioUnidade] = @PesoMedioUnidade,
									[PrecoMinimoPermitido] = @PrecoMinimoPermitido,
									[PrecoMaximoPermitido] = @PrecoMaximoPermitido,
									[PrecoAmplitudeMax] = @PrecoAmplitudeMax,
									[Confianca] = @Confianca,
									[Inativo] = @Inativo,
									[Versao] = @NovaVersao
								WHERE [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryUpdate].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryUpdate].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryUpdate].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[PesoMedioUnidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryUpdate].[@PesoMedioUnidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[PrecoMinimoPermitido]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryUpdate].[@PrecoMinimoPermitido]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[PrecoMaximoPermitido]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryUpdate].[@PrecoMaximoPermitido]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[PrecoAmplitudeMax]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryUpdate].[@PrecoAmplitudeMax]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[Confianca]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryUpdate].[@Confianca]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoryUpdate].[@Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryUpdate].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryUpdate].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryUpdate].[@PesoMedioUnidade]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryUpdate].[@PrecoMinimoPermitido]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryUpdate].[@PrecoMaximoPermitido]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryUpdate].[@PrecoAmplitudeMax]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryUpdate].[@Confianca]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryUpdate].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CategoryUpdate].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="2136" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[CategoryUpdate]&#xD;&#xA;&#x9;@Codigo nvarchar(20),&#xD;&#xA;&#x9;@Descricao nvarchar(50),&#xD;&#xA;&#x9;@PesoMedioUnidade float,&#xD;&#xA;&#x9;@PrecoMinimoPermitido decimal(14,4),&#xD;&#xA;&#x9;@PrecoMaximoPermitido decimal(14,4),&#xD;&#xA;&#x9;@PrecoAmplitudeMax float,&#xD;&#xA;&#x9;@Confianca float,&#xD;&#xA;&#x9;@Inativo bit,&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[ClassCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([Codigo]) FROM [dbo].[Classes]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ClassCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ClassCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="543" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[ClassCount]&#xD;&#xA;&#x9;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[ClassDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Classes] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Classes] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D02] ' + 'O registo que pretende eliminar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].[Classes] Where [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Classes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Classes].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ClassDelete].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Classes].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ClassDelete].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Classes].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ClassDelete].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ClassDelete].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1523" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[ClassDelete]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Classes]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Classes].[Codigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Classes].[Descricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Classes].[CatalogoCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Classes].[Margem]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Classes].[MargemValorMinimo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Classes].[Notas]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Classes].[Inativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Classes].[Criacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Classes].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="14" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="15" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[ClassesCategorias]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ClassesCategorias].[ClasseCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ClassesCategorias].[CategoriaCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ClassesCategorias].[Notas]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ClassesCategorias].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="16" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="17" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="18" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[ClassInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Criacao smalldatetime, @Versao datetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Criacao = GETDATE()
	SET @Versao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[Classes] ([Codigo], [Descricao], [CatalogoCodigo], [Margem], [MargemValorMinimo], [Notas], [Inativo], [Criacao], [Versao]) 
					VALUES (@Codigo, @Descricao, @CatalogoCodigo, @Margem, @MargemValorMinimo, @Notas, @Inativo, @Criacao, @Versao);
		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Classes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Classes].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Classes].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Classes].[CatalogoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Classes].[Margem]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Classes].[MargemValorMinimo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Classes].[Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Classes].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Classes].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Classes].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ClassInsert].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ClassInsert].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ClassInsert].[@CatalogoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ClassInsert].[@Margem]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ClassInsert].[@MargemValorMinimo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ClassInsert].[@Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ClassInsert].[@Inativo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ClassInsert].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ClassInsert].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ClassInsert].[@CatalogoCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ClassInsert].[@Margem]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ClassInsert].[@MargemValorMinimo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ClassInsert].[@Notas]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ClassInsert].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1332" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[ClassInsert]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Descricao nvarchar(50),&#xD;&#xA;&#x9;@CatalogoCodigo nvarchar(20),&#xD;&#xA;&#x9;@Margem float,&#xD;&#xA;&#x9;@MargemValorMinimo decimal(14,4),&#xD;&#xA;&#x9;@Notas nvarchar(256),&#xD;&#xA;&#x9;@Inativo bit&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[ClassSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT classes.[Codigo], classes.[Descricao], classes.[CatalogoCodigo], catalogos.[Descricao] as CatalogoDescricao, 
					classes.[Margem], classes.[MargemValorMinimo], classes.[Notas], classes.[Inativo], classes.[Criacao], classes.[Versao]				
						FROM [dbo].[Classes] classes 
					INNER JOIN [dbo].[Catalogos] catalogos
						ON classes.[CatalogoCodigo] = catalogos.[Codigo]' 
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ClassSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ClassSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ClassSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ClassSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1086" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[ClassSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[ClassUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Classes] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Classes] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U02] ' + 'O registo que pretende alterar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NovaVersao datetime, @NumeroLinhasAfetadas int

	SET @NovaVersao = GETDATE()


	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[Classes] SET [Descricao] = @Descricao,
									[CatalogoCodigo] = @CatalogoCodigo, 
									[Margem] = @Margem, 
									[MargemValorMinimo] = @MargemValorMinimo,
									[Notas] = @Notas,
									[Inativo] = @Inativo,
									[Versao] = @NovaVersao
								WHERE [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Classes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Classes].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ClassUpdate].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Classes].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ClassUpdate].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Classes].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ClassUpdate].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Classes].[CatalogoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ClassUpdate].[@CatalogoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Classes].[Margem]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ClassUpdate].[@Margem]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Classes].[MargemValorMinimo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ClassUpdate].[@MargemValorMinimo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Classes].[Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ClassUpdate].[@Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Classes].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ClassUpdate].[@Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Classes].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Classes].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ClassUpdate].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ClassUpdate].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ClassUpdate].[@CatalogoCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ClassUpdate].[@Margem]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ClassUpdate].[@MargemValorMinimo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ClassUpdate].[@Notas]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ClassUpdate].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ClassUpdate].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1983" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[ClassUpdate]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Descricao nvarchar(50),&#xD;&#xA;&#x9;@CatalogoCodigo nvarchar(20),&#xD;&#xA;&#x9;@Margem float,&#xD;&#xA;&#x9;@MargemValorMinimo decimal(14,4),&#xD;&#xA;&#x9;@Notas nvarchar(256),&#xD;&#xA;&#x9;@Inativo bit,&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlScalarFunction" Name="[dbo].[CleanBadCharsFunction]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CleanBadCharsFunction].[@texto]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN

	-- remove trim spaces (left and right)
	SET @texto = LTRIM(RTRIM(@texto));

	-- remove bad chars (unexpected chars)
	SET @texto = REPLACE(@texto, '´', ' ');
	SET @texto = REPLACE(@texto, '`', ' ');
	SET @texto = REPLACE(@texto, '"', ' ');
	SET @texto = REPLACE(@texto, '~', ' ');
	SET @texto = REPLACE(@texto, '^', ' ');
	SET @texto = REPLACE(@texto, '''', ' ');
	SET @texto = REPLACE(@texto, '¨', ' ');

	-- remove extra wrong spaces (leave only one space)
	SET @texto = REPLACE(@texto, '       ', ' ');
	SET @texto = REPLACE(@texto, '      ', ' ');
	SET @texto = REPLACE(@texto, '     ', ' ');
	SET @texto = REPLACE(@texto, '    ', ' ');
	SET @texto = REPLACE(@texto, '   ', ' ');
	SET @texto = REPLACE(@texto, '  ', ' ');

	-- return cleaned text
	RETURN @texto;
END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="110" />
							<Property Name="Length" Value="1012" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;O objetivo desta função é limpar uma string com caracteres lixo e espaço em excesso, por exemplo.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE FUNCTION [dbo].CleanBadCharsFunction&#xD;&#xA;(&#xD;&#xA;&#x9;@texto nvarchar(256)&#xD;&#xA;)&#xD;&#xA;RETURNS nvarchar(256)&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CleanBadCharsFunction].[@texto]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Type">
				<Entry>
					<Element Type="SqlTypeSpecifier">
						<Property Name="Length" Value="256" />
						<Relationship Name="Type">
							<Entry>
								<References ExternalSource="BuiltIns" Name="[nvarchar]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Complementos]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Complementos].[Codigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Complementos].[Descricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Complementos].[TermoAcrescentar]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Complementos].[TermosRemover]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Complementos].[Inativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Complementos].[Criacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Complementos].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="19" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[ComplementosMatching]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ComplementosMatching].[FornecedorCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ComplementosMatching].[Codigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ComplementosMatching].[Descricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ComplementosMatching].[MapTo]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ComplementosMatching].[Inativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ComplementosMatching].[Criacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ComplementosMatching].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="20" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="21" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="22" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[CotacaoInsertSP]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	-- variaveis
	DECLARE @Partnumber nvarchar(25);


	/*
		Como esta SP é executada automaticamente para cada linha com o SSIS, pretende-se preencher duas colunas adicionais no resulset
		com o objetivo de, linha a linha, ser possivel perceber o problema encontrado.
	
		Para atingir este objetivo existem dois parametros a ter em conta:
			> @Info é um parametro de saída e deve conter a mensagem a colocar na linha / coluna em processamento no SSIS
			> @RETURN_VALUE que é o interno enviado à frente do RETURN e que corresponde ao numero de registos inseridos.

		Assim, se a SP não for executada pelo SSIS mas sim por uma outra aplicação, caso o RETURN_VALUE seja 0 (zero), o programador 
		deve considerar a mensagem de erro que existirá no parametro de saída @info.
	*/



	-- @PrevineDuplicacoes
	IF @PrevineDuplicacoes IS NULL
	BEGIN
		SET @Info = '[CotacaoInsertSP-01] (StoredProcedure)' + 'o valor do parametro @PrevineDuplicacoes não pode ser nulo!';
		RETURN 0
	END




	-- @FornecedorCodigo
	IF @FornecedorCodigo IS NULL
	BEGIN
		SET @Info = '[CotacaoInsertSP-02] (StoredProcedure)' + 'o valor do parametro @FornecedorCodigo não pode ser nulo!';
		RETURN 0
	END

	IF LEN(RTRIM(@FornecedorCodigo)) < 1
	BEGIN
		SET @Info ='[CotacaoInsertSP-03] (StoredProcedure)' + 'o valor do parametro @FornecedorCodigo tem um tamanho inválido!';
		RETURN 0
	END



	-- @Data
	IF @Data IS NULL
	BEGIN
		SET @Info = '[CotacaoInsertSP-04] (StoredProcedure)' + 'o valor do parametro @Data não pode ser nulo!';
		RETURN 0
	END



	-- @_ProdutoCodigo
	/*
		SERÁ AVALIADO APENAS NO FINAL DOS OUTROS PARAMETROS, PORQUE PRECISAMOS DO VALOR DA MARCA E PARTNUMBER PARA CONSTRUIR UM 
		CÓDIGO DE FORNECEDOR CASO ESTE NÃO ENVIE UM.
	*/



	-- @_ComplementoCodigo
	IF @_ComplementoCodigo IS NULL
	BEGIN
		SET @_ComplementoCodigo = '(vazio)';
	END

	IF LEN(RTRIM(@_ComplementoCodigo)) < 1
	BEGIN
		SET @_ComplementoCodigo = '(vazio)';
	END



	-- @_ComplementoDescricao
	IF @_ComplementoDescricao IS NULL
	BEGIN
		SET @_ComplementoDescricao = @_ComplementoCodigo;
	END

	IF LEN(RTRIM(@_ComplementoDescricao)) < 1
	BEGIN
		SET @_ComplementoDescricao = @_ComplementoCodigo;
	END



	-- @_Partnumber
	IF @_Partnumber IS NULL
	BEGIN
		SET @Info = '[CotacaoInsertSP-11] (StoredProcedure)' + 'o valor do parametro @_Partnumber não pode ser nulo!';
		RETURN 0
	END

	IF LEN(RTRIM(@_Partnumber)) < 1
	BEGIN
		SET @Info = '[CotacaoInsertSP-12] (StoredProcedure)' + 'o valor do parametro @_Partnumber tem um tamanho inválido!';
		RETURN 0
	END



	-- @_MarcaCodigo
	IF @_MarcaCodigo IS NULL
	BEGIN
		SET @Info ='[CotacaoInsertSP-13] (StoredProcedure)' + 'o valor do parametro @_MarcaCodigo não pode ser nulo!';
		RETURN 0
	END

	IF LEN(RTRIM(@_MarcaCodigo)) < 1
	BEGIN
		SET @Info = '[CotacaoInsertSP-14] (StoredProcedure)' + 'o valor do parametro @_MarcaCodigo tem um tamanho inválido!';
		RETURN 0
	END



	-- @_MarcaDescricao
	IF @_MarcaDescricao IS NULL
	BEGIN
		SET @_MarcaDescricao = @_MarcaCodigo;
	END

	IF LEN(RTRIM(@_MarcaDescricao)) < 1
	BEGIN
		SET @_MarcaDescricao = @_MarcaCodigo;
	END



	-- @_CategoriaCodigo
	IF @_CategoriaCodigo IS NULL
	BEGIN
		SET @Info = '[CotacaoInsertSP-17] (StoredProcedure)' + 'o valor do parametro @_CategoriaCodigo não pode ser nulo!';
		RETURN 0
	END

	IF LEN(RTRIM(@_CategoriaCodigo)) < 1
	BEGIN
		SET @Info = '[CotacaoInsertSP-18] (StoredProcedure)' + 'o valor do parametro @_CategoriaCodigo tem um tamanho inválido!';
		RETURN 0
	END




	-- @_CategoriaDescricao
	IF @_CategoriaDescricao IS NULL
	BEGIN
		SET @_CategoriaDescricao = @_CategoriaCodigo;
	END

	IF LEN(RTRIM(@_CategoriaDescricao)) < 1
	BEGIN
		SET @_CategoriaDescricao = @_CategoriaCodigo;
	END




	-- @_StockCodigo
	IF @_StockCodigo IS NULL
	BEGIN
		SET @_StockCodigo = '(vazio)';
	END

	IF LEN(RTRIM(@_StockCodigo)) < 1
	BEGIN
		SET @_StockCodigo = '(vazio)';
	END



	
	-- @_StockDescricao
	IF @_StockDescricao IS NULL
	BEGIN
		SET @_StockDescricao = @_StockCodigo;
	END

	IF LEN(RTRIM(@_StockDescricao)) < 1
	BEGIN
		SET @_StockDescricao = @_StockCodigo;
	END




	-- @_ImpostoCodigo
	IF @_ImpostoCodigo IS NULL
	BEGIN
		SET @_ImpostoCodigo = '(vazio)';
	END

	IF LEN(RTRIM(@_ImpostoCodigo)) < 1
	BEGIN
		SET @_ImpostoCodigo = '(vazio)';
	END



	
	-- @_ImpostoDescricao
	IF @_ImpostoDescricao IS NULL
	BEGIN
		SET @_ImpostoDescricao = @_ImpostoCodigo;
	END

	IF LEN(RTRIM(@_ImpostoDescricao)) < 1
	BEGIN
		SET @_ImpostoDescricao = @_ImpostoCodigo;
	END




	-- @_EstadoCodigo
	IF @_EstadoCodigo IS NULL
	BEGIN
		SET @_EstadoCodigo = '(vazio)';
	END

	IF LEN(RTRIM(@_EstadoCodigo)) < 1
	BEGIN
		SET @_EstadoCodigo = '(vazio)';
	END



	
	-- @_EstadoDescricao
	IF @_EstadoDescricao IS NULL
	BEGIN
		SET @_EstadoDescricao = @_EstadoCodigo;
	END

	IF LEN(RTRIM(@_EstadoDescricao)) < 1
	BEGIN
		SET @_EstadoDescricao = @_EstadoCodigo;
	END




	-- @_Descricao
	IF @_Descricao IS NULL
	BEGIN
		SET @Info = '[CotacaoInsertSP-29] (StoredProcedure)' + 'o valor do parametro @_Descricao não pode ser nulo!';
		RETURN 0
	END

	IF LEN(RTRIM(@_Descricao)) < 1
	BEGIN
		SET @Info = '[CotacaoInsertSP-30] (StoredProcedure)' + 'o valor do parametro @_Descricao tem um tamanho inválido!';
		RETURN 0
	END




	-- @_Link
	IF @_Link IS NULL
	BEGIN
		SET @_Link = '(vazio)';
	END

	IF LEN(RTRIM(@_Link)) < 1
	BEGIN
		SET @_Link = '(vazio)';
	END




	-- @_Caracteristicas
	IF @_Caracteristicas IS NULL
	BEGIN
		SET @_Caracteristicas = '(vazio)';
	END

	IF LEN(RTRIM(@_Caracteristicas)) < 1
	BEGIN
		SET @_Caracteristicas = '(vazio)';
	END




	-- @_Imagem
	IF @_Imagem IS NULL
	BEGIN
		SET @_Imagem = '(vazio)';
	END

	IF LEN(RTRIM(@_Imagem)) < 1
	BEGIN
		SET @_Imagem = '(vazio)';
	END





	-- @_Preco
	IF @_Preco IS NULL
	BEGIN
		SET @Info = '[CotacaoInsertSP-37] (StoredProcedure)' + 'o valor do parametro @_Preco não pode ser nulo!';
		RETURN 0
	END





	-- @_OutrosCustos
	IF @_OutrosCustos IS NULL
	BEGIN
		SET @_OutrosCustos = 0.0;
	END





	-- @_OutrosCustosDescricao
	IF @_OutrosCustosDescricao IS NULL
	BEGIN
		SET @_OutrosCustosDescricao = '(vazio)';
	END

	IF LEN(RTRIM(@_OutrosCustosDescricao)) < 1
	BEGIN
		SET @_OutrosCustosDescricao = '(vazio)';
	END




	-- @_Validade
	IF @_Validade IS NULL
	BEGIN
		SET @_Validade = CAST('01-01-2000' AS smalldatetime);
	END





	-- @_ValidadeDescricao
	IF @_ValidadeDescricao IS NULL
	BEGIN
		SET @_ValidadeDescricao = '(vazio)';
	END

	IF LEN(RTRIM(@_ValidadeDescricao)) < 1
	BEGIN
		SET @_OutrosCustosDescricao = '(vazio)';
	END





	-- PREPARAR @Partnumber (INTERNO)
	SET @Partnumber = dbo.GetCotacaoPartnumberFunction(@_Partnumber);



	-- impor regras para códigos externos (sistemas operacionais externos)
	SET @_ComplementoCodigo = dbo.GetCodigoExternoNormalizadoFunction(@_ComplementoCodigo);
	SET @_MarcaCodigo = dbo.GetCodigoExternoNormalizadoFunction(@_MarcaCodigo);
	SET @_CategoriaCodigo = dbo.GetCodigoExternoNormalizadoFunction(@_CategoriaCodigo);
	SET @_StockCodigo = dbo.GetCodigoExternoNormalizadoFunction(@_StockCodigo);
	SET @_ImpostoCodigo = dbo.GetCodigoExternoNormalizadoFunction(@_ImpostoCodigo);
	SET @_EstadoCodigo = dbo.GetCodigoExternoNormalizadoFunction(@_EstadoCodigo);



	-- @_ProdutoCodigo
	IF @_ProdutoCodigo IS NULL
	BEGIN
		SET @_ProdutoCodigo = '(' + @_MarcaCodigo + ')' + @Partnumber; -- uso o @Partnumber interno porque está limpo de caracteres anómalos
	END

	IF LEN(RTRIM(@_ProdutoCodigo)) < 1
	BEGIN
		SET @_ProdutoCodigo = '(' + @_MarcaCodigo + ')' + @Partnumber; -- uso o @Partnumber interno porque está limpo de caracteres anómalos
	END




	-- PREVINE DUPLICAÇÕES (remove a CotacaoNaoIntegrada que possa existir para este FornecedorCodigo / _ProdutoCodigo
	IF @PrevineDuplicacoes = CAST('true' as bit)
	BEGIN
		-- remove cotacoes já completas mas ainda não integradas
		DELETE FROM [dbo].CotacoesNaoIntegradasView
			   WHERE [FornecedorCodigo] = @FornecedorCodigo
					 AND [_ProdutoCodigo] = @_ProdutoCodigo

		-- remove cotações incompletas
		DELETE FROM [dbo].CotacoesIncompletasView
			   WHERE [FornecedorCodigo] = @FornecedorCodigo
					 AND [_ProdutoCodigo] = @_ProdutoCodigo

	END




	-- INSERIR
	SET NOCOUNT ON; -- não há necessidade de contar os registos (é sempre 1)


	BEGIN TRY
	
		INSERT INTO [dbo].[Cotacoes]
			   (
				   [FornecedorCodigo], [Data], [_ProdutoCodigo], [_ComplementoCodigo], [_ComplementoDescricao],
				   [_Partnumber], [_MarcaCodigo], [_MarcaDescricao], [_CategoriaCodigo], [_CategoriaDescricao], [_StockCodigo], [_StockDescricao],
				   [_ImpostoCodigo], [_ImpostoDescricao], [_EstadoCodigo], [_EstadoDescricao], [_Descricao], [_Link], [_Caracteristicas], [_Imagem], 
				   [_Preco], [_OutrosCustos], [_OutrosCustosDescricao], [_Validade], [_ValidadeDescricao],
				   [ComplementoCodigo], [Partnumber], [MarcaCodigo], [CategoriaCodigo], 
				   [StockCodigo], [StockCodigoSubstituto], [StockCodigoSubstitutoJustificacao], 
				   [ImpostoCodigo], [EstadoCodigo], [Descricao], [Link], [Caracteristicas], [PrecoCusto], [PrecoCustoFormula],
				   [Validade], [ValidadeFormula], [ProdutoCodigo], 
				   [Completo], [Integrado],
				   [Inativo], [Versao]
				)
				VALUES
				(
				   @FornecedorCodigo, @Data, @_ProdutoCodigo, @_ComplementoCodigo, @_ComplementoDescricao,
				   @_Partnumber, @_MarcaCodigo, @_MarcaDescricao, @_CategoriaCodigo, @_CategoriaDescricao, @_StockCodigo, @_StockDescricao,
				   @_ImpostoCodigo, @_ImpostoDescricao, @_EstadoCodigo, @_EstadoDescricao, @_Descricao, @_Link, @_Caracteristicas, @_Imagem, 
				   @_Preco, @_OutrosCustos, @_OutrosCustosDescricao, @_Validade, @_ValidadeDescricao,
				   null, @Partnumber, null, null, 
				   null, null, null, 
				   null, null, null, null, null, null, null, 
				   null, null, null, 
				   CAST('false' as bit), CAST('false' as bit),
				   CAST('false' as bit), GETDATE()
				);


		-- preencher output com informação - sucesso
		SET @Info = 'Cotação inserida com sucesso.';

		-- devolver informação que foi inserido um registo
		RETURN 1;

	END TRY
	BEGIN CATCH

		-- preencher output com informação - sucesso
		SET @Info = '[CotacaoInsertSP-50] ' +CAST(ERROR_NUMBER() as nvarchar) + ' - ' +ERROR_MESSAGE();

		-- devolver informação que foi inserido um registo
		RETURN 1;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@PrevineDuplicacoes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@Info]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@_ComplementoDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@_Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@_MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@_MarcaDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@_CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@_CategoriaDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@_StockDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@_ImpostoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@_ImpostoDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@_EstadoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@_EstadoDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@_Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@_Link]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@_Caracteristicas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@_Imagem]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@_Preco]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@_OutrosCustos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@_OutrosCustosDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@_Validade]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@_ValidadeDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoPartnumberFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCodigoExternoNormalizadoFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacaoInsertSP].[@_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesNaoIntegradasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesNaoIntegradasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesNaoIntegradasView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_ComplementoDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_MarcaDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_CategoriaDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_StockDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_ImpostoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_ImpostoDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_EstadoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_EstadoDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_Link]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_Caracteristicas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_Imagem]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_Preco]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_OutrosCustos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_OutrosCustosDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_Validade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_ValidadeDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[StockCodigoSubstituto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[StockCodigoSubstitutoJustificacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[ImpostoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[EstadoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[Link]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[Caracteristicas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[PrecoCusto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[PrecoCustoFormula]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[Validade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[ValidadeFormula]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[Completo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[Integrado]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[Versao]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@PrevineDuplicacoes]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@Data]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@_ProdutoCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@_ComplementoCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@_ComplementoDescricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@_Partnumber]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@_MarcaCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@_MarcaDescricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@_CategoriaCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@_CategoriaDescricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@_StockCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@_StockDescricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@_ImpostoCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@_ImpostoDescricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@_EstadoCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@_EstadoDescricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@_Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@_Link]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@_Caracteristicas]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="2048" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@_Imagem]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@_Preco]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@_OutrosCustos]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@_OutrosCustosDescricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@_Validade]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@_ValidadeDescricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CotacaoInsertSP].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="1033" />
				<Property Name="Length" Value="12594" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;Esta Stored Procedure é tanto usada nas inserções unitárias (por exemplo a partir de um formulário na web), como&#xD;&#xA;&#x9;nas inserções em lote..&#xD;&#xA;&#xD;&#xA;&#x9;No caso das inserções em lote, antes da importação própriamente dita, as CotacoesIncompletas do fornecedor em questão &#xD;&#xA;&#x9;têm que ser removidas. Assim, o argumento @PrevineDuplicacoes deve ser passado com o valor 'false' já que esta prevenção&#xD;&#xA;&#x9;foi efetuada com antecedência.&#xD;&#xA;&#xD;&#xA;&#x9;No caso das inserções unitárias, o parametro @PrevineDuplicacoes deve ser passado com o valor 'true' para que a remoção&#xD;&#xA;&#x9;de qualquer cotação incompleta, seja feita pela própria SP.&#xD;&#xA;&#xD;&#xA;&#x9;!!! IMPORTANTE !!!&#xD;&#xA;&#x9;&gt; Existem campo que têm que ser obrigatóriamente indicados e outros que, se forem null (ou seja não indicados) serão sugeridos&#xD;&#xA;&#x9;  automáticamente com (vazio).&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;&gt; Os campos Validade e ValidadeFormula são recebidos porque os prazos de validade de uma cotação podem ser&#xD;&#xA;&#x9;  também comunicados pelo fornecedor. Se forem recebidos como NULL, então é o WhereToBuy que vai atribuir a validade.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[CotacaoInsertSP]&#xD;&#xA;&#x9;@PrevineDuplicacoes bit,&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(20),&#xD;&#xA;&#x9;@Data datetime,&#xD;&#xA;&#x9;@_ProdutoCodigo nvarchar(256),&#xD;&#xA;&#x9;@_ComplementoCodigo nvarchar(128),&#xD;&#xA;&#x9;@_ComplementoDescricao nvarchar(128),&#xD;&#xA;&#x9;@_Partnumber nvarchar(25),&#xD;&#xA;&#x9;@_MarcaCodigo nvarchar(128),&#xD;&#xA;&#x9;@_MarcaDescricao nvarchar(128),&#xD;&#xA;&#x9;@_CategoriaCodigo nvarchar(128),&#xD;&#xA;&#x9;@_CategoriaDescricao nvarchar(128),&#xD;&#xA;&#x9;@_StockCodigo nvarchar(128),&#xD;&#xA;&#x9;@_StockDescricao nvarchar(128),&#xD;&#xA;&#x9;@_ImpostoCodigo nvarchar(128),&#xD;&#xA;&#x9;@_ImpostoDescricao nvarchar(128),&#xD;&#xA;&#x9;@_EstadoCodigo nvarchar(128),&#xD;&#xA;&#x9;@_EstadoDescricao nvarchar(128),&#xD;&#xA;&#x9;@_Descricao nvarchar(256),&#xD;&#xA;&#x9;@_Link nvarchar(1024),&#xD;&#xA;&#x9;@_Caracteristicas nvarchar(2048),&#xD;&#xA;&#x9;@_Imagem nvarchar(1024),&#xD;&#xA;&#x9;@_Preco decimal(14,4),&#xD;&#xA;&#x9;@_OutrosCustos decimal(14,4),&#xD;&#xA;&#x9;@_OutrosCustosDescricao nvarchar(128),&#xD;&#xA;&#x9;@_Validade smalldatetime,&#xD;&#xA;&#x9;@_ValidadeDescricao nvarchar(128),&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Cotacoes]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[FornecedorCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[Data]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[_ProdutoCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[_ComplementoCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[_ComplementoDescricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[_Partnumber]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[_MarcaCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[_MarcaDescricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[_CategoriaCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[_CategoriaDescricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[_StockCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[_StockDescricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[_ImpostoCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[_ImpostoDescricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[_EstadoCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[_EstadoDescricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[_Descricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[_Link]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[_Caracteristicas]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="2048" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[_Imagem]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[_Preco]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[_OutrosCustos]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[_OutrosCustosDescricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[_Validade]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[_ValidadeDescricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[ComplementoCodigo]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[Partnumber]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[MarcaCodigo]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[CategoriaCodigo]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[StockCodigo]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[StockCodigoSubstituto]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[StockCodigoSubstitutoJustificacao]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[ImpostoCodigo]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[EstadoCodigo]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[Descricao]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[Link]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[Caracteristicas]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="2048" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[Imagem]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[PrecoCusto]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[PrecoCustoFormula]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[Validade]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[ValidadeFormula]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[ProdutoCodigo]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="40" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[Completo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[Integrado]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[Inativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Cotacoes].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="23" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="24" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="25" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="26" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="27" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="28" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="29" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="30" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="31" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="32" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlView" Name="[dbo].[CotacoesAtivasView]">
			<Property Name="IsSchemaBound" Value="True" />
			<Property Name="QueryScript">
				<Value><![CDATA[ 
	SELECT [FornecedorCodigo], [Data], [_ProdutoCodigo], [_ComplementoCodigo], [_ComplementoDescricao],
	       [_Partnumber], [_MarcaCodigo], [_MarcaDescricao], [_CategoriaCodigo], [_CategoriaDescricao], [_StockCodigo], [_StockDescricao],
		   [_ImpostoCodigo], [_ImpostoDescricao], [_EstadoCodigo], [_EstadoDescricao], [_Descricao], [_Link], [_Caracteristicas], [_Imagem], 
		   [_Preco], [_OutrosCustos], [_OutrosCustosDescricao], [_Validade], [_ValidadeDescricao],
		   [ComplementoCodigo], [Partnumber], [MarcaCodigo], [CategoriaCodigo], 
		   [StockCodigo], [StockCodigoSubstituto], [StockCodigoSubstitutoJustificacao], 
		   CASE WHEN [StockCodigoSubstituto] IS NULL THEN [StockCodigo] ELSE [StockCodigoSubstituto] END AS [StockCodigoEfetivo],
		   [ImpostoCodigo], [EstadoCodigo], [Descricao], [Link], [Caracteristicas], [Imagem], 
		   [PrecoCusto], [PrecoCustoFormula], [Validade], [ValidadeFormula], 
		   [ProdutoCodigo], 
		   [Completo], [Integrado],
		   [Inativo], [Versao]
	
	FROM [dbo].[Cotacoes]
	WHERE [Inativo] = CAST('false' as bit)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[FornecedorCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[_ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[_ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[_ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[_ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[_ComplementoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[_ComplementoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[_Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[_Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[_MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[_MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[_MarcaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[_MarcaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[_CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[_CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[_CategoriaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[_CategoriaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[_StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[_StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[_StockDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[_StockDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[_ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[_ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[_ImpostoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[_ImpostoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[_EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[_EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[_EstadoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[_EstadoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[_Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[_Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[_Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[_Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[_Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[_Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[_Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[_Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[_Preco]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[_Preco]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[_OutrosCustos]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[_OutrosCustos]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[_OutrosCustosDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[_OutrosCustosDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[_Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[_Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[_ValidadeDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[_ValidadeDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[StockCodigoSubstituto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[StockCodigoSubstituto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[StockCodigoSubstitutoJustificacao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[StockCodigoSubstitutoJustificacao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[StockCodigoEfetivo]" />
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[PrecoCusto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[PrecoCusto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[PrecoCustoFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[PrecoCustoFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[ValidadeFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[ValidadeFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[Completo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[Completo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[Integrado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[Integrado]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[Inativo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[Inativo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtivasView].[Versao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Cotacoes].[Versao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[Cotacoes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_ComplementoDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_MarcaDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_CategoriaDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_StockDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_ImpostoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_ImpostoDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_EstadoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_EstadoDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_Link]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_Caracteristicas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_Imagem]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_Preco]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_OutrosCustos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_OutrosCustosDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_Validade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[_ValidadeDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[StockCodigoSubstituto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[StockCodigoSubstitutoJustificacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[ImpostoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[EstadoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[Link]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[Caracteristicas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[Imagem]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[PrecoCusto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[PrecoCustoFormula]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[Validade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[ValidadeFormula]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[Completo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[Integrado]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[Versao]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="243" />
				<Property Name="Length" Value="1540" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;NOTA:&#xD;&#xA;&#x9;Esta view materializada, representa todas as cotações inativas = 'false'&#xD;&#xA;&#x9;&#x9;&gt; Incompletas&#xD;&#xA;&#x9;&#x9;&gt; Completas&#xD;&#xA;&#x9;&#x9;&gt; Integradas&#xD;&#xA;&#xD;&#xA;&#x9;- A view é materializada atendendo ao facto de poder representar um enorme volume de informação&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE VIEW [dbo].[CotacoesAtivasView] WITH SchemaBinding -- todos os campos têm que ser especificados pelo facto de ser uma view materializada&#xD;&#xA;&#x9;AS" />
				<Property Name="FooterContents" Value=";&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;-- O indice que torna esta view materializada chama-se IDX_CotacoesAtivas." />
			</Annotation>
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[CotacoesAtivasView].[CotacoesAtivasViewIndex]">
			<Property Name="IsUnique" Value="True" />
			<Property Name="IsClustered" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[CotacoesAtivasView]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlView" Name="[dbo].[CotacoesAtuaisAmplitudeExcedidaView]">
			<Property Name="QueryScript">
				<Value><![CDATA[ 

	SELECT c.ProdutoCodigo,


		   -- price amplitude of this product
		   MIN(c.PrecoCusto) / MAX(c.PrecoCusto) AS AmplitudePercentual,
		   
		   
		   -- how the deviation of the amplitude has been calculated (formula)
		   '(min/max) < A  <=>  ' +
		   '(' + CAST(MIN(c.PrecoCusto) as nvarchar) + '/' + CAST(MAX(c.PrecoCusto) as nvarchar) + ')  <  ' + CAST(t.PrecoAmplitudeMax as nvarchar) + '  <=>  ' +
		    CAST(ROUND(MIN(c.PrecoCusto) / MAX(c.PrecoCusto), 2) as nvarchar) + '  <  ' + CAST(t.PrecoAmplitudeMax as nvarchar) 
			AS AmplitudeFormulaDetecaoDesfasamento,


			-- calculate which price (min or max) is offset when compared with the average
			CASE 
				 -- if diference between min and avg is greater then the avg to the max
				 WHEN ABS(MIN(c.PrecoCusto) - AVG(c.PrecoCusto)) > (MAX(c.PrecoCusto) - AVG(c.PrecoCusto)) 
							THEN MIN(c.PrecoCusto)

				 -- if diference between min and avg is less then the avg to the max
				 WHEN ABS(MIN(c.PrecoCusto) - AVG(c.PrecoCusto)) < (MAX(c.PrecoCusto) - AVG(c.PrecoCusto)) 
							THEN MAX(c.PrecoCusto)

				 -- if min and max are the same that means that, probably, there are only 2 quotations causing the average to be the same.
				 -- if that happens, we consider that the wrong price is the lowest (min), because it is the most problematic with customers.
				 ELSE 
					MIN(c.PrecoCusto)
			END AS PrecoDesfasado,

			
			-- detecting the offset price (it is min or max the most distant from the average)
			CASE 
				 -- if diference between min and avg is greater then the avg to the max
				 WHEN ABS(MIN(c.PrecoCusto) - AVG(c.PrecoCusto)) > (MAX(c.PrecoCusto) - AVG(c.PrecoCusto)) 
							THEN '| min-avg | > (max-avg)  <=>  ' +
							     '| ' + CAST(MIN(c.PrecoCusto) as nvarchar) + '-' + CAST(AVG(c.PrecoCusto) as nvarchar) + ' | > (' + CAST(MAX(c.PrecoCusto) as nvarchar) + '-' + CAST(AVG(c.PrecoCusto) as nvarchar) + ')  <=>  ' +
								 CAST(ABS(MIN(c.PrecoCusto) - AVG(c.PrecoCusto)) as nvarchar) +' > ' + CAST((MAX(c.PrecoCusto) - AVG(c.PrecoCusto)) as nvarchar) + ' **preço mais barato é o mais afastado da média!'
								 
				 -- if diference between min and avg is less then the avg to the max
				 WHEN ABS(MIN(c.PrecoCusto) - AVG(c.PrecoCusto)) < (MAX(c.PrecoCusto) - AVG(c.PrecoCusto)) 
							THEN '| min-avg | < (max-avg)  <=>  ' +
							     '| ' + CAST(MIN(c.PrecoCusto) as nvarchar) + '-' + CAST(AVG(c.PrecoCusto) as nvarchar) + ' | < (' + CAST(MAX(c.PrecoCusto) as nvarchar) + '-' + CAST(AVG(c.PrecoCusto) as nvarchar) + ')  <=>  ' +
								 CAST(ABS(MIN(c.PrecoCusto) - AVG(c.PrecoCusto)) as nvarchar) +' < ' + CAST((MAX(c.PrecoCusto) - AVG(c.PrecoCusto)) as nvarchar) + ' **preço mais caro é o mais afastado da média!'
					
				 -- if min and max are the same that means that, probably, there are only 2 quotations causing the average to be the same.
				 -- if that happens, we consider that the wrong price is the lowest (min), because it is the most problematic with customers.
				 ELSE 
					  '| min-avg | = (max-avg) <=> probably there are only 2 quotations => consider the lowest price wrong because it is the most dangerous!'
				 
			END AS PrecoDesfasadoFormulaDecisao
			

	FROM [dbo].[CotacoesAtuaisView] c
		 INNER JOIN [dbo].[Categorias] t
			   ON c.CategoriaCodigo = t.Codigo
		 INNER JOIN [dbo].[ProdutosMatching] m
			   ON c.FornecedorCodigo = m.FornecedorCodigo
			      AND c.ComplementoCodigo = m.ComplementoCodigo
				  AND c._ProdutoCodigo = m.Codigo


	-- we want filter only quotations which ProductMatching rules are defined to not prevent PreçosDesfazados
	WHERE m.DispensaPrevencaoPrecosDesfasados = CAST('false' as bit)


	-- preform a group by each ProdutoCodigo
	GROUP BY c.ProdutoCodigo, t.PrecoAmplitudeMax


	-- filter only groups with irregular amplitude 
	-- and the product has more than one quotations to be compared
	HAVING (MIN(c.PrecoCusto) / MAX(c.PrecoCusto)) < t.PrecoAmplitudeMax
		   AND COUNT('-') >= 2]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeExcedidaView].[ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeExcedidaView].[AmplitudePercentual]" />
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeExcedidaView].[AmplitudeFormulaDetecaoDesfasamento]" />
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeExcedidaView].[PrecoDesfasado]" />
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeExcedidaView].[PrecoDesfasadoFormulaDecisao]" />
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[PrecoCusto]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[PrecoAmplitudeMax]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[DispensaPrevencaoPrecosDesfasados]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="260" />
				<Property Name="Length" Value="4352" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This view simplifies the process of determining what quotations do not respect the amplitude defined on it's category.&#xD;&#xA;&#x9;The set of quotations represented by this view, are the quotations that have problems with amplitude defined on each category.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE VIEW [dbo].[CotacoesAtuaisAmplitudeExcedidaView]&#xD;&#xA;&#x9;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlView" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView]">
			<Property Name="QueryScript">
				<Value><![CDATA[ 

	SELECT c.*,
		   ca.AmplitudePercentual, ca.AmplitudeFormulaDetecaoDesfasamento, ca.PrecoDesfasado, ca.PrecoDesfasadoFormulaDecisao

	FROM [dbo].[CotacoesAtuaisAmplitudeExcedidaView] ca
		 INNER JOIN [dbo].[CotacoesAtuaisView] c
			   ON ca.ProdutoCodigo = c.ProdutoCodigo
				  AND ca.PrecoDesfasado = c.PrecoCusto]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[FornecedorCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[_ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[_ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[_ComplementoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ComplementoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[_Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[_MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[_MarcaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_MarcaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[_CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[_CategoriaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_CategoriaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[_StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[_StockDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_StockDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[_ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[_ImpostoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ImpostoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[_EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[_EstadoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_EstadoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[_Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[_Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[_Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[_Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[_Preco]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Preco]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[_OutrosCustos]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_OutrosCustos]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[_OutrosCustosDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_OutrosCustosDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[_Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[_ValidadeDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ValidadeDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[StockCodigoSubstituto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[StockCodigoSubstituto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[StockCodigoSubstitutoJustificacao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[StockCodigoSubstitutoJustificacao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[StockCodigoEfetivo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[StockCodigoEfetivo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[PrecoCusto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[PrecoCusto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[PrecoCustoFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[PrecoCustoFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[ValidadeFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[ValidadeFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[Completo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Completo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[Integrado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Integrado]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[Inativo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Inativo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[Versao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Versao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[AmplitudePercentual]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisAmplitudeExcedidaView].[AmplitudePercentual]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[AmplitudeFormulaDetecaoDesfasamento]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisAmplitudeExcedidaView].[AmplitudeFormulaDetecaoDesfasamento]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[PrecoDesfasado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisAmplitudeExcedidaView].[PrecoDesfasado]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[PrecoDesfasadoFormulaDecisao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisAmplitudeExcedidaView].[PrecoDesfasadoFormulaDecisao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisAmplitudeExcedidaView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisAmplitudeExcedidaView].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisAmplitudeExcedidaView].[PrecoDesfasado]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[PrecoCusto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisAmplitudeExcedidaView].[AmplitudePercentual]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisAmplitudeExcedidaView].[AmplitudeFormulaDetecaoDesfasamento]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisAmplitudeExcedidaView].[PrecoDesfasadoFormulaDecisao]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="95" />
				<Property Name="Length" Value="483" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;Quotations of this view will be configured as disabled because it's offset price..&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE VIEW [dbo].[CotacoesAtuaisAmplitudeIrregularView]&#xD;&#xA;&#x9;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlView" Name="[dbo].[CotacoesAtuaisFalsoStockView]">
			<Property Name="QueryScript">
				<Value><![CDATA[ 

	SELECT 

		   -- all fields from atual quotations
		   c.*,
		   
		   -- necessary fields from stocks table
		   s.ValidadeP50_StockCodigo, s.ValidadeP60_StockCodigo, s.ValidadeP70_StockCodigo, s.ValidadeP80_StockCodigo, s.ValidadeP90_StockCodigo,

		   -- percentil data calculations
		   [dbo].[GetValidadePercentilFunction](c.Data, c.Validade, 50) AS P50,
		   [dbo].[GetValidadePercentilFunction](c.Data, c.Validade, 60) AS P60,
		   [dbo].[GetValidadePercentilFunction](c.Data, c.Validade, 70) AS P70,
		   [dbo].[GetValidadePercentilFunction](c.Data, c.Validade, 80) AS P80,
		   [dbo].[GetValidadePercentilFunction](c.Data, c.Validade, 90) AS P90

	FROM [dbo].[CotacoesAtuaisView] c
		 INNER JOIN [dbo].[Stocks] s
			   ON c.StockCodigoEfetivo = s.Codigo
		 INNER JOIN [dbo].[ProdutosMatching] m
			   ON c.FornecedorCodigo = m.FornecedorCodigo
				  AND c.ComplementoCodigo = m.ComplementoCodigo
			      AND c._ProdutoCodigo = m.Codigo

	-- apply to all actual quotations unless it's productmatching rule set it's dispensing
	WHERE m.DispensaPrevencaoFalsoStock = CAST('false' as bit)
		  AND (
				((GETDATE() >= [dbo].[GetValidadePercentilFunction](c.Data, c.Validade, 90)) AND (s.ValidadeP90_StockCodigo IS NOT NULL))
					OR ((GETDATE() >= [dbo].[GetValidadePercentilFunction](c.Data, c.Validade, 80)) AND (s.ValidadeP80_StockCodigo IS NOT NULL))
					OR ((GETDATE() >= [dbo].[GetValidadePercentilFunction](c.Data, c.Validade, 70)) AND (s.ValidadeP70_StockCodigo IS NOT NULL))
					OR ((GETDATE() >= [dbo].[GetValidadePercentilFunction](c.Data, c.Validade, 60)) AND (s.ValidadeP60_StockCodigo IS NOT NULL))
					OR ((GETDATE() >= [dbo].[GetValidadePercentilFunction](c.Data, c.Validade, 50)) AND (s.ValidadeP50_StockCodigo IS NOT NULL))
			  )]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[FornecedorCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[_ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[_ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[_ComplementoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ComplementoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[_Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[_MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[_MarcaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_MarcaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[_CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[_CategoriaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_CategoriaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[_StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[_StockDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_StockDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[_ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[_ImpostoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ImpostoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[_EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[_EstadoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_EstadoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[_Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[_Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[_Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[_Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[_Preco]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Preco]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[_OutrosCustos]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_OutrosCustos]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[_OutrosCustosDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_OutrosCustosDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[_Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[_ValidadeDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ValidadeDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[StockCodigoSubstituto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[StockCodigoSubstituto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[StockCodigoSubstitutoJustificacao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[StockCodigoSubstitutoJustificacao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[StockCodigoEfetivo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[StockCodigoEfetivo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[PrecoCusto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[PrecoCusto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[PrecoCustoFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[PrecoCustoFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[ValidadeFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[ValidadeFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[Completo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Completo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[Integrado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Integrado]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[Inativo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Inativo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[Versao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Versao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[ValidadeP50_StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Stocks].[ValidadeP50_StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[ValidadeP60_StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Stocks].[ValidadeP60_StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[ValidadeP70_StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Stocks].[ValidadeP70_StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[ValidadeP80_StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Stocks].[ValidadeP80_StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[ValidadeP90_StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Stocks].[ValidadeP90_StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[P50]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetValidadePercentilFunction]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[P60]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetValidadePercentilFunction]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[P70]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetValidadePercentilFunction]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[P80]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetValidadePercentilFunction]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisFalsoStockView].[P90]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetValidadePercentilFunction]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[StockCodigoEfetivo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[ValidadeP50_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[ValidadeP60_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[ValidadeP70_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[ValidadeP80_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[ValidadeP90_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[Validade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetValidadePercentilFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetValidadePercentilFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetValidadePercentilFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetValidadePercentilFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetValidadePercentilFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[DispensaPrevencaoFalsoStock]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetValidadePercentilFunction]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="347" />
				<Property Name="Length" Value="2194" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This view simplifies the process of determining fake stock. Creates a view that calculates percentil dates of quotation life,&#xD;&#xA;&#x9;to analise which StockCodigo must be used on Stock Substitution. &#xD;&#xA;&#xD;&#xA;&#x9;This view uses the GetValidadePercentilFunction to calculate the date inside de specified interval, correspondent to the given percentil&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE VIEW [dbo].[CotacoesAtuaisFalsoStockView]&#xD;&#xA;&#x9;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlView" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView]">
			<Property Name="QueryScript">
				<Value><![CDATA[ 

	SELECT c.*,
		   t.PrecoMinimoPermitido, t.PrecoMaximoPermitido

	FROM [dbo].[CotacoesAtuaisView] c
		 INNER JOIN [dbo].[Categorias] t
			   ON c.CategoriaCodigo = t.Codigo
		 INNER JOIN [dbo].[ProdutosMatching] m
			   ON c.FornecedorCodigo = m.FornecedorCodigo
				  AND c.ComplementoCodigo = m.ComplementoCodigo
				  AND c._ProdutoCodigo = m.Codigo

	-- filter all Actual Quotations that the price is out of the interval defined on category,
	-- considering only ProductMatching rules that are configured with DispensaPrevencaoPrecosDesfazados = 'false'
	WHERE (c.PrecoCusto < t.PrecoMinimoPermitido OR c.PrecoCusto > t.PrecoMaximoPermitido)
		  AND m.DispensaPrevencaoPrecosDesfasados = CAST('false' as bit)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[FornecedorCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[_ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[_ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[_ComplementoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ComplementoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[_Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[_MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[_MarcaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_MarcaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[_CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[_CategoriaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_CategoriaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[_StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[_StockDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_StockDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[_ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[_ImpostoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ImpostoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[_EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[_EstadoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_EstadoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[_Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[_Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[_Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[_Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[_Preco]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Preco]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[_OutrosCustos]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_OutrosCustos]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[_OutrosCustosDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_OutrosCustosDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[_Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[_ValidadeDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ValidadeDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[StockCodigoSubstituto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[StockCodigoSubstituto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[StockCodigoSubstitutoJustificacao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[StockCodigoSubstitutoJustificacao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[StockCodigoEfetivo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[StockCodigoEfetivo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[PrecoCusto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[PrecoCusto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[PrecoCustoFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[PrecoCustoFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[ValidadeFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[ValidadeFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[Completo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Completo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[Integrado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Integrado]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[Inativo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Inativo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[Versao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Versao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[PrecoMinimoPermitido]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Categorias].[PrecoMinimoPermitido]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[PrecoMaximoPermitido]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Categorias].[PrecoMaximoPermitido]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[PrecoMinimoPermitido]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Categorias].[PrecoMaximoPermitido]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[PrecoCusto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[DispensaPrevencaoPrecosDesfasados]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="118" />
				<Property Name="Length" Value="912" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This view simplifies the process of determining what quotations have price out of the category interval..&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE VIEW [dbo].[CotacoesAtuaisPrecosForaIntervaloView]&#xD;&#xA;&#x9;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlView" Name="[dbo].[CotacoesAtuaisRecalcularView]">
			<Property Name="QueryScript">
				<Value><![CDATA[ 

	SELECT -- original values from CotacoesAtuaisView
		   c.*,

		   -- calculated values of price
		   cp.PrecoCusto AS [PrecoCustoCalculado],
		   cp.Formula AS [FormulaPrecoCustoCalculado],

		   -- calculated values of expiration date
		   cv.Validade AS [ValidadeCalculada],
		   cv.Formula AS [FormulaValidadeCalculada],

		   -- calculated values of surrogate stock code
		   cs.StockCodigo AS [StockCodigoSubstitutoCalculado],
		   cs.Justificacao AS [JustificacaoStockCodigoSubstitutoCalculado],

		   -- get text fields uniformed
		   [dbo].[GetCotacaoDescricaoFunction](c._Descricao, m.Descricao, c.Partnumber, p.TermoAcrescentar, p.TermosRemover) AS [DescricaoUniformizada],
		   [dbo].[GetCotacaoCaracteristicasFunction](c._Caracteristicas) AS [CaracteristicasUniformizadas],
		   [dbo].[GetCotacaoLinkFunction](c._Link) AS [LinkUniformizado],
		   [dbo].[GetCotacaoImagemFunction](c._Imagem) AS [ImagemUniformizada]

	-- link tables and user functions as needed
	FROM [dbo].[CotacoesAtuaisView] c
		 INNER JOIN [dbo].[CotacoesRegras] cr
			   ON c.FornecedorCodigo = cr.FornecedorCodigo
				  AND c.MarcaCodigo = cr.MarcaCodigo
				  AND c.CategoriaCodigo = cr.CategoriaCodigo
				  AND c.StockCodigo = cr.StockCodigo
		 INNER JOIN [dbo].[ProdutosMatching] pm
			   ON c.FornecedorCodigo = pm.FornecedorCodigo
				  AND c.ComplementoCodigo = pm.ComplementoCodigo
				  AND c._ProdutoCodigo = pm.Codigo
		 INNER JOIN [dbo].[Marcas] m
			   ON c.MarcaCodigo = m.Codigo
		 INNER JOIN [dbo].[Complementos] p
			   ON c.ComplementoCodigo = p.Codigo
		 CROSS APPLY [dbo].[GetCotacaoPrecoFunction](c._Preco, c._OutrosCustos, c._OutrosCustosDescricao) cp
		 CROSS APPLY [dbo].[GetCotacaoValidadeFunction](c.Data, c._Validade, c._ValidadeDescricao, cr.HorasValidade, pm.HorasValidadeCotacao) cv
		 CROSS APPLY [dbo].[GetCotacaoStockSubstitutoFunction](c.StockCodigo, cr.StockCodigoSubstituto, pm.StockCodigoSubstituto) cs

	-- we want to filter only quotations that have data to be updated
	WHERE c.PrecoCusto <> cp.PrecoCusto
		  OR c.PrecoCustoFormula <> cp.Formula
		  OR c.Validade <> cv.Validade
		  OR c.ValidadeFormula <> cv.Formula
		  OR c.Descricao <> [dbo].[GetCotacaoDescricaoFunction](c._Descricao, m.Descricao, c.Partnumber, p.TermoAcrescentar, p.TermosRemover)
		  OR c.Caracteristicas <> [dbo].[GetCotacaoCaracteristicasFunction](c._Caracteristicas)
		  OR COALESCE(c.StockCodigoSubstituto, '') <> cs.StockCodigo				-- comparation of null with something else is always false
		  OR COALESCE(c.StockCodigoSubstitutoJustificacao, '') <> cs.Justificacao	-- " " "]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[FornecedorCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[_ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[_ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[_ComplementoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ComplementoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[_Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[_MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[_MarcaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_MarcaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[_CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[_CategoriaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_CategoriaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[_StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[_StockDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_StockDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[_ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[_ImpostoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ImpostoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[_EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[_EstadoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_EstadoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[_Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[_Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[_Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[_Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[_Preco]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Preco]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[_OutrosCustos]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_OutrosCustos]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[_OutrosCustosDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_OutrosCustosDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[_Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[_ValidadeDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ValidadeDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[StockCodigoSubstituto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[StockCodigoSubstituto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[StockCodigoSubstitutoJustificacao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[StockCodigoSubstitutoJustificacao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[StockCodigoEfetivo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[StockCodigoEfetivo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[PrecoCusto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[PrecoCusto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[PrecoCustoFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[PrecoCustoFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[ValidadeFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[ValidadeFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[Completo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Completo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[Integrado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Integrado]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[Inativo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Inativo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[Versao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Versao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[PrecoCustoCalculado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetCotacaoPrecoFunction].[PrecoCusto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[FormulaPrecoCustoCalculado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetCotacaoPrecoFunction].[Formula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[ValidadeCalculada]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetCotacaoValidadeFunction].[Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[FormulaValidadeCalculada]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetCotacaoValidadeFunction].[Formula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[StockCodigoSubstitutoCalculado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetCotacaoStockSubstitutoFunction].[StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[JustificacaoStockCodigoSubstitutoCalculado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetCotacaoStockSubstitutoFunction].[Justificacao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[DescricaoUniformizada]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetCotacaoDescricaoFunction]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[CaracteristicasUniformizadas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetCotacaoCaracteristicasFunction]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[LinkUniformizado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetCotacaoLinkFunction]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisRecalcularView].[ImagemUniformizada]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetCotacaoImagemFunction]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Marcas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Marcas].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[_Preco]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[_OutrosCustos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[_OutrosCustosDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoPrecoFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[_Validade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[_ValidadeDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[HorasValidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[HorasValidadeCotacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoValidadeFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[StockCodigoSubstituto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[StockCodigoSubstituto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoStockSubstitutoFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoPrecoFunction].[PrecoCusto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoPrecoFunction].[Formula]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoValidadeFunction].[Validade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoValidadeFunction].[Formula]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoStockSubstitutoFunction].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoStockSubstitutoFunction].[Justificacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[_Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Marcas].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos].[TermoAcrescentar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos].[TermosRemover]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoDescricaoFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[_Caracteristicas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoCaracteristicasFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[_Link]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoLinkFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[_Imagem]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoImagemFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[PrecoCusto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoPrecoFunction].[PrecoCusto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[PrecoCustoFormula]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoPrecoFunction].[Formula]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[Validade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoValidadeFunction].[Validade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[ValidadeFormula]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoValidadeFunction].[Formula]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoDescricaoFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[Caracteristicas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoCaracteristicasFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[StockCodigoSubstituto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoStockSubstitutoFunction].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[StockCodigoSubstitutoJustificacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoStockSubstitutoFunction].[Justificacao]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="256" />
				<Property Name="Length" Value="2940" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;On this step, we must be sure that all fields in Actual Quotations (CotacoesAtuais) are correctly fulfilled regarding to actual&#xD;&#xA;&#x9;ProdutosMatching and CotacoesRegras rules..&#xD;&#xA;&#xD;&#xA;&#x9;This view reuses functions implemented to step 2 - normalization.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE VIEW [dbo].[CotacoesAtuaisRecalcularView]&#xD;&#xA;&#x9;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlView" Name="[dbo].[CotacoesAtuaisView]">
			<Property Name="QueryScript">
				<Value><![CDATA[ 
	SELECT *
	FROM [dbo].[CotacoesAtivasView]
	WHERE [Integrado] = CAST('true' as bit)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[FornecedorCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[_ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[_ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[_ComplementoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_ComplementoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[_Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[_MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[_MarcaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_MarcaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[_CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[_CategoriaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_CategoriaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[_StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[_StockDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_StockDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[_ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[_ImpostoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_ImpostoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[_EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[_EstadoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_EstadoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[_Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[_Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[_Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[_Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[_Preco]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_Preco]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[_OutrosCustos]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_OutrosCustos]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[_OutrosCustosDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_OutrosCustosDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[_Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[_ValidadeDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_ValidadeDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[StockCodigoSubstituto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[StockCodigoSubstituto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[StockCodigoSubstitutoJustificacao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[StockCodigoSubstitutoJustificacao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[StockCodigoEfetivo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[StockCodigoEfetivo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[PrecoCusto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[PrecoCusto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[PrecoCustoFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[PrecoCustoFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[ValidadeFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[ValidadeFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[Completo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Completo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[Integrado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Integrado]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[Inativo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Inativo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesAtuaisView].[Versao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Versao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAtivasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtivasView].[Integrado]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="339" />
				<Property Name="Length" Value="470" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;Esta View facilita a vista sobre as cotações já integradas (ativas). O conjunto de CotacoesAtuais representa o conjunto de cotações&#xD;&#xA;&#x9;atualmente válidas de cada fornecedor para cada produto.&#xD;&#xA;&#x9;(Uma cotação atual está completa e integrada e significad que pode ser usada como base para o algoritmo de eleição da melhor cotação)&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE VIEW [dbo].[CotacoesAtuaisView]&#xD;&#xA;&#x9;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[CotacoesAvisos]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[CotacoesAvisos].[Id]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[CotacoesAvisos].[Data]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[CotacoesAvisos].[_ProdutoCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[CotacoesAvisos].[_ComplementoCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[CotacoesAvisos].[FornecedorCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[CotacoesAvisos].[AvisoTipoCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[CotacoesAvisos].[Descricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="2048" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[CotacoesAvisos].[Criacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="33" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="34" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="35" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="36" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlView" Name="[dbo].[CotacoesIncompletasFinalizacaoView]">
			<Property Name="QueryScript">
				<Value><![CDATA[ 

	SELECT *
	FROM [dbo].[CotacoesIncompletasView] ci

	-- we want to filter only quotations that are fully mapped
	WHERE ci.MarcaCodigo IS NOT NULL
		  AND ci.CategoriaCodigo IS NOT NULL
		  AND ci.StockCodigo IS NOT NULL
		  AND ci.ImpostoCodigo IS NOT NULL
		  AND ci.ComplementoCodigo IS NOT NULL
		  AND ci.EstadoCodigo IS NOT NULL
		  AND ci.ProdutoCodigo IS NOT NULL
		  AND ci.Descricao IS NOT NULL
		  AND ci.Caracteristicas IS NOT NULL
		  AND ci.Link IS NOT NULL
		  AND ci.Imagem IS NOT NULL
		  AND ci.PrecoCusto IS NOT NULL
		  AND ci.PrecoCustoFormula IS NOT NULL
		  AND ci.Validade IS NOT NULL
		  AND ci.ValidadeFormula IS NOT NULL]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[FornecedorCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[_ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[_ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[_ComplementoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_ComplementoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[_Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[_MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[_MarcaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_MarcaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[_CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[_CategoriaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_CategoriaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[_StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[_StockDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_StockDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[_ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[_ImpostoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_ImpostoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[_EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[_EstadoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_EstadoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[_Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[_Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[_Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[_Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[_Preco]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_Preco]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[_OutrosCustos]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_OutrosCustos]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[_OutrosCustosDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_OutrosCustosDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[_Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[_ValidadeDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_ValidadeDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[StockCodigoSubstituto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[StockCodigoSubstituto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[StockCodigoSubstitutoJustificacao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[StockCodigoSubstitutoJustificacao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[StockCodigoEfetivo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[StockCodigoEfetivo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[PrecoCusto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[PrecoCusto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[PrecoCustoFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[PrecoCustoFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[ValidadeFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[ValidadeFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[Completo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Completo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[Integrado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Integrado]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[Inativo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Inativo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasFinalizacaoView].[Versao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Versao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[ImpostoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[EstadoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[Caracteristicas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[Link]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[Imagem]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[PrecoCusto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[PrecoCustoFormula]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[Validade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[ValidadeFormula]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="122" />
				<Property Name="Length" Value="850" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This view represents all Incomplete Quotations that are ready to be configured as completed (Completo = True)&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE VIEW [dbo].[CotacoesIncompletasFinalizacaoView]&#xD;&#xA;&#x9;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlView" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView]">
			<Property Name="QueryScript">
				<Value><![CDATA[ 
	SELECT *, [dbo].[GetProdutoCodigoFunction](Partnumber, MarcaCodigo, ComplementoCodigo) AS [Referencia]
	FROM [dbo].[CotacoesIncompletasView]
	WHERE MarcaCodigo IS NOT NULL
		  AND CategoriaCodigo IS NOT NULL
		  AND StockCodigo IS NOT NULL
		  AND ImpostoCodigo IS NOT NULL
		  AND ComplementoCodigo IS NOT NULL
		  AND EstadoCodigo IS NOT NULL
		  AND ProdutoCodigo IS NULL]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[FornecedorCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ComplementoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_ComplementoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_MarcaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_MarcaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_CategoriaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_CategoriaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_StockDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_StockDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ImpostoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_ImpostoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_EstadoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_EstadoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_Preco]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_Preco]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_OutrosCustos]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_OutrosCustos]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_OutrosCustosDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_OutrosCustosDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ValidadeDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_ValidadeDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[StockCodigoSubstituto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[StockCodigoSubstituto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[StockCodigoSubstitutoJustificacao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[StockCodigoSubstitutoJustificacao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[StockCodigoEfetivo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[StockCodigoEfetivo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[PrecoCusto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[PrecoCusto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[PrecoCustoFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[PrecoCustoFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[ValidadeFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[ValidadeFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Completo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Completo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Integrado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Integrado]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Inativo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Inativo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Versao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Versao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Referencia]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoCodigoFunction]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoCodigoFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[ImpostoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[EstadoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[ProdutoCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="248" />
				<Property Name="Length" Value="699" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This view represents all Incomplete Quotations that the only map missing it is Produtocodigo.&#xD;&#xA;&#xD;&#xA;&#x9;This view add Referencia field to CotacoesIncompletasView. &#xD;&#xA;&#x9;This new field represents the Product Code correspondent to Quotations row.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE VIEW [dbo].[CotacoesIncompletasMapeamentoProdutoView]&#xD;&#xA;&#x9;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlView" Name="[dbo].[CotacoesIncompletasNormalizacaoView]">
			<Property Name="QueryScript">
				<Value><![CDATA[ 

	SELECT -- original values from CotacoesIncompletasView
		   ci.*,

		   -- calculated values of price
		   cp.PrecoCusto AS [PrecoCustoCalculado],
		   cp.Formula AS [FormulaPrecoCustoCalculado],

		   -- calculated values of expiration date
		   cv.Validade AS [ValidadeCalculada],
		   cv.Formula AS [FormulaValidadeCalculada],

		   -- calculated values of surrogate stock code
		   cs.StockCodigo AS [StockCodigoSubstitutoCalculado],
		   cs.Justificacao AS [JustificacaoStockCodigoSubstitutoCalculado],

		   -- get text fields uniformed
		   [dbo].[GetCotacaoDescricaoFunction](ci._Descricao, m.Descricao, ci.Partnumber, p.TermoAcrescentar, p.TermosRemover) AS [DescricaoUniformizada],
		   [dbo].[GetCotacaoCaracteristicasFunction](ci._Caracteristicas) AS [CaracteristicasUniformizadas],
		   [dbo].[GetCotacaoLinkFunction](ci._Link) AS [LinkUniformizado],
		   [dbo].[GetCotacaoImagemFunction](ci._Imagem) AS [ImagemUniformizada]

	-- link tables and user functions as needed
	FROM [dbo].[CotacoesIncompletasView] ci
		 INNER JOIN [dbo].[CotacoesRegras] cr
			   ON ci.FornecedorCodigo = cr.FornecedorCodigo
				  AND ci.MarcaCodigo = cr.MarcaCodigo
				  AND ci.CategoriaCodigo = cr.CategoriaCodigo
				  AND ci.StockCodigo = cr.StockCodigo
		 INNER JOIN [dbo].[ProdutosMatching] pm
			   ON ci.FornecedorCodigo = pm.FornecedorCodigo
				  AND ci.ComplementoCodigo = pm.ComplementoCodigo
				  AND ci._ProdutoCodigo = pm.Codigo
		 INNER JOIN [dbo].[Marcas] m
			   ON ci.MarcaCodigo = m.Codigo
		 INNER JOIN [dbo].[Complementos] p
			   ON ci.ComplementoCodigo = p.Codigo
		 CROSS APPLY [dbo].[GetCotacaoPrecoFunction](ci._Preco, ci._OutrosCustos, ci._OutrosCustosDescricao) cp
		 CROSS APPLY [dbo].[GetCotacaoValidadeFunction](ci.Data, ci._Validade, ci._ValidadeDescricao, cr.HorasValidade, pm.HorasValidadeCotacao) cv
		 CROSS APPLY [dbo].[GetCotacaoStockSubstitutoFunction](ci.StockCodigo, cr.StockCodigoSubstituto, pm.StockCodigoSubstituto) cs

	-- we want to filter only quotations that are fully mapped
	WHERE ci.MarcaCodigo IS NOT NULL
		  AND ci.CategoriaCodigo IS NOT NULL
		  AND ci.StockCodigo IS NOT NULL
		  AND ci.ImpostoCodigo IS NOT NULL
		  AND ci.ComplementoCodigo IS NOT NULL
		  AND ci.EstadoCodigo IS NOT NULL
		  AND ci.ProdutoCodigo IS NOT NULL]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[FornecedorCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[_ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[_ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[_ComplementoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_ComplementoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[_Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[_MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[_MarcaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_MarcaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[_CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[_CategoriaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_CategoriaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[_StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[_StockDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_StockDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[_ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[_ImpostoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_ImpostoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[_EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[_EstadoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_EstadoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[_Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[_Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[_Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[_Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[_Preco]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_Preco]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[_OutrosCustos]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_OutrosCustos]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[_OutrosCustosDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_OutrosCustosDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[_Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[_ValidadeDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[_ValidadeDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[StockCodigoSubstituto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[StockCodigoSubstituto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[StockCodigoSubstitutoJustificacao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[StockCodigoSubstitutoJustificacao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[StockCodigoEfetivo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[StockCodigoEfetivo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[PrecoCusto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[PrecoCusto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[PrecoCustoFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[PrecoCustoFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[ValidadeFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[ValidadeFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[Completo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Completo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[Integrado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Integrado]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[Inativo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Inativo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[Versao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasView].[Versao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[PrecoCustoCalculado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetCotacaoPrecoFunction].[PrecoCusto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[FormulaPrecoCustoCalculado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetCotacaoPrecoFunction].[Formula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[ValidadeCalculada]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetCotacaoValidadeFunction].[Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[FormulaValidadeCalculada]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetCotacaoValidadeFunction].[Formula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[StockCodigoSubstitutoCalculado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetCotacaoStockSubstitutoFunction].[StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[JustificacaoStockCodigoSubstitutoCalculado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetCotacaoStockSubstitutoFunction].[Justificacao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[DescricaoUniformizada]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetCotacaoDescricaoFunction]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[CaracteristicasUniformizadas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetCotacaoCaracteristicasFunction]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[LinkUniformizado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetCotacaoLinkFunction]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasNormalizacaoView].[ImagemUniformizada]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetCotacaoImagemFunction]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Marcas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Marcas].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_Preco]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_OutrosCustos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_OutrosCustosDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoPrecoFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_Validade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ValidadeDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[HorasValidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[HorasValidadeCotacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoValidadeFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[StockCodigoSubstituto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[StockCodigoSubstituto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoStockSubstitutoFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoPrecoFunction].[PrecoCusto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoPrecoFunction].[Formula]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoValidadeFunction].[Validade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoValidadeFunction].[Formula]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoStockSubstitutoFunction].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoStockSubstitutoFunction].[Justificacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Marcas].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos].[TermoAcrescentar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos].[TermosRemover]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoDescricaoFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_Caracteristicas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoCaracteristicasFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_Link]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoLinkFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_Imagem]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoImagemFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[ImpostoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[EstadoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[ProdutoCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="215" />
				<Property Name="Length" Value="2604" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This view represents all Incomplete Quotations that are ready to last step of fulfillment - Normalization&#xD;&#xA;&#x9;This view consumes SQL User Functions to calculate values to be updated on quotations records.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE VIEW [dbo].[CotacoesIncompletasNormalizacaoView]&#xD;&#xA;&#x9;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlView" Name="[dbo].[CotacoesIncompletasView]">
			<Property Name="QueryScript">
				<Value><![CDATA[ 
	SELECT *
	FROM [dbo].[CotacoesAtivasView]
	WHERE [Completo] = CAST('false' as bit)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[_ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[_ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[_ComplementoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_ComplementoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[_Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[_MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[_MarcaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_MarcaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[_CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[_CategoriaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_CategoriaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[_StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[_StockDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_StockDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[_ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[_ImpostoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_ImpostoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[_EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[_EstadoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_EstadoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[_Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[_Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[_Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[_Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[_Preco]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_Preco]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[_OutrosCustos]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_OutrosCustos]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[_OutrosCustosDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_OutrosCustosDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[_Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[_ValidadeDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_ValidadeDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[StockCodigoSubstituto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[StockCodigoSubstituto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[StockCodigoSubstitutoJustificacao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[StockCodigoSubstitutoJustificacao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[StockCodigoEfetivo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[StockCodigoEfetivo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[PrecoCusto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[PrecoCusto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[PrecoCustoFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[PrecoCustoFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[ValidadeFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[ValidadeFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[Completo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Completo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[Integrado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Integrado]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[Inativo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Inativo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesIncompletasView].[Versao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Versao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAtivasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtivasView].[Completo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="357" />
				<Property Name="Length" Value="493" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;Esta View facilita a vista sobre as cotações incompletas e, lógicamente, não integradas (já que uma cotação só pode ser integrada depois de estar completa)&#xD;&#xA;&#x9;(Uma cotação incompleta é aquela que falta informação, por exemplo, mapeamentos..)&#xD;&#xA;&#x9;(Uma cotação incompleta é uma cotação que ainda falta sofrer processamento para poder ser integrada!)&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE VIEW [dbo].[CotacoesIncompletasView]&#xD;&#xA;&#x9;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlView" Name="[dbo].[CotacoesMatrizCriacaoProdutosView]">
			<Property Name="QueryScript">
				<Value><![CDATA[ 

	SELECT *
	FROM
		(
			-- Get all quotations coming from suppliers autorized for automatic product creation, adding a last field with
			-- a numerator that resets every time that Referencia change. (It works like a counter of rows that have the same Referencia)
			SELECT c.*, ROW_NUMBER() OVER (PARTITION BY c.Referencia ORDER BY Referencia ASC) AS Classificacao
			FROM [dbo].[CotacoesIncompletasMapeamentoProdutoView] c
				 INNER JOIN [dbo].Fornecedores f
					   ON c.FornecedorCodigo = f.Codigo
			WHERE f.ProdutosCriacaoAutomatica = CAST('true' as bit)

		) cm1

	-- filter only the first row of each Referencia present in incomplete quotations view
	WHERE cm1.Classificacao = 1
		  -- and make sure that, that Referencia belongs to the group of not existing products 
		  -- (meaning that this Referencia is not a Product already created)
		  AND cm1.Referencia IN 
					(
						SELECT Referencia FROM [dbo].[ProdutosCodigosInexistentesView]
					)
		  -- make sure too, that the Partnumber does not belong to the ambiguous partnumbers set
		  AND cm1.Partnumber NOT IN
					(
						SELECT Partnumber FROM [dbo].[PartnumbersAmbiguosView]
					)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[FornecedorCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[_ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[_ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[_ComplementoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ComplementoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[_Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[_MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[_MarcaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_MarcaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[_CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[_CategoriaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_CategoriaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[_StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[_StockDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_StockDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[_ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[_ImpostoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ImpostoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[_EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[_EstadoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_EstadoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[_Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[_Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[_Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[_Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[_Preco]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_Preco]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[_OutrosCustos]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_OutrosCustos]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[_OutrosCustosDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_OutrosCustosDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[_Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[_ValidadeDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ValidadeDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[StockCodigoSubstituto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[StockCodigoSubstituto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[StockCodigoSubstitutoJustificacao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[StockCodigoSubstitutoJustificacao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[StockCodigoEfetivo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[StockCodigoEfetivo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[PrecoCusto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[PrecoCusto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[PrecoCustoFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[PrecoCustoFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[ValidadeFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[ValidadeFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[Completo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Completo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[Integrado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Integrado]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[Inativo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Inativo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[Versao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Versao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[Referencia]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Referencia]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[Classificacao]" />
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Referencia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Referencia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ProdutosCriacaoAutomatica]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Referencia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosCodigosInexistentesView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosCodigosInexistentesView].[Referencia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[PartnumbersAmbiguosView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[PartnumbersAmbiguosView].[Partnumber]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="317" />
				<Property Name="Length" Value="1558" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;With this view we want to create a mechanism to simplify product creating (rows creation on Product table)&#xD;&#xA;&#xD;&#xA;&#x9;This view is a set of quotations, ensuring only 1 row by Referencia.&#xD;&#xA;&#xD;&#xA;&#x9;Only Quotations belonging to suppliers that are configured to automatic product creation are considered on this set.&#xD;&#xA;&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE VIEW [dbo].[CotacoesMatrizCriacaoProdutosView]&#xD;&#xA;&#x9;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlView" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView]">
			<Property Name="QueryScript">
				<Value><![CDATA[ 

	SELECT *
	FROM
		(
				-- Get all quotations coming from suppliers autorized to automatic match rules of Product Matchings.
				-- Add a last field with a numerator that resets every time that change the sequence FornecedorCodigo / ComplementoCodigo / _ProdutoCodigo
				-- The numerator works as a counter of rows with the same FornecedorCodigo / ComplementoCodigo / _ProdutoCodigo
				SELECT c.*, ROW_NUMBER() OVER (
												PARTITION BY c.FornecedorCodigo, c.ComplementoCodigo, c._ProdutoCodigo 
												ORDER BY c.FornecedorCodigo, c.ComplementoCodigo, c._ProdutoCodigo 
											  ) AS [Classificacao]
				FROM [dbo].[CotacoesIncompletasMapeamentoProdutoView] c
					 INNER JOIN [dbo].[Fornecedores] f
						ON c.FornecedorCodigo = f.Codigo
				WHERE f.ProdutosMatchingAutomatico = CAST('true' as bit)
		) cm1

	-- filter only the first occurrence of FornecedorCodigo / ComplementoCodigo / _ProdutoCodigo
	WHERE cm1.Classificacao = 1
		  -- and make sure that only get quotations of already created products
		  AND cm1.Referencia IN
			  (
				   SELECT Codigo FROM [dbo].[Produtos]
			  )]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[FornecedorCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[_ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[_ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[_ComplementoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ComplementoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[_Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[_MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[_MarcaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_MarcaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[_CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[_CategoriaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_CategoriaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[_StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[_StockDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_StockDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[_ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[_ImpostoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ImpostoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[_EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[_EstadoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_EstadoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[_Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[_Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[_Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[_Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[_Preco]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_Preco]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[_OutrosCustos]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_OutrosCustos]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[_OutrosCustosDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_OutrosCustosDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[_Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[_ValidadeDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ValidadeDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[StockCodigoSubstituto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[StockCodigoSubstituto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[StockCodigoSubstitutoJustificacao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[StockCodigoSubstitutoJustificacao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[StockCodigoEfetivo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[StockCodigoEfetivo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[PrecoCusto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[PrecoCusto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[PrecoCustoFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[PrecoCustoFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[ValidadeFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[ValidadeFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[Completo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Completo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[Integrado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Integrado]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[Inativo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Inativo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[Versao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Versao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[Referencia]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Referencia]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[Classificacao]" />
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ProdutosMatchingAutomatico]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Referencia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="297" />
				<Property Name="Length" Value="1491" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;Shows in a single only row per correspondence FornecedorCodigo, ComplementoCodigo, _ProdutoCodigo,&#xD;&#xA;&#x9;quotations that does exist in Product table (Product already exists).&#xD;&#xA;&#xD;&#xA;&#x9;We want to Map all Product Matching rules that correspondent ProdutoCodigo already exists on Product table.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE VIEW [dbo].[CotacoesMatrizPreenchimentoMapToView]&#xD;&#xA;&#x9;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlView" Name="[dbo].[CotacoesNaoIntegradasView]">
			<Property Name="QueryScript">
				<Value><![CDATA[ 
	SELECT *
	FROM [dbo].[CotacoesAtivasView]
	WHERE [Completo] = CAST('true' as bit)
		  AND [Integrado] = CAST('false' as bit)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[FornecedorCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[_ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[_ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[_ComplementoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_ComplementoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[_Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[_MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[_MarcaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_MarcaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[_CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[_CategoriaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_CategoriaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[_StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[_StockDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_StockDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[_ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[_ImpostoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_ImpostoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[_EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[_EstadoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_EstadoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[_Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[_Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[_Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[_Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[_Preco]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_Preco]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[_OutrosCustos]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_OutrosCustos]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[_OutrosCustosDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_OutrosCustosDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[_Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[_ValidadeDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[_ValidadeDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[StockCodigoSubstituto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[StockCodigoSubstituto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[StockCodigoSubstitutoJustificacao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[StockCodigoSubstitutoJustificacao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[StockCodigoEfetivo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[StockCodigoEfetivo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[PrecoCusto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[PrecoCusto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[PrecoCustoFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[PrecoCustoFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[ValidadeFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[ValidadeFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[Completo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Completo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[Integrado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Integrado]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[Inativo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Inativo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesNaoIntegradasView].[Versao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtivasView].[Versao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAtivasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtivasView].[Completo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtivasView].[Integrado]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="155" />
				<Property Name="Length" Value="336" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;Esta View facilita a vista sobre as cotações completas mas ainda não integradas &#xD;&#xA;&#x9;(candidatas a integrar ou seja candidatas a CotacoesAtuais)&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE VIEW [dbo].[CotacoesNaoIntegradasView]&#xD;&#xA;&#x9;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[CotacoesRegras]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[CotacoesRegras].[FornecedorCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[CotacoesRegras].[MarcaCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[CotacoesRegras].[CategoriaCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[CotacoesRegras].[StockCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[CotacoesRegras].[HorasValidade]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[CotacoesRegras].[StockCodigoSubstituto]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[CotacoesRegras].[DataReset]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[CotacoesRegras].[Notas]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[CotacoesRegras].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="37" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="38" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="39" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="40" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="41" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="42" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlView" Name="[dbo].[CotacoesVencedorasView]">
			<Property Name="QueryScript">
				<Value><![CDATA[ 
		
	SELECT *
	FROM
		(

			SELECT cc1.*, ROW_NUMBER() OVER (PARTITION BY cc1.ProdutoCodigo 
													   ORDER BY s3.DisponibilidadeNivel DESC
											) AS Classificacao2
			FROM
				(

					-- subset of Actual Quotations with stock availability
					SELECT c1.*,
						   ROW_NUMBER() OVER (PARTITION BY c1.ProdutoCodigo 
														ORDER BY c1.PrecoCusto ASC,
																 ((f1.ProdutosConfiancaPreco + f1.ProdutosConfiancaDisponibilidade) / 2) DESC
											 ) AS Classificacao1

					FROM [dbo].[CotacoesAtuaisView] c1
						 INNER JOIN [dbo].[Fornecedores] f1
							   ON c1.FornecedorCodigo = f1.Codigo
						 INNER JOIN [dbo].[Stocks] s1
							   ON c1.StockCodigoEfetivo = s1.Codigo

					-- filter only quotations which has availability of stock
					WHERE s1.DisponibilidadeNivel > 0


					UNION


					-- subset of Actual Quotations with no stock availability
					SELECT c2.*,
						   ROW_NUMBER() OVER (PARTITION BY c2.ProdutoCodigo 
														ORDER BY c2.PrecoCusto ASC,
																 ((f2.ProdutosConfiancaPreco + f2.ProdutosConfiancaDisponibilidade) / 2) DESC
											 ) AS Classificacao1

					FROM [dbo].[CotacoesAtuaisView] c2
						 INNER JOIN [dbo].[Fornecedores] f2
							   ON c2.FornecedorCodigo = f2.Codigo
						 INNER JOIN [dbo].[Stocks] s2
							   ON c2.StockCodigoEfetivo = s2.Codigo

					-- filter only quotations which has availability of stock
					WHERE s2.DisponibilidadeNivel <= 0
	
				) cc1
					 INNER JOIN [dbo].[Stocks] s3
						   ON cc1.StockCodigoEfetivo = s3.Codigo
	
			-- filter only
			WHERE cc1.Classificacao1 = 1

		) cc2

	-- only the first quotation of each partition
	WHERE cc2.Classificacao2 = 1]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[FornecedorCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[_ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[_ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[_ComplementoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ComplementoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[_Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[_MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[_MarcaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_MarcaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[_CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[_CategoriaDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_CategoriaDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[_StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[_StockDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_StockDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[_ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[_ImpostoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ImpostoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[_EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[_EstadoDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_EstadoDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[_Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[_Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[_Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[_Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[_Preco]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Preco]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[_OutrosCustos]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_OutrosCustos]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[_OutrosCustosDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_OutrosCustosDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[_Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[_ValidadeDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[_ValidadeDescricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[ComplementoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[StockCodigoSubstituto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[StockCodigoSubstituto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[StockCodigoSubstitutoJustificacao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[StockCodigoSubstitutoJustificacao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[StockCodigoEfetivo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[StockCodigoEfetivo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[EstadoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[EstadoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[Link]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Link]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[Caracteristicas]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Caracteristicas]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[Imagem]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Imagem]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[PrecoCusto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[PrecoCusto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[PrecoCustoFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[PrecoCustoFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[Validade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Validade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[ValidadeFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[ValidadeFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[ProdutoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[Completo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Completo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[Integrado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Integrado]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[Inativo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Inativo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[Versao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesAtuaisView].[Versao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[Classificacao1]" />
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[CotacoesVencedorasView].[Classificacao2]" />
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[StockCodigoEfetivo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[PrecoCusto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ProdutosConfiancaPreco]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ProdutosConfiancaDisponibilidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[DisponibilidadeNivel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[StockCodigoEfetivo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[PrecoCusto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ProdutosConfiancaPreco]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ProdutosConfiancaDisponibilidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[DisponibilidadeNivel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[StockCodigoEfetivo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[DisponibilidadeNivel]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="250" />
				<Property Name="Length" Value="2038" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This view shows all winner quotations. &#xD;&#xA;&#x9;Winner Quotations are all Actual Quotations (one by ProdutoCodigo) that it is the best offer (stock + price).&#xD;&#xA;&#x9;It's based on winner quotations that is made the update of price on product record.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE VIEW [dbo].[CotacoesVencedorasView]&#xD;&#xA;&#x9;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Estados]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Estados].[Codigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Estados].[Descricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Estados].[Inativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Estados].[Criacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Estados].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="43" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[EstadosMatching]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[EstadosMatching].[FornecedorCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[EstadosMatching].[Codigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[EstadosMatching].[Descricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[EstadosMatching].[MapTo]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[EstadosMatching].[Inativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[EstadosMatching].[Criacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[EstadosMatching].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="44" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="45" />
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="46" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_CategoriasMatching_Fornecedor]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[FornecedorCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[CategoriasMatching]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="12" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_CategoriasMatching_MapTo]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[MapTo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[CategoriasMatching]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Categorias].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Categorias]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="13" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Classes_Catalogo]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Classes].[CatalogoCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Classes]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Catalogos].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Catalogos]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="15" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_ClassesCategorias_Categoria]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[ClassesCategorias].[CategoriaCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[ClassesCategorias]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Categorias].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Categorias]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="18" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_ClassesCategorias_Classe]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[ClassesCategorias].[ClasseCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[ClassesCategorias]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Classes].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Classes]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="17" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_ComplementosMatching_Fornecedor]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[FornecedorCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[ComplementosMatching]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="21" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_ComplementosMatching_MapTo]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[MapTo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[ComplementosMatching]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Complementos].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Complementos]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="22" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Cotacoes_Categoria]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Cotacoes].[CategoriaCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Cotacoes]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Categorias].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Categorias]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="27" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Cotacoes_Complemento]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Cotacoes].[ComplementoCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Cotacoes]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Complementos].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Complementos]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="25" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Cotacoes_Estado]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Cotacoes].[EstadoCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Cotacoes]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Estados].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Estados]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="31" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Cotacoes_Fornecedor]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Cotacoes].[FornecedorCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Cotacoes]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="24" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Cotacoes_Imposto]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Cotacoes].[ImpostoCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Cotacoes]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Impostos].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Impostos]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="30" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Cotacoes_Marca]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Cotacoes].[MarcaCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Cotacoes]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Marcas].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Marcas]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="26" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Cotacoes_Produto]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Cotacoes].[ProdutoCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Cotacoes]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Produtos].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Produtos]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="32" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Cotacoes_Stock]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Cotacoes].[StockCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Cotacoes]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="28" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Cotacoes_StockSubstituto]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Cotacoes].[StockCodigoSubstituto]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Cotacoes]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="29" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_CotacoesAvisos_AvisoTipo]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[AvisoTipoCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[CotacoesAvisos]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[AvisosTipo].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[AvisosTipo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="35" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_CotacoesAvisos_Fornecedor]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[FornecedorCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[CotacoesAvisos]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="34" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_CotacoesRegras_Categoria]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[CategoriaCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[CotacoesRegras]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Categorias].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Categorias]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="40" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_CotacoesRegras_Fornecedor]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[FornecedorCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[CotacoesRegras]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="38" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_CotacoesRegras_Marca]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[MarcaCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[CotacoesRegras]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Marcas].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Marcas]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="39" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_CotacoesRegras_Stock]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[StockCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[CotacoesRegras]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="41" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_CotacoesRegras_StockSubstituto]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[StockCodigoSubstituto]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[CotacoesRegras]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="42" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_EstadosMatching_Fornecedor]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[EstadosMatching].[FornecedorCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[EstadosMatching]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="45" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_EstadosMatching_MapTo]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[EstadosMatching].[MapTo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[EstadosMatching]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Estados].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Estados]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="46" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_FornecedoresMarcas_Fornecedor]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas].[FornecedorCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="47" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_FornecedoresMarcas_marca]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas].[MarcaCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Marcas].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Marcas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="48" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_ImpostosMatching_Fornecedor]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[FornecedorCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[ImpostosMatching]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="49" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_ImpostosMatching_MapTo]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[MapTo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[ImpostosMatching]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Impostos].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Impostos]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="50" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_MarcasMatching_Fornecedor]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[MarcasMatching].[FornecedorCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[MarcasMatching]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="51" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_MarcasMatching_MapTo]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[MarcasMatching].[MapTo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[MarcasMatching]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Marcas].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Marcas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="52" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Produtos_Categoria]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Produtos].[CategoriaCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Produtos]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Categorias].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Categorias]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="53" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Produtos_Fornecedor]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Produtos].[FornecedorCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Produtos]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="54" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Produtos_Imposto]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Produtos].[ImpostoCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Produtos]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Impostos].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Impostos]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="55" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Produtos_Marca]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Produtos].[MarcaCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Produtos]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Marcas].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Marcas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="56" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Produtos_Stock]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Produtos]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="57" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Produtos_Stock_U1]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U1]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Produtos]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="58" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Produtos_Stock_U2]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U2]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Produtos]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="59" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Produtos_Stock_U3]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U3]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Produtos]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="60" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_ProdutosDetalhe_Fornecedor]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[FornecedorCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="61" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_ProdutosDetalhe_Produto]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[ProdutoCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Produtos].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Produtos]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="62" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_ProdutosMatching_Fornecedor]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[FornecedorCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[ProdutosMatching]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="63" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_ProdutosMatching_MapTo]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[MapTo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[ProdutosMatching]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Produtos].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Produtos]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="64" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_ProdutosMatching_StockSubstituto]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[StockCodigoSubstituto]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[ProdutosMatching]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="65" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Stocks_ValidadeP50]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Stocks].[ValidadeP50_StockCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="66" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Stocks_ValidadeP60]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Stocks].[ValidadeP60_StockCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="67" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Stocks_ValidadeP70]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Stocks].[ValidadeP70_StockCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="68" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Stocks_ValidadeP80]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Stocks].[ValidadeP80_StockCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="69" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Stocks_ValidadeP90]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Stocks].[ValidadeP90_StockCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="70" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_StocksMatching_Fornecedor]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[StocksMatching].[FornecedorCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[StocksMatching]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="71" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_StocksMatching_MapTo]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[StocksMatching].[MapTo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[StocksMatching]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="72" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Subgrupos_Grupo]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Subgrupos].[GrupoCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Subgrupos]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Grupos].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Grupos]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="73" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_SubgruposClasses_Classe]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[SubgruposClasses].[ClasseCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[SubgruposClasses]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Classes].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Classes]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="74" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_SubgruposClasses_Subgrupo]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[SubgruposClasses].[SubgrupoCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[SubgruposClasses]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Subgrupos].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Subgrupos]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="75" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_Utilizador_Idioma]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Utilizadores].[IdiomaCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Utilizadores]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Idiomas].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Idiomas]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="76" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Fornecedores]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[Codigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[Nome]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[Morada]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="200" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[CodigoPostal]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="15" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[LocalidadePostal]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[Contribuinte]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[Vendedor]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[Telefone]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[Telemovel]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="15" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[SMS]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="15" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[Email]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[AcessoOnlineAtivo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[Username]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[Password]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[HorasValidadeSugestao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[ProdutosMatchingAutomatico]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[ProdutosCriacaoAutomatica]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[DisponibilizaInfoProdutoDetalhe]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[DescricaoPontuacaoInicial]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[CaracteristicasPontuacaoInicial]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[LinkPontuacaoInicial]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[ImagemPontuacaoInicial]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[DescricaoSugereInativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[CaracteristicasSugereInativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[LinkSugereInativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[ImagemSugereInativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[AtualizacaoAutomaticaInativaSugestao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[ProdutosConfiancaPreco]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[ProdutosConfiancaDisponibilidade]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[IndiceConfianca]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[Inativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[Criacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Fornecedores].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="77" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[FornecedoresMarcas]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[FornecedoresMarcas].[FornecedorCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[FornecedoresMarcas].[MarcaCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[FornecedoresMarcas].[Confianca]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[FornecedoresMarcas].[Notas]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[FornecedoresMarcas].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="78" />
						<AttachedAnnotation Disambiguator="47" />
						<AttachedAnnotation Disambiguator="48" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlScalarFunction" Name="[dbo].[GetCodigoExternoNormalizadoFunction]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[GetCodigoExternoNormalizadoFunction].[@codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[RemoveAccentuationFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CleanBadCharsFunction]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN

	-- change received separator chars by a space char. later will be changed again to underscore
	SET @codigo = REPLACE(@codigo, '-', ' ');
	SET @codigo = REPLACE(@codigo, '+', ' ');
	SET @codigo = REPLACE(@codigo, '*', ' ');
	SET @codigo = REPLACE(@codigo, '.', ' ');
	SET @codigo = REPLACE(@codigo, ':', ' ');
	SET @codigo = REPLACE(@codigo, ';', ' ');
	SET @codigo = REPLACE(@codigo, '#', ' ');
	SET @codigo = REPLACE(@codigo, '?', ' ');
	SET @codigo = REPLACE(@codigo, '!', ' ');
	SET @codigo = REPLACE(@codigo, 'º', ' ');
	SET @codigo = REPLACE(@codigo, 'ª', ' ');

	-- normalize external code
	SET @codigo = REPLACE(@codigo, '\', '/');
	SET @codigo = REPLACE(@codigo, '|', '/');
	
	-- remove accentuation
	SET @codigo = [dbo].[RemoveAccentuationFunction](@codigo);

	-- remove bad chars
	SET @codigo = [dbo].[CleanBadCharsFunction](@codigo);

	-- external codes will allways lowercase
	SET @codigo = LOWER(@codigo);

	-- change space chars to underscore (wrong multiple spaces were normalized behind)
	SET @codigo = REPLACE(@codigo, ' ', '_');

	-- devolver o codigo normalizado e limpo
	RETURN @codigo;
END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="538" />
							<Property Name="Length" Value="1807" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This function exist to normalize external coding system.&#xD;&#xA;&#x9;The function receives an external code na normalize it to obey allways to the same internal rules of external codification.&#xD;&#xA;&#x9;All external codes are normalized with this function when they are inserted on Quotations table.&#xD;&#xA;&#x9;We want to prevent little externa changes on code strategy and so minimize not fake not matched situations. As an example, imagine some code that&#xD;&#xA;&#x9;leaves lowercase and becomes uppercase. or the code is improved removing an extra space..&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE FUNCTION [dbo].[GetCodigoExternoNormalizadoFunction]&#xD;&#xA;(&#xD;&#xA;&#x9;@codigo nvarchar(256)&#xD;&#xA;)&#xD;&#xA;RETURNS nvarchar(256)&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetCodigoExternoNormalizadoFunction].[@codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Type">
				<Entry>
					<Element Type="SqlTypeSpecifier">
						<Property Name="Length" Value="256" />
						<Relationship Name="Type">
							<Entry>
								<References ExternalSource="BuiltIns" Name="[nvarchar]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlScalarFunction" Name="[dbo].[GetCotacaoCaracteristicasFunction]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoCaracteristicasFunction].[@_Caracteristicas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StripHtmlTagsFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CleanBadCharsFunction]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN

	-- variables
	DECLARE @caracteristicas nvarchar(2048);

	-- force lowercase
	SET @caracteristicas = LOWER(@_Caracteristicas);

	-- strip html tags
	SET @caracteristicas = [dbo].[StripHtmlTagsFunction](@caracteristicas);

	-- correct some chars
	SET @caracteristicas = REPLACE(@caracteristicas, '\', '/');
	SET @caracteristicas = REPLACE(@caracteristicas, '|', '/');

	-- force some linguistic rules (if extra bad spaces generated, they will be removed in CleanBadCharsFunction..
	SET @caracteristicas = REPLACE(@caracteristicas, '.', '. ');
	SET @caracteristicas = REPLACE(@caracteristicas, ',', ', ');
	SET @caracteristicas = REPLACE(@caracteristicas, ':', ': ');
	SET @caracteristicas = REPLACE(@caracteristicas, ';', '; ');
	SET @caracteristicas = REPLACE(@caracteristicas, '!', '! ');
	SET @caracteristicas = REPLACE(@caracteristicas, '?', '? ');

	-- clean bad chars
	SET @caracteristicas = [dbo].[CleanBadCharsFunction](@caracteristicas);

	-- send back the normalized features
	RETURN @caracteristicas;
END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="103" />
							<Property Name="Length" Value="1280" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This function receives the original features and deal with it to clean and normalize it.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE FUNCTION [dbo].[GetCotacaoCaracteristicasFunction]&#xD;&#xA;(&#xD;&#xA;&#x9;@_Caracteristicas nvarchar(2048)&#xD;&#xA;)&#xD;&#xA;RETURNS nvarchar(2048)&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetCotacaoCaracteristicasFunction].[@_Caracteristicas]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="2048" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Type">
				<Entry>
					<Element Type="SqlTypeSpecifier">
						<Property Name="Length" Value="2048" />
						<Relationship Name="Type">
							<Entry>
								<References ExternalSource="BuiltIns" Name="[nvarchar]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlScalarFunction" Name="[dbo].[GetCotacaoDescricaoFunction]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoDescricaoFunction].[@TermoAcrescentar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoDescricaoFunction].[@TermosRemover]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoDescricaoFunction].[@_Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoDescricaoFunction].[@MarcaDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoDescricaoFunction].[@Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SplitStringFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SplitStringFunction].[Element]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CleanBadCharsFunction]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN
	
	-- variables
	DECLARE @descricao nvarchar(256);


	-- evaluate pré-requisits
	IF (@TermoAcrescentar IS NULL)
	BEGIN
		SET @TermoAcrescentar = '';
	END

	IF (@TermosRemover IS NULL)
	BEGIN
		SET @TermosRemover = '';
	END


	-- force lowercase to description
	SET @descricao = LOWER(@_Descricao);


	-- ensure that brand name is there
	IF CHARINDEX(RTRIM(LOWER(@MarcaDescricao)), @descricao) = 0
	BEGIN
		SET @descricao = RTRIM(@descricao) + ' ' + RTRIM(LOWER(@MarcaDescricao));
	END


	-- ensure that partnumber is there
	IF CHARINDEX(RTRIM(LOWER(@Partnumber)), @descricao) = 0
	BEGIN
		SET @descricao = RTRIM(@descricao) + ' ' + RTRIM(LOWER(@Partnumber));
	END


	-- remove undesirable terms (if the received string has chars)
	IF LEN(RTRIM(@TermosRemover)) > 0
	BEGIN
		
		-- local variables
		DECLARE @termo as nvarchar(256);
		DECLARE termosCursor CURSOR FOR
			SELECT DISTINCT Element
			FROM [dbo].[SplitStringFunction](LOWER(@TermosRemover),',');

		-- load cursor
		OPEN termosCursor;

		-- first fetch
		FETCH NEXT FROM termosCursor INTO @termo;

		-- iterate all records in cursor
		WHILE @@FETCH_STATUS = 0
		BEGIN

			-- remove term
			SET @descricao = REPLACE(@descricao, RTRIM(LTRIM(@termo)), '');

			-- next fetch
			FETCH NEXT FROM termosCursor INTO @termo;

		END

		-- close cursor
		CLOSE termosCursor;
		DEALLOCATE termosCursor;

	END



	-- concatenate term to add
	IF LEN(@TermoAcrescentar) > 0 
	BEGIN
		SET @descricao = @descricao + ' ' + @TermoAcrescentar;
	END



	-- final bad chars cleaning
	SET @descricao = [dbo].[CleanBadCharsFunction](@descricao);
		
	-- send back the normalized description
	RETURN @descricao;
END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="178" />
							<Property Name="Length" Value="2159" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This function receives the original description, brand name, partnumber, text to add and text to remove,&#xD;&#xA;&#x9;and build a uniformed complete final product description&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE FUNCTION [dbo].[GetCotacaoDescricaoFunction]&#xD;&#xA;(&#xD;&#xA;&#x9;@_Descricao nvarchar(256),&#xD;&#xA;&#x9;@MarcaDescricao nvarchar(50),&#xD;&#xA;&#x9;@Partnumber nvarchar(25),&#xD;&#xA;&#x9;@TermoAcrescentar nvarchar(50),&#xD;&#xA;&#x9;@TermosRemover nvarchar(100)&#xD;&#xA;)&#xD;&#xA;RETURNS nvarchar(256)&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetCotacaoDescricaoFunction].[@_Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetCotacaoDescricaoFunction].[@MarcaDescricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetCotacaoDescricaoFunction].[@Partnumber]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetCotacaoDescricaoFunction].[@TermoAcrescentar]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetCotacaoDescricaoFunction].[@TermosRemover]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Type">
				<Entry>
					<Element Type="SqlTypeSpecifier">
						<Property Name="Length" Value="256" />
						<Relationship Name="Type">
							<Entry>
								<References ExternalSource="BuiltIns" Name="[nvarchar]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlScalarFunction" Name="[dbo].[GetCotacaoImagemFunction]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoImagemFunction].[@_Imagem]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN

	-- variables
	DECLARE @image nvarchar(1024);

	-- force lowercase
	SET @image = LOWER(@_Imagem);

	-- clean newline chars
	SET @image = REPLACE(@image, CHAR(10) + CHAR(13), '');
	SET @image = REPLACE(@image, CHAR(10), '');
	SET @image = REPLACE(@image, CHAR(13), '');
	SET @image = REPLACE(@image, CHAR(9), '');

	-- send back the normalized link
	RETURN @image;
END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="86" />
							<Property Name="Length" Value="586" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This function receives the original Product Image URL and normalize it.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE FUNCTION [dbo].[GetCotacaoImagemFunction]&#xD;&#xA;(&#xD;&#xA;&#x9;@_Imagem nvarchar(1024)&#xD;&#xA;)&#xD;&#xA;RETURNS nvarchar(1024)&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetCotacaoImagemFunction].[@_Imagem]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Type">
				<Entry>
					<Element Type="SqlTypeSpecifier">
						<Property Name="Length" Value="1024" />
						<Relationship Name="Type">
							<Entry>
								<References ExternalSource="BuiltIns" Name="[nvarchar]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlScalarFunction" Name="[dbo].[GetCotacaoLinkFunction]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoLinkFunction].[@_Link]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN

	-- variables
	DECLARE @link nvarchar(1024), @pos integer;

	-- force lowercase
	SET @link = LOWER(@_Link);

	-- get position of :// to analyse used protocol
	SELECT @pos = PATINDEX('%://%', @link);

	-- test if a authorized protocol it used
	-- if :// exists in the string, mean's that there is a protocol defined
	-- and if protocol is not in list, then @link is forbidden
	IF @pos > 1 AND (LOWER(LEFT(@link, @pos-1)) NOT IN ('http', 'https', 'ftp'))
	BEGIN
		-- ilegal protocol
		SET @link = '';
	END
	ELSE IF @pos < 1 AND @link <> '(vazio)'				-- :// it's not present in the string
	BEGIN
		-- add default protocol to link
		SET @link = 'http://' + @link;
	END
	ELSE
	BEGIN
		-- else
		SET @link = '(vazio)';
	END

	-- clean newline chars
	SET @link = REPLACE(@link, CHAR(10) + CHAR(13), '');
	SET @link = REPLACE(@link, CHAR(10), '');
	SET @link = REPLACE(@link, CHAR(13), '');
	SET @link = REPLACE(@link, CHAR(9), '');

	-- send back the normalized link
	RETURN @link;
END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="81" />
							<Property Name="Length" Value="1210" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This function receives the original Product Link and normalize it.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE FUNCTION [dbo].[GetCotacaoLinkFunction]&#xD;&#xA;(&#xD;&#xA;&#x9;@_Link nvarchar(1024)&#xD;&#xA;)&#xD;&#xA;RETURNS nvarchar(1024)&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetCotacaoLinkFunction].[@_Link]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Type">
				<Entry>
					<Element Type="SqlTypeSpecifier">
						<Property Name="Length" Value="1024" />
						<Relationship Name="Type">
							<Entry>
								<References ExternalSource="BuiltIns" Name="[nvarchar]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlScalarFunction" Name="[dbo].[GetCotacaoPartnumberFunction]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoPartnumberFunction].[@_Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[RemoveAccentuationFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CleanBadCharsFunction]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN

	-- variables
	DECLARE @partnumber nvarchar(25);

	-- partnumber will be allways stored on uppercase
	SET @partnumber = UPPER(@_Partnumber);

	-- remove accentuation
	SET @partnumber = [dbo].[RemoveAccentuationFunction](@partnumber);

	-- remove bad chars
	SET @partnumber = [dbo].[CleanBadCharsFunction](@partnumber);

	-- correct chars
	SET @partnumber = REPLACE(@partnumber, '\', '/');
	SET @partnumber = REPLACE(@partnumber, ',', '.');
	SET @partnumber = REPLACE(@partnumber, 'º', '');
	SET @partnumber = REPLACE(@partnumber, 'ª', '');

	-- remove all sepaces inside partnumber
	SET @partnumber = REPLACE(@partnumber, ' ','');

	-- devolver o partnumber limpo e normalizado
	RETURN @partnumber;
END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="456" />
							<Property Name="Length" Value="1304" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This function, also used on step 1 of wheretobuy processing, it's used to clean received Partnumber of incorrect spaces &#xD;&#xA;&#x9;(imagine that instead of one space inside the partnumber, external user put two or more spaces wrongly), and prevents too&#xD;&#xA;&#x9;from wrong accented chars.. etc.&#xD;&#xA;&#xD;&#xA;&#x9;We want to best normalize the Partnumber to make it more cross comun between several suppliers.&#xD;&#xA;&#xD;&#xA;&#x9;We decid too that all Partnumbers will be in uppercase.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE FUNCTION [dbo].[GetCotacaoPartnumberFunction]&#xD;&#xA;(&#xD;&#xA;&#x9;@_Partnumber nvarchar(25)&#xD;&#xA;)&#xD;&#xA;RETURNS nvarchar(25)&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetCotacaoPartnumberFunction].[@_Partnumber]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Type">
				<Entry>
					<Element Type="SqlTypeSpecifier">
						<Property Name="Length" Value="25" />
						<Relationship Name="Type">
							<Entry>
								<References ExternalSource="BuiltIns" Name="[nvarchar]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlScalarFunction" Name="[dbo].[GetCotacaoPartnumberSimplificadoFunction]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetTextoOnlyAllowedCharsFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoPartnumberSimplificadoFunction].[@Partnumber]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN

	-- variables
	DECLARE @minimizedPartnumber nvarchar(25);

	-- minimize received Partnumber to the minimum of representative chars
	SET @minimizedPartnumber = [dbo].GetTextoOnlyAllowedCharsFunction(@Partnumber, '[A-Za-z0-9]');

	-- send back the minimized Partnumber version
	RETURN @minimizedPartnumber;
END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="656" />
							<Property Name="Length" Value="1106" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This function receives the original Partnumber sended by the supplier and minimize it to only keep the essencials chars (alpha-numeric chars).&#xD;&#xA;&#xD;&#xA;&#x9;The goal of this processing task, is to improve the chances of matching the partnumber between diferent suppliers (external systems)&#xD;&#xA;&#xD;&#xA;&#x9;Be aware that, the received Partnumber have already been object of cleaning on Quotations Insert process. However, while in the cleaning&#xD;&#xA;&#x9;process only undesirable chars were cleaned, now, with this function, the already cleaned partnumber is reduced to the minimum of representative chars&#xD;&#xA;&#x9;to improve chances of matching between several external systems..&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE FUNCTION [dbo].[GetCotacaoPartnumberSimplificadoFunction]&#xD;&#xA;(&#xD;&#xA;&#x9;@Partnumber nvarchar(25)&#xD;&#xA;)&#xD;&#xA;RETURNS nvarchar(25)&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetCotacaoPartnumberSimplificadoFunction].[@Partnumber]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Type">
				<Entry>
					<Element Type="SqlTypeSpecifier">
						<Property Name="Length" Value="25" />
						<Relationship Name="Type">
							<Entry>
								<References ExternalSource="BuiltIns" Name="[nvarchar]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlMultiStatementTableValuedFunction" Name="[dbo].[GetCotacaoPrecoFunction]">
			<Property Name="ReturnTableVariable" Value="@results" />
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[decimal]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoPrecoFunction].[@_Preco]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoPrecoFunction].[@_OutrosCustos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoPrecoFunction].[@_OutrosCustosDescricao]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetCotacaoPrecoFunction].[__id]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="6" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetCotacaoPrecoFunction].[PrecoCusto]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetCotacaoPrecoFunction].[Formula]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN

	-- variables
	DECLARE @precoCusto decimal(14,4), @formula nvarchar(256);


	-- final cost price is calculated as the sum of Preco with OutrosCustos
	SET @precoCusto = @_Preco + @_OutrosCustos;


	-- now, if @_OutrosCustosDescricao has text inside it, that text it is the justification of existing adicional costs (@_OutrosCustos)
	-- however, if @_OutrosCustos = 0, that description justifies the @_Preco (maybe more expensive because..)
	IF COALESCE(@_OutrosCustosDescricao, '(vazio)') = '(vazio)'
	BEGIN
		SET @formula = 'PrecoCusto = Preco';
	END
	ELSE
	BEGIN
		
		IF @_OutrosCustos <> 0
		BEGIN
			
			-- formula must show that the PrecoCusto is the sum of Preço and OutrosCustos
			SET @formula = 'PrecoCusto = Preco + @OutrosCustos';
			SET @formula = @formula + ' = ';
			SET @formula = @formula + CONVERT(varchar, @_Preco);
			SET @formula = @formula + ' + ';
			SET @formula = @formula + ' (';
			SET @formula = @formula + LOWER(RTRIM(@_OutrosCustosDescricao));
			SET @formula = @formula + ': ';
			SET @formula = @formula + CONVERT(varchar, @_OutrosCustos);;
			SET @formula = @formula + ') ';
			SET @formula = @formula + ' = ';
			SET @formula = @formula + CONVERT(varchar, @precoCusto);

		END
		ELSE
		BEGIN

			-- formula must show that the price itself include other associated costs
			SET @formula = 'PrecoCusto = Preco + @OutrosCustos';
			SET @formula = @formula + ' <=> ';
			SET @formula = @formula + CONVERT(varchar, @precoCusto);
			SET @formula = @formula + ' = ';
			SET @formula = @formula + ' Preco + (';
			SET @formula = @formula + LOWER(RTRIM(@_OutrosCustosDescricao));
			SET @formula = @formula + ': ';
			SET @formula = @formula + CONVERT(varchar, @_OutrosCustos);
			SET @formula = @formula + ')';

		END
	END


	-- prepare data to be send back
	INSERT INTO @results
	SELECT @precoCusto, @formula;


	-- terminate
	RETURN;
END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="148" />
							<Property Name="Length" Value="2386" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This function pretends to calculate final price of quotation.&#xD;&#xA;&#x9;Formula will permit to know later how the final price was calculated.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE FUNCTION [dbo].[GetCotacaoPrecoFunction]&#xD;&#xA;(&#xD;&#xA;&#x9;@_Preco decimal(14,4),&#xD;&#xA;&#x9;@_OutrosCustos decimal(14,4),&#xD;&#xA;&#x9;@_OutrosCustosDescricao nvarchar(128)&#xD;&#xA;)&#xD;&#xA;RETURNS @results TABLE&#xD;&#xA;(&#xD;&#xA;&#x9;__id integer PRIMARY KEY NOT NULL IDENTITY(1,1),&#xD;&#xA;&#x9;PrecoCusto decimal(14,4) NOT NULL,&#xD;&#xA;&#x9;Formula nvarchar(256) NOT NULL&#xD;&#xA;)&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetCotacaoPrecoFunction].[@_Preco]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetCotacaoPrecoFunction].[@_OutrosCustos]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetCotacaoPrecoFunction].[@_OutrosCustosDescricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlMultiStatementTableValuedFunction" Name="[dbo].[GetCotacaoStockSubstitutoFunction]">
			<Property Name="ReturnTableVariable" Value="@results" />
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoStockSubstitutoFunction].[@ProdutosMatching_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoStockSubstitutoFunction].[@CotacoesRegras_StockCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetCotacaoStockSubstitutoFunction].[__id]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="5" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetCotacaoStockSubstitutoFunction].[StockCodigo]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetCotacaoStockSubstitutoFunction].[Justificacao]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN

	-- variables
	DECLARE @stockCodigoNovo nvarchar(5), @justificacao nvarchar(256);


	-- if there is a custom define StockCodigo for the product, use it
	SELECT 
			@stockCodigoNovo =
				CASE WHEN @ProdutosMatching_StockCodigo IS NOT NULL THEN @ProdutosMatching_StockCodigo
					 WHEN @CotacoesRegras_StockCodigo IS NOT NULL THEN @CotacoesRegras_StockCodigo
					 ELSE NULL
				END,

			@justificacao =
				CASE WHEN @ProdutosMatching_StockCodigo IS NOT NULL THEN '!ProdutosMatching - regra de utilizador'
					 WHEN @CotacoesRegras_StockCodigo IS NOT NULL THEN '!CotacoesRegras - regra de utilizador'
					 ELSE NULL
				END


	-- prepare data to be send back
	INSERT INTO @results
	SELECT @stockCodigoNovo, @justificacao;


	-- terminate
	RETURN;
END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="158" />
							<Property Name="Length" Value="1276" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This function pretends to show what will be the substitute StockCodigo, if applicable.&#xD;&#xA;&#x9;Formula will show wy there is a substitute StockCodigo&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE FUNCTION [dbo].[GetCotacaoStockSubstitutoFunction]&#xD;&#xA;(&#xD;&#xA;&#x9;@StockCodigo nvarchar(5),&#xD;&#xA;&#x9;@CotacoesRegras_StockCodigo nvarchar(5),&#xD;&#xA;&#x9;@ProdutosMatching_StockCodigo nvarchar(5)&#xD;&#xA;)&#xD;&#xA;RETURNS @results TABLE&#xD;&#xA;(&#xD;&#xA;&#x9;__id integer PRIMARY KEY NOT NULL IDENTITY(1,1),&#xD;&#xA;&#x9;StockCodigo nvarchar(5) NULL,&#xD;&#xA;&#x9;Justificacao nvarchar(256) NULL&#xD;&#xA;)&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetCotacaoStockSubstitutoFunction].[@StockCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetCotacaoStockSubstitutoFunction].[@CotacoesRegras_StockCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetCotacaoStockSubstitutoFunction].[@ProdutosMatching_StockCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlMultiStatementTableValuedFunction" Name="[dbo].[GetCotacaoValidadeFunction]">
			<Property Name="ReturnTableVariable" Value="@results" />
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoValidadeFunction].[@_Validade]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoValidadeFunction].[@_ValidadeDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoValidadeFunction].[@ProdutosMatching_HorasValidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoValidadeFunction].[@CotacoesRegras_HorasValidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoValidadeFunction].[@Data]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetCotacaoValidadeFunction].[__id]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="4" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetCotacaoValidadeFunction].[Validade]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetCotacaoValidadeFunction].[Formula]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN

	-- variables
	DECLARE @horasValidade integer, @validade smalldatetime, @formula nvarchar(256);


	-- if some expiration date has come from supplier then use it
	IF @_Validade <> CAST('01-01-2000' as smalldatetime)
	BEGIN
		
		-- expiration will be the received date
		SET @validade = @_Validade;
		SET @formula = 'validade definida pelo fornecedor: ';
		SET @formula = @formula + LOWER(RTRIM(@_ValidadeDescricao));

		-- prepare data to be send back
		INSERT INTO @results
		SELECT @validade, @formula;

		-- terminate
		RETURN;

	END


	-- the most mandatory rule is when it is defined a specific rule for the product itself.
	-- so, if there is a value defined for the product this rules prevails, but if not, the definition used on
	-- CotacoesRegras table.
	IF @ProdutosMatching_HorasValidade <> 0
	BEGIN
		SET @horasValidade = @ProdutosMatching_HorasValidade;
	END
	ELSE
	BEGIN
		SET @horasValidade = @CotacoesRegras_HorasValidade;
	END


	-- expiration date calculation
	SET @validade = DATEADD(HOUR, @horasValidade, @Data);


	-- set the formula to documentate in future this calculation
	IF @ProdutosMatching_HorasValidade <> 0
	BEGIN
		-- set the formula to future documentation
		SET @formula = 'validade = data + pmhv';
		SET @formula = @formula + ' = ';
		SET @formula = @formula + CONVERT(varchar, @Data, 120);
		SET @formula = @formula + ' + ';
		SET @formula = @formula + CONVERT(varchar, @ProdutosMatching_HorasValidade) + 'horas';
		SET @formula = @formula + ' = ';
		SET @formula = @formula + CONVERT(varchar, @validade, 120);
	END
	ELSE
	BEGIN
		-- set the formula to future documentation
		SET @formula = 'validade = data + crhv';
		SET @formula = @formula + ' = ';
		SET @formula = @formula + CONVERT(varchar, @Data, 120);
		SET @formula = @formula + ' + ';
		SET @formula = @formula + CONVERT(varchar, @CotacoesRegras_HorasValidade) + 'horas';
		SET @formula = @formula + ' = ';
		SET @formula = @formula + CONVERT(varchar, @validade, 120);
	END


	-- prepare data to be send back
	INSERT INTO @results
	SELECT @validade, @formula;


	-- terminate
	RETURN;
END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="248" />
							<Property Name="Length" Value="2791" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This function pretends to set with more accuracy the expiration date of received quotation.&#xD;&#xA;&#x9;It returns a table with two fields: first the expiration date and the second with a formula that demonstrates the calculation of that date.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE FUNCTION [dbo].[GetCotacaoValidadeFunction]&#xD;&#xA;(&#xD;&#xA;&#x9;@Data datetime,&#xD;&#xA;&#x9;@_Validade smalldatetime,&#xD;&#xA;&#x9;@_ValidadeDescricao nvarchar(128),&#xD;&#xA;&#x9;@CotacoesRegras_HorasValidade smallint,&#xD;&#xA;&#x9;@ProdutosMatching_HorasValidade smallint&#xD;&#xA;)&#xD;&#xA;RETURNS @results TABLE&#xD;&#xA;(&#xD;&#xA;&#x9;__id integer PRIMARY KEY NOT NULL IDENTITY(1,1),&#xD;&#xA;&#x9;Validade smalldatetime NOT NULL,&#xD;&#xA;&#x9;Formula nvarchar(256) NOT NULL&#xD;&#xA;)&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetCotacaoValidadeFunction].[@Data]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetCotacaoValidadeFunction].[@_Validade]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetCotacaoValidadeFunction].[@_ValidadeDescricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetCotacaoValidadeFunction].[@CotacoesRegras_HorasValidade]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetCotacaoValidadeFunction].[@ProdutosMatching_HorasValidade]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlScalarFunction" Name="[dbo].[GetIndicePreocupacaoFunction]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[tinyint]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TermosPreocupantes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TermosPreocupantes].[Indice]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetIndicePreocupacaoFunction].[@texto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TermosPreocupantes].[Termo]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN
	
	-- variables
	DECLARE @indice tinyint = 0;

	-- search for the greather preocupation index present in @texto
	SELECT TOP 1 @indice = Indice
	FROM [dbo].[TermosPreocupantes]
	WHERE LOWER(@texto) LIKE LOWER(Termo)
	ORDER BY Indice DESC;

	-- send back preocupation index
	return @indice;

END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="234" />
							<Property Name="Length" Value="651" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This function receives some text and, after analyse it, send back a value [0:9] representing the danger of terms..&#xD;&#xA;&#x9;Zero (0) represents a no preocupation at all and nine (9) represents text with extremely danger terms.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE FUNCTION [dbo].[GetIndicePreocupacaoFunction]&#xD;&#xA;(&#xD;&#xA;&#x9;@texto nvarchar(MAX)&#xD;&#xA;)&#xD;&#xA;RETURNS tinyint&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetIndicePreocupacaoFunction].[@texto]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Type">
				<Entry>
					<Element Type="SqlTypeSpecifier">
						<Relationship Name="Type">
							<Entry>
								<References ExternalSource="BuiltIns" Name="[tinyint]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlScalarFunction" Name="[dbo].[GetProdutoCodigoFunction]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoPartnumberSimplificadoFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoCodigoFunction].[@Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoCodigoFunction].[@ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoCodigoFunction].[@MarcaCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN

	-- variables
	DECLARE @complemento nvarchar(7) = ''; -- ComplementoCodigo + Parenteses = 5 + 2 = 7
	DECLARE @partnumberSimplificado nvarchar(25);

	-- simplify partnumber to be used as part of product code
	SET @partnumberSimplificado = [dbo].[GetCotacaoPartnumberSimplificadoFunction](@Partnumber)

	-- define addon part to be concatenated
	IF UPPER(@ComplementoCodigo) <> 'N/A' AND LEN(RTRIM(@ComplementoCodigo)) > 0
	BEGIN
		SET @complemento = '[' + RTRIM(UPPER(@ComplementoCodigo)) + ']';
	END

	-- return the product code to be used
	RETURN RTRIM(@MarcaCodigo) + @partnumberSimplificado + @complemento;
END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="839" />
							<Property Name="Length" Value="1646" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This function calculates the Product Code for each Quotation.&#xD;&#xA;&#x9;It receives the Brand Code, Addon Code and Partnumber and, after minimize the Partnumber, &#xD;&#xA;&#x9;generates a Product Code concatenating the Brand Code with the Partnumber and with Addon Code as shown below&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;Product Code = Brand Code + Minimized Partnumber + '[' + Addon Code + ']'&#xD;&#xA;&#xD;&#xA;&#x9;With this function, we can have access to the Product Code, even before the Product record has been created.&#xD;&#xA;&#xD;&#xA;&#x9;This function reuses the GetCotacaoPartnumberSimplificado function too minimize the Partnumber, thereby improving&#xD;&#xA;&#x9;the chances of matching product codes between different suppliers.&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;This function receives the Addon Code. Addons are the way to differenciate the same product when a supplier offers&#xD;&#xA;&#x9;with some specific add like delivery or extra warranty.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE FUNCTION [dbo].[GetProdutoCodigoFunction]&#xD;&#xA;(&#xD;&#xA;&#x9;@Partnumber nvarchar(25),&#xD;&#xA;&#x9;@MarcaCodigo nvarchar(5),&#xD;&#xA;&#x9;@ComplementoCodigo nvarchar(5)&#xD;&#xA;)&#xD;&#xA;RETURNS nvarchar(40)&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetProdutoCodigoFunction].[@Partnumber]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetProdutoCodigoFunction].[@MarcaCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetProdutoCodigoFunction].[@ComplementoCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Type">
				<Entry>
					<Element Type="SqlTypeSpecifier">
						<Property Name="Length" Value="40" />
						<Relationship Name="Type">
							<Entry>
								<References ExternalSource="BuiltIns" Name="[nvarchar]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlScalarFunction" Name="[dbo].[GetProdutoDetalheIndicePreocupacaoFunction]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[tinyint]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoDetalheIndicePreocupacaoFunction].[@descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetIndicePreocupacaoFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoDetalheIndicePreocupacaoFunction].[@caracteristicas]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN
	
	-- variables
	DECLARE @indice tinyint = 0;

	-- search for the greather preocupation index present either in @description and features
	SELECT @indice = MAX(Indice)
	FROM
		(

			-- get content preocupation index from description
			SELECT [dbo].GetIndicePreocupacaoFunction(@descricao) as Indice

			UNION

			-- get content preocupation index from features
			SELECT [dbo].GetIndicePreocupacaoFunction(@caracteristicas) as Indice

		) indices;


	-- send back preocupation index
	return @indice;

END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="136" />
							<Property Name="Length" Value="828" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This function receives description and features fields from a ProdutoDetalhe and returns it's content preocupation index.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE FUNCTION [dbo].[GetProdutoDetalheIndicePreocupacaoFunction]&#xD;&#xA;(&#xD;&#xA;&#x9;@descricao nvarchar(256),&#xD;&#xA;&#x9;@caracteristicas nvarchar(2048)&#xD;&#xA;)&#xD;&#xA;RETURNS tinyint&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetProdutoDetalheIndicePreocupacaoFunction].[@descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetProdutoDetalheIndicePreocupacaoFunction].[@caracteristicas]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="2048" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Type">
				<Entry>
					<Element Type="SqlTypeSpecifier">
						<Relationship Name="Type">
							<Entry>
								<References ExternalSource="BuiltIns" Name="[tinyint]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlMultiStatementTableValuedFunction" Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction]">
			<Property Name="ReturnTableVariable" Value="@results" />
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[float]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[float]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[float]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[float]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[float]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[float]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[float]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[float]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[@U3Disponivel]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[float]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[@U2Disponivel]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[float]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[@U1Disponivel]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[float]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[@UDisponivel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[@U3Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[@U2Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[@U1Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[@UData]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[float]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[float]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[@ConfiancaFornecedor]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[__idMedidaDisponibilidade]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="3" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[U3VD]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[U2VD]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[U1VD]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[EED]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[ICD]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[EEDFormula]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[ICDCEFormula]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[ICDCTFormula]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[ICDCFFormula]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[ICDFormula]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN

	-- variables
	DECLARE @eedFormula nvarchar(256), @icdFormula nvarchar(256), @ceFormula nvarchar(256), @ctFormula nvarchar(256), @cfFormula nvarchar(256),
	        @u3vd float, @u2vd float, @u1vd float, @eed float, @icd float, @ce float, @ct float, @cf float;


	-- initialize variables
	SET @eedFormula = '';
	SET @icdFormula = '';
	SET @ceFormula = '';
	SET @ctFormula = '';
	SET @cfFormula = '';
	SET @u3vd = NULL;
	SET @u2vd = NULL;
	SET @u1vd = NULL;
	SET @eed = 1;	-- minimum stability: 1 day
	SET @icd = 0;
	SET @ce = 0;
	SET @ct = 0;
	SET @cf = 0



	-- trend calculation
	IF @U3Disponivel IS NOT NULL	-- if this level it is not null, then we have the guarantee that @U2Disponivel it isn't too.
	BEGIN
		SET @u3vd = CAST(@U2Disponivel as float) - @U3Disponivel;
	END

	IF @U2Disponivel IS NOT NULL	-- if this level it is not null, then we have the guarantee that @U1Disponivel it isn't too.
	BEGIN
		SET @u2vd = CAST(@U1Disponivel as float) - @U2Disponivel;
	END

	IF @U1Disponivel IS NOT NULL	-- if this level it is not null, then we have the guarantee that @UDisponivel it isn't too.
	BEGIN
		SET @u1vd = CAST(@UDisponivel as float) - @U1Disponivel;
	END



	-- EED and EEDFormula calculation
	SELECT @eed =
				CASE WHEN @U3Data IS NOT NULL THEN 
													0.1 * DATEDIFF(DAY, @U3Data, @U2Data) +
													0.2 * DATEDIFF(DAY, @U2Data, @U1Data) +
													0.7 * DATEDIFF(DAY, @U1Data, @UData)

					 WHEN @U2Data IS NOT NULL THEN	
													0.2 * DATEDIFF(DAY, @U2Data, @U1Data) +
													0.7 * DATEDIFF(DAY, @U1Data, @UData)

					 WHEN @U1Data IS NOT NULL THEN	
													0.7 * DATEDIFF(DAY, @U1Data, @UData)

					 ELSE 1
				END,

			@eedFormula = 
				CASE WHEN @U3Data IS NOT NULL THEN 
													'EED = 0.1(U3Data - U2Data) + ' +
														  '0.2(U2Data - U1Data) + ' +
													      '0.7(U1Data - UData) <=> ' +
													'EED = 0.1(' + CONVERT(varchar, @U3Data, 103) + ' - ' + CONVERT(varchar, @U2Data, 103)  + ') + ' +
													      '0.2(' + CONVERT(varchar, @U2Data, 103) + ' - ' + CONVERT(varchar, @U1Data, 103)  + ') + ' +
														  '0.7(' + CONVERT(varchar, @U1Data, 103) + ' - ' + CONVERT(varchar, @UData, 103)  + ') <=> ' +
													'EED = ' + CAST(@eed as varchar)

					 WHEN @U2Data IS NOT NULL THEN	
													'EED = 0.2(U2Data - U1Data) + ' +
													      '0.7(U1Data - UData) <=> ' +
													'EED = 0.2(' + CONVERT(varchar, @U2Data, 103) + ' - ' + CONVERT(varchar, @U1Data, 103)  + ') + ' +
														  '0.7(' + CONVERT(varchar, @U1Data, 103) + ' - ' + CONVERT(varchar, @UData, 103)  + ') <=> ' +
													'EED = ' + CAST(@eed as varchar)

					 WHEN @U1Data IS NOT NULL THEN	
													'EED = 0.7(U1Data - UData) <=> ' +
													'EED = 0.7(' + CONVERT(varchar, @U1Data, 103) + ' - ' + CONVERT(varchar, @UData, 103)  + ') <=> ' +
													'EED = ' + CAST(@eed as varchar)

					 ELSE 'EED = 1 (default)'
			    END



	
	-- CE (ICD component calculation)
	IF @UData IS NOT NULL
	BEGIN
		
		-- CE calculation
		SELECT @ce = (1 - (DATEDIFF(DAY, @UData, GETDATE()) / @eed));

		-- CE formula calculation
		SELECT @ceFormula = 'CE = (1 - ((Hoje - UData) / EEP)) <=> ' +
							'CE = (1 - ((' + CONVERT(varchar, GETDATE(), 103) + ' - ' + CONVERT(varchar, @UData, 103) + ') / ' + CAST(@eed as varchar)  + ')) <=> ' +
							'CE = ' + CAST(@ce as varchar);
	END
	ELSE
	BEGIN
		-- default
		SELECT @ce = 0, 
			   @ceFormula = 'CE = 0 (default)';
	END




	-- CT (ICD component calculation)
	IF @U1Disponivel IS NOT NULL -- we have sure that @UDisponivel is not null too
	BEGIN

		-- CT calculation
		SELECT @ct = 
				   CASE WHEN @UDisponivel < @U1Disponivel THEN (1 - ABS(((CAST(@UDisponivel as float) - @U1Disponivel) / 11) * 5))
						ELSE (1 - ABS((CAST(@UDisponivel as float) - @U1Disponivel) / 11))
				   END;

		-- CT formula calculation
		SELECT @ctFormula = 
				   CASE WHEN @UDisponivel < @U1Disponivel THEN 
														'CT = (1 - |((UDisponivel - U1Disponivel) / 11) * 5|) <=> ' + 
														'CT = (1 - |(((' + CONVERT(varchar, @UDisponivel) + ') - (' + CONVERT(varchar, @U1Disponivel) + ')) / 11) * 5|) <=> ' +
														'CT = ' + CAST(@ct as varchar)
						ELSE 
							  'CT = (1 - |(UDisponivel - U1Disponivel) / 11|) <=> ' + 
							  'CT = (1 - |((' + CONVERT(varchar, @UDisponivel) + ') - (' + CONVERT(varchar, @U1Disponivel) + ')) / 11|) <=> ' +
							  'CT = ' + CAST(@ct as varchar)
				   END;
	END
	ELSE
	BEGIN
		-- default
		SELECT @ct = 0, 
			   @ctFormula = 'CT = 0 (default)';
	END




	-- CF (ICP component calculation)
	IF @ConfiancaFornecedor IS NOT NULL
	BEGIN
		
		-- CF calculation
		SELECT @cf = @ConfiancaFornecedor / 100;

		-- CF formula calculation
		SELECT @cfFormula = 'CF = (ConfiancaFornecedor / 100) <=> ' +
							'CF = (' + CAST(@ConfiancaFornecedor as varchar) + ' / 100) <=> ' +
							'CF = ' + CAST(@cf as varchar);

	END
	ELSE
	BEGIN
		-- default
		SELECT @cf = 0, 
			   @cfFormula = 'CF = 0 (default)';
	END




	-- ICD calculation
	SELECT @icd = (0.5 * @ce) + (0.2 * @ct) + (0.3 * @cf);

	-- ICD Formula calculation
	SELECT @icdFormula = 'ICD = 0.5CE + 0.2CT + 0.3CF <=> ' + 
						 'ICD = (0.5 * ' + CAST(@ce as varchar) + ') + (0.2 * ' + CAST(@ct as varchar) + ') + (0.3 * ' + CAST(@cf as varchar) + ') <=> ' +
						 'ICD = ' + CAST(@icd as varchar);

	-- ICD must be inside [0:1] interval
	SELECT @icdFormula =
					CASE WHEN @icd < 0 THEN @icdFormula + ', !E [0:1] => ICP = 0'
					     WHEN @icd > 1 THEN @icdFormula + ', !E [0:1] => ICP = 1'
						 ELSE @icdFormula
					END,
			@icd =
					CASE WHEN @icd < 0 THEN 0
					     WHEN @icd > 1 THEN 1
						 ELSE @icd
					END;
		  


	-- send back results
	INSERT INTO @results
	SELECT @u3vd, @u2vd, @u1vd, @eed, @icd, @eedFormula, @ceFormula, @ctFormula, @cfFormula, @icdFormula;


	-- the end
	RETURN;
END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="1146" />
							<Property Name="Length" Value="7841" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This function generates product statistics:&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&gt; U1VD - last availability variation (x = 1 not changed, x &gt; 1 means availability level was rise and x &lt; 1 means the availability level was dropped&#xD;&#xA;&#x9;&#x9;&gt; U2VD - penultimate..&#xD;&#xA;&#x9;&#x9;&gt; U3VD - antepenultimate..&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&gt; EED (Estatistica de Estabilidade da Disponibilidade) means Statistic of Stability of Availability.&#xD;&#xA;&#x9;          Represents a estimation in days of the stability of actual Stock Availability level.&#xD;&#xA;&#x9;&#x9;&#x9;  How much days will the current level of availability stay actual.&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&gt; ICD (Indice de Confiança na Disponibilidade) means Availability Trust Index.&#xD;&#xA;&#x9;&#x9;      Thats a value between [0:1] that represents the current level of availability trust.&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;  ICD = 0.5CE + 0.2CT + 0.3CF&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&gt; CE  (Componente Estabilidade) Estability Component&#xD;&#xA;&#x9;&#x9;      Is the availability level trust in prespective to EED. &#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&gt; CT  (Componente Tendencia) Trend Component&#xD;&#xA;&#x9;&#x9;&#x9;  Is the availability trust in prespective of last evolution of stock availability.&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&gt; CF  (Confiança Fornecedor) Trust on the Supplier&#xD;&#xA;&#x9;&#x9;&#x9;  Is the trust that exists on the supplier (supplier table record)&#xD;&#xA;&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE FUNCTION [dbo].GetProdutoMedidasDisponibilidadeFunction&#xD;&#xA;(&#xD;&#xA;&#x9;@U3Disponivel smallint,&#xD;&#xA;&#x9;@U3Data smalldatetime,&#xD;&#xA;&#x9;@U2Disponivel smallint,&#xD;&#xA;&#x9;@U2Data smalldatetime,&#xD;&#xA;&#x9;@U1Disponivel smallint,&#xD;&#xA;&#x9;@U1Data smalldatetime,&#xD;&#xA;&#x9;@UDisponivel smallint,&#xD;&#xA;&#x9;@UData smalldatetime,&#xD;&#xA;&#x9;@ConfiancaFornecedor float&#xD;&#xA;)&#xD;&#xA;RETURNS @results TABLE&#xD;&#xA;(&#xD;&#xA;&#x9;__idMedidaDisponibilidade integer PRIMARY KEY NOT NULL IDENTITY(1,1),&#xD;&#xA;&#x9;U3VD float NULL,&#xD;&#xA;&#x9;U2VD float NULL,&#xD;&#xA;&#x9;U1VD float NULL,&#xD;&#xA;&#x9;EED float NOT NULL,&#xD;&#xA;&#x9;ICD float NOT NULL,&#xD;&#xA;&#x9;EEDFormula nvarchar(256),&#xD;&#xA;&#x9;ICDCEFormula nvarchar(256),&#xD;&#xA;&#x9;ICDCTFormula nvarchar(256),&#xD;&#xA;&#x9;ICDCFFormula nvarchar(256),&#xD;&#xA;&#x9;ICDFormula nvarchar(256)&#xD;&#xA;)&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[@U3Disponivel]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[@U3Data]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[@U2Disponivel]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[@U2Data]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[@U1Disponivel]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[@U1Data]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[@UDisponivel]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[@UData]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[@ConfiancaFornecedor]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlMultiStatementTableValuedFunction" Name="[dbo].[GetProdutoMedidasPrecoFunction]">
			<Property Name="ReturnTableVariable" Value="@results" />
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[float]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[float]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[float]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[float]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[float]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[float]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[float]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[float]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[@U3Preco]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[@U2Preco]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[@U1Preco]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[@UPreco]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[@U3Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[@U2Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[@U1Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[@UData]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[@ConfiancaFornecedor]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetProdutoMedidasPrecoFunction].[__idMedidaPreco]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="7" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetProdutoMedidasPrecoFunction].[U3VP]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetProdutoMedidasPrecoFunction].[U2VP]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetProdutoMedidasPrecoFunction].[U1VP]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetProdutoMedidasPrecoFunction].[EEP]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetProdutoMedidasPrecoFunction].[ICP]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetProdutoMedidasPrecoFunction].[EEPFormula]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetProdutoMedidasPrecoFunction].[ICPCEFormula]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetProdutoMedidasPrecoFunction].[ICPCTFormula]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetProdutoMedidasPrecoFunction].[ICPCFFormula]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[GetProdutoMedidasPrecoFunction].[ICPFormula]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN

	-- variables
	DECLARE @eepFormula NVARCHAR(256), @icpFormula nvarchar(256), @ceFormula nvarchar(256), @ctFormula nvarchar(256), @cfFormula nvarchar(256),
	        @u3vp float, @u2vp float, @u1vp float, @eep float, @icp float, @ce float, @ct float, @cf float;


	-- initialize variables
	SET @eepFormula = '';
	SET @icpFormula = '';
	SET @ceFormula = '';
	SET @ctFormula = '';
	SET @cfFormula = '';
	SET @u3vp = NULL;
	SET @u2vp = NULL;
	SET @u1vp = NULL;
	SET @eep = 1;	-- minimum stability: 1 day
	SET @icp = 0;
	SET @ce = 0;
	SET @ct = 0;
	SET @cf = 0



	-- trend calculation
	IF @U3Preco IS NOT NULL	-- if this price it is not null, then we have the guarantee that @U2Preco it isn't too.
	BEGIN
		SET @u3vp = @U2Preco / @U3Preco;
	END

	IF @U2Preco IS NOT NULL -- if this price it is not null, then we have the guarantee that @U1Preco it isn't too.
	BEGIN
		SET @u2vp = @U1Preco / @U2Preco;
	END

	IF @U1Preco IS NOT NULL -- if this price it is not null, then we have the guarantee that @UPreco it isn't too.
	BEGIN
		SET @u1vp = @UPreco / @U1Preco;
	END



	-- EEP and EEPFormula calculation
	SELECT @eep =
				CASE WHEN @U3Data IS NOT NULL THEN 
													0.1 * DATEDIFF(DAY, @U3Data, @U2Data) +
													0.4 * DATEDIFF(DAY, @U2Data, @U1Data) +
													0.5 * DATEDIFF(DAY, @U1Data, @UData)

					 WHEN @U2Data IS NOT NULL THEN	
													0.4 * DATEDIFF(DAY, @U2Data, @U1Data) +
													0.5 * DATEDIFF(DAY, @U1Data, @UData)

					 WHEN @U1Data IS NOT NULL THEN	
													0.5 * DATEDIFF(DAY, @U1Data, @UData)

					 ELSE 1
				END,

			@eepFormula = 
				CASE WHEN @U3Data IS NOT NULL THEN 
													'EEP = 0.1(U3Data - U2Data) + ' +
														  '0.4(U2Data - U1Data) + ' +
													      '0.5(U1Data - UData) <=> ' +
													'EEP = 0.1(' + CONVERT(varchar, @U3Data, 103) + ' - ' + CONVERT(varchar, @U2Data, 103)  + ') + ' +
													      '0.4(' + CONVERT(varchar, @U2Data, 103) + ' - ' + CONVERT(varchar, @U1Data, 103)  + ') + ' +
														  '0.5(' + CONVERT(varchar, @U1Data, 103) + ' - ' + CONVERT(varchar, @UData, 103)  + ') <=> ' +
													'EEP = ' + CAST(@eep as varchar)

					 WHEN @U2Data IS NOT NULL THEN	
													'EEP = 0.4(U2Data - U1Data) + ' +
													      '0.5(U1Data - UData) <=> ' +
													'EEP = 0.4(' + CONVERT(varchar, @U2Data, 103) + ' - ' + CONVERT(varchar, @U1Data, 103)  + ') + ' +
														  '0.5(' + CONVERT(varchar, @U1Data, 103) + ' - ' + CONVERT(varchar, @UData, 103)  + ') <=> ' +
													'EEP = ' + CAST(@eep as varchar)

					 WHEN @U1Data IS NOT NULL THEN	
													'EEP = 0.5(U1Data - UData) <=> ' +
													'EEP = 0.5(' + CONVERT(varchar, @U1Data, 103) + ' - ' + CONVERT(varchar, @UData, 103)  + ') <=> ' +
													'EEP = ' + CAST(@eep as varchar)

					 ELSE 'EEP = 1 (default)'
			    END



	
	-- CE (ICP component calculation)
	IF @UData IS NOT NULL
	BEGIN
		
		-- CE calculation
		SELECT @ce = (1 - (DATEDIFF(DAY, @UData, GETDATE()) / @eep));

		-- CE formula calculation
		SELECT @ceFormula = 'CE = (1 - ((Hoje - UData) / EEP)) <=> ' +
							'CE = (1 - ((' + CONVERT(varchar, GETDATE(), 103) + ' - ' + CONVERT(varchar, @UData, 103) + ') / ' + CAST(@eep as varchar)  + ')) <=> ' +
							'CE = ' + CAST(@ce as varchar);
	END
	ELSE
	BEGIN
		-- default
		SELECT @ce = 0, 
			   @ceFormula = 'CE = 0 (default)';
	END




	-- CT (ICP component calculation)
	IF @U1Preco IS NOT NULL -- we have sure that @UPreco is not null too
	BEGIN

		-- CT calculation
		SELECT @ct = 
				   CASE WHEN @UPreco > @U1Preco THEN (@U1Preco / @UPreco) - (50 * (1 - (@U1Preco / @UPreco)))
						ELSE (@UPreco / @U1Preco)
				   END;

		-- CT formula calculation
		SELECT @ctFormula = 
				   CASE WHEN @UPreco > @U1Preco THEN 
														'CT = (U1Preco / UPreco) - ' + 
																	'(50 * (1 - (@U1Preco / @UPreco))) <=> ' +
														'CT = (' + CONVERT(varchar, @U1Preco) + ' / ' + CONVERT(varchar, @UPreco) + ') - ' +
																	'(50 * (1 - (' + CONVERT(varchar, @U1Preco) + ' / ' + CONVERT(varchar, @UPreco) + '))) <=> ' +
														'CT = ' + CAST(@ct as varchar)
						ELSE 
							  'CT = (UPreco / U1Preco) <=> ' +
							  'CT = (' + CONVERT(varchar, @UPreco) + ' / ' + CONVERT(varchar, @U1Preco) + ') <=> ' +
							  'CT = ' + CAST(@ct as varchar)
				   END;
	END
	ELSE
	BEGIN
		-- default
		SELECT @ct = 0, 
			   @ctFormula = 'CT = 0 (default)';
	END




	-- CF (ICP component calculation)
	IF @ConfiancaFornecedor IS NOT NULL
	BEGIN
		
		-- CF calculation
		SELECT @cf = @ConfiancaFornecedor / 100;

		-- CF formula calculation
		SELECT @cfFormula = 'CF = (ConfiancaFornecedor / 100) <=> ' +
							'CF = (' + CAST(@ConfiancaFornecedor as varchar) + ' / 100) <=> ' +
							'CF = ' + CAST(@cf as varchar);

	END
	ELSE
	BEGIN
		-- default
		SELECT @cf = 0, 
			   @cfFormula = 'CF = 0 (default)';
	END




	-- ICP calculation
	SELECT @icp = (0.5 * @ce) + (0.2 * @ct) + (0.3 * @cf);

	-- ICP Formula calculation
	SELECT @icpFormula = 'ICP = 0.5CE + 0.2CT + 0.3CF <=> ' + 
						 'ICP = (0.5 * ' + CAST(@ce as varchar) + ') + (0.2 * ' + CAST(@ct as varchar) + ') + (0.3 * ' + CAST(@cf as varchar) + ') <=> ' +
						 'ICP = ' + CAST(@icp as varchar);

	-- ICP must be inside [0:1] interval
	SELECT @icpFormula =
					CASE WHEN @icp < 0 THEN @icpFormula + ', !E [0:1] => ICP = 0'
					     WHEN @icp > 1 THEN @icpFormula + ', !E [0:1] => ICP = 1'
						 ELSE @icpFormula
					END,
			@icp =
					CASE WHEN @icp < 0 THEN 0
					     WHEN @icp > 1 THEN 1
						 ELSE @icp
					END;
		  



	-- send back results
	INSERT INTO @results
	SELECT @u3vp, @u2vp, @u1vp, @eep, @icp, @eepFormula, @ceFormula, @ctFormula, @cfFormula, @icpFormula;


	-- the end
	RETURN;
END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="937" />
							<Property Name="Length" Value="7508" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This function generates product statistics:&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&gt; U1VP - last price variation (x = 1 not changed, x &gt; 1 means price was rise and x &lt; 1 means the price was dropped&#xD;&#xA;&#x9;&#x9;&gt; U2VP - penultimate..&#xD;&#xA;&#x9;&#x9;&gt; U3VP - antepenultimate..&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&gt; EEP (Estatistica de Estabilidade de Preço) means Price Stability Statistic.&#xD;&#xA;&#x9;          Represents a estimation in days of the stability of actual price.&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&gt; ICP (Indice de Confiança no Preço) means Price Trust Index.&#xD;&#xA;&#x9;&#x9;      Thats a value between [0:1] that represents the current price trust.&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&#x9;  ICP = 0.5CE + 0.2CT + 0.3CF&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&gt; CE  (Componente Estabilidade) Estability Component&#xD;&#xA;&#x9;&#x9;      Is the price trust in prespective to EEP. &#xD;&#xA;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&gt; CT  (Componente Tendencia) Trend Component&#xD;&#xA;&#x9;&#x9;&#x9;  Is the price trust in prespective of last evolution of the price.&#xD;&#xA;&#xD;&#xA;&#x9;&#x9;&gt; CF  (Confiança Fornecedor) Trust on the Supplier&#xD;&#xA;&#x9;&#x9;&#x9;  Is the trust that exists on the supplier (supplier table record)&#xD;&#xA;&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE FUNCTION [dbo].GetProdutoMedidasPrecoFunction&#xD;&#xA;(&#xD;&#xA;&#x9;@U3Preco decimal(14,4),&#xD;&#xA;&#x9;@U3Data smalldatetime,&#xD;&#xA;&#x9;@U2Preco decimal(14,4),&#xD;&#xA;&#x9;@U2Data smalldatetime,&#xD;&#xA;&#x9;@U1Preco decimal(14,4),&#xD;&#xA;&#x9;@U1Data smalldatetime,&#xD;&#xA;&#x9;@UPreco decimal(14,4),&#xD;&#xA;&#x9;@UData smalldatetime,&#xD;&#xA;&#x9;@ConfiancaFornecedor float&#xD;&#xA;)&#xD;&#xA;RETURNS @results TABLE&#xD;&#xA;(&#xD;&#xA;&#x9;__idMedidaPreco integer PRIMARY KEY NOT NULL IDENTITY(1,1),&#xD;&#xA;&#x9;U3VP decimal(14,4) NULL,&#xD;&#xA;&#x9;U2VP decimal(14,4) NULL,&#xD;&#xA;&#x9;U1VP decimal(14,4) NULL,&#xD;&#xA;&#x9;EEP float NOT NULL,&#xD;&#xA;&#x9;ICP float NOT NULL,&#xD;&#xA;&#x9;EEPFormula nvarchar(256),&#xD;&#xA;&#x9;ICPCEFormula nvarchar(256),&#xD;&#xA;&#x9;ICPCTFormula nvarchar(256),&#xD;&#xA;&#x9;ICPCFFormula nvarchar(256),&#xD;&#xA;&#x9;ICPFormula nvarchar(256)&#xD;&#xA;)&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetProdutoMedidasPrecoFunction].[@U3Preco]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetProdutoMedidasPrecoFunction].[@U3Data]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetProdutoMedidasPrecoFunction].[@U2Preco]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetProdutoMedidasPrecoFunction].[@U2Data]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetProdutoMedidasPrecoFunction].[@U1Preco]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetProdutoMedidasPrecoFunction].[@U1Data]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetProdutoMedidasPrecoFunction].[@UPreco]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetProdutoMedidasPrecoFunction].[@UData]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetProdutoMedidasPrecoFunction].[@ConfiancaFornecedor]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlScalarFunction" Name="[dbo].[GetTextoOnlyAllowedCharsFunction]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetTextoOnlyAllowedCharsFunction].[@texto]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetTextoOnlyAllowedCharsFunction].[@allowedPattern]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN

	-- variaveis
	DECLARE @i AS INTEGER = 1, @n AS INTEGER = LEN(@texto), @result nvarchar(256) = '';

	-- percorrer cada caracter e concatenar apenas os caracteres permitidos
	WHILE @i <= @n
	BEGIN
		
		-- avalia o caracter atual (em processamento)
		IF SUBSTRING(@texto, @i, 1) LIKE @allowedPattern
		BEGIN
			-- se o caracter é válido na expressão regular, adiciona-o à expressão resultante
			SET @result += SUBSTRING(@texto, @i, 1);
		END

		-- incrementar contador
		SET @i += 1;

	END

	-- devolver texto stripped
	RETURN @result;
END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="390" />
							<Property Name="Length" Value="1103" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This function receives two arguments. The first one it's the text to be stripped off and the second&#xD;&#xA;&#x9;is the pattern of allowed chars.&#xD;&#xA;&#xD;&#xA;&#x9;All chars not allowed by pattern are excluded from the text and, the result string, is sended&#xD;&#xA;&#x9;back to calling point.&#xD;&#xA;&#xD;&#xA;&#x9;Example of use:&#xD;&#xA;&#x9;SELECT [dbo].GetTextoOnlyAllowedCharsFunction('Th.-is is the t-es+t num$ber 93!','[A-Za-z0-9 ]');&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE FUNCTION [dbo].GetTextoOnlyAllowedCharsFunction&#xD;&#xA;(&#xD;&#xA;&#x9;@texto nvarchar(256),&#xD;&#xA;&#x9;@allowedPattern nvarchar(256)&#xD;&#xA;)&#xD;&#xA;RETURNS nvarchar(256)&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetTextoOnlyAllowedCharsFunction].[@texto]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetTextoOnlyAllowedCharsFunction].[@allowedPattern]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Type">
				<Entry>
					<Element Type="SqlTypeSpecifier">
						<Property Name="Length" Value="256" />
						<Relationship Name="Type">
							<Entry>
								<References ExternalSource="BuiltIns" Name="[nvarchar]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlScalarFunction" Name="[dbo].[GetValidadePercentilFunction]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetValidadePercentilFunction].[@Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetValidadePercentilFunction].[@Validade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetValidadePercentilFunction].[@Percentil]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN
	
	-- variables
	DECLARE @n integer, @k integer;

	-- interval calculation in days
	SET @n = DATEDIFF(DAY, @Data, @Validade); 

	-- percentil calculation
	SET @k = (@Percentil / 100.0) * @n;

	-- send back the date that belongs to interval that matches the percentil received as argument
	RETURN DATEADD(DAY, @k, @Data); 
END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="150" />
							<Property Name="Length" Value="642" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This function receives a date interval and calculates the date correspondent to percentil received too.&#xD;&#xA;&#xD;&#xA;&#x9;k = (percentil / 100) * n&#xD;&#xA;&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE FUNCTION [dbo].[GetValidadePercentilFunction]&#xD;&#xA;(&#xD;&#xA;&#x9;@Data datetime,&#xD;&#xA;&#x9;@Validade smalldatetime,&#xD;&#xA;&#x9;@Percentil integer&#xD;&#xA;)&#xD;&#xA;RETURNS datetime&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetValidadePercentilFunction].[@Data]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetValidadePercentilFunction].[@Validade]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetValidadePercentilFunction].[@Percentil]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Type">
				<Entry>
					<Element Type="SqlTypeSpecifier">
						<Relationship Name="Type">
							<Entry>
								<References ExternalSource="BuiltIns" Name="[datetime]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[GroupCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([Codigo]) FROM [dbo].[Grupos]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GroupCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GroupCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="542" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[GroupCount]&#xD;&#xA;&#x9;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[GroupDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Grupos] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Grupos] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D02] ' + 'O registo que pretende eliminar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].[Grupos] Where [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Grupos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Grupos].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GroupDelete].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Grupos].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GroupDelete].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Grupos].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GroupDelete].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GroupDelete].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1520" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[GroupDelete]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[GroupInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Criacao smalldatetime, @Versao datetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Criacao = GETDATE()
	SET @Versao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[Grupos] ([Codigo], [Descricao], [Inativo], [Criacao], [Versao]) 
					VALUES (@Codigo, @Descricao, @Inativo, @Criacao, @Versao);
		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Grupos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Grupos].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Grupos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Grupos].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Grupos].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Grupos].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GroupInsert].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GroupInsert].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GroupInsert].[@Inativo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GroupInsert].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GroupInsert].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GroupInsert].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1110" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[GroupInsert]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Descricao nvarchar(50),&#xD;&#xA;&#x9;@Inativo bit&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[GroupSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT g.[Codigo], g.[Descricao], g.[Inativo], g.[Criacao], g.[Versao]				
						FROM [dbo].[Grupos] g' 
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GroupSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GroupSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GroupSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GroupSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="806" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[GroupSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[GroupUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Grupos] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Grupos] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U02] ' + 'O registo que pretende alterar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NovaVersao datetime, @NumeroLinhasAfetadas int

	SET @NovaVersao = GETDATE()


	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[Grupos] SET [Descricao] = @Descricao,
									[Inativo] = @Inativo,
									[Versao] = @NovaVersao
								WHERE [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Grupos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Grupos].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GroupUpdate].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Grupos].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GroupUpdate].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Grupos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GroupUpdate].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Grupos].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GroupUpdate].[@Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Grupos].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Grupos].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GroupUpdate].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GroupUpdate].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GroupUpdate].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GroupUpdate].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1713" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[GroupUpdate]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Descricao nvarchar(50),&#xD;&#xA;&#x9;@Inativo bit,&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Grupos]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Grupos].[Codigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Grupos].[Descricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Grupos].[Inativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Grupos].[Criacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Grupos].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="79" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Idiomas]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Idiomas].[Codigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Idiomas].[Descricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Idiomas].[Inativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Idiomas].[Criacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Idiomas].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="80" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Impostos]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Impostos].[Codigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Impostos].[Descricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Impostos].[DesignacaoFiscal]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Impostos].[Taxa]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Impostos].[Inativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Impostos].[Criacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Impostos].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="81" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[ImpostosMatching]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ImpostosMatching].[FornecedorCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ImpostosMatching].[Codigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ImpostosMatching].[Descricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ImpostosMatching].[MapTo]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ImpostosMatching].[Inativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ImpostosMatching].[Criacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ImpostosMatching].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="82" />
						<AttachedAnnotation Disambiguator="49" />
						<AttachedAnnotation Disambiguator="50" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[LanguageCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([Codigo]) FROM [dbo].[Idiomas]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LanguageCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[LanguageCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="546" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[LanguageCount]&#xD;&#xA;&#x9;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[LanguageDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Idiomas] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Idiomas] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D02] ' + 'O registo que pretende eliminar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].[Idiomas] Where [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Idiomas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Idiomas].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LanguageDelete].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Idiomas].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LanguageDelete].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Idiomas].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[LanguageDelete].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[LanguageDelete].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1526" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[LanguageDelete]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[LanguageInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Criacao smalldatetime, @Versao datetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Criacao = GETDATE()
	SET @Versao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[Idiomas] ([Codigo], [Descricao], [Inativo], [Criacao], [Versao]) 
					VALUES (@Codigo, @Descricao, @Inativo, @Criacao, @Versao);
		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Idiomas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Idiomas].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Idiomas].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Idiomas].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Idiomas].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Idiomas].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LanguageInsert].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LanguageInsert].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LanguageInsert].[@Inativo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[LanguageInsert].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[LanguageInsert].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[LanguageInsert].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1114" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[LanguageInsert]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Descricao nvarchar(50),&#xD;&#xA;&#x9;@Inativo bit&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[LanguageSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT i.[Codigo], i.[Descricao], i.[Inativo], i.[Criacao], i.[Versao]				
						FROM [dbo].[Idiomas] i' 
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LanguageSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LanguageSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[LanguageSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[LanguageSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="810" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[LanguageSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[LanguageUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Idiomas] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Idiomas] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U02] ' + 'O registo que pretende alterar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NovaVersao datetime, @NumeroLinhasAfetadas int

	SET @NovaVersao = GETDATE()


	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[Idiomas] SET [Descricao] = @Descricao,
									[Inativo] = @Inativo,
									[Versao] = @NovaVersao
								WHERE [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Idiomas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Idiomas].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LanguageUpdate].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Idiomas].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LanguageUpdate].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Idiomas].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LanguageUpdate].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Idiomas].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LanguageUpdate].[@Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Idiomas].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Idiomas].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[LanguageUpdate].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[LanguageUpdate].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[LanguageUpdate].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[LanguageUpdate].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1719" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[LanguageUpdate]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Descricao nvarchar(50),&#xD;&#xA;&#x9;@Inativo bit,&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Marcas]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Marcas].[Codigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Marcas].[Descricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Marcas].[Inativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Marcas].[Criacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Marcas].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="83" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[MarcasMatching]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[MarcasMatching].[FornecedorCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[MarcasMatching].[Codigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[MarcasMatching].[Descricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[MarcasMatching].[MapTo]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[MarcasMatching].[Inativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[MarcasMatching].[Criacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[MarcasMatching].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="84" />
						<AttachedAnnotation Disambiguator="51" />
						<AttachedAnnotation Disambiguator="52" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlView" Name="[dbo].[PartnumbersAmbiguosView]">
			<Property Name="QueryScript">
				<Value><![CDATA[ 
	
	SELECT DISTINCT c.Partnumber

	-- link Products to Quotations via Simplified Partnumber on both sides
	FROM [dbo].[Produtos] p
		 INNER JOIN [dbo].[CotacoesIncompletasMapeamentoProdutoView] c
				ON [dbo].[GetCotacaoPartnumberSimplificadoFunction](p.Partnumber) = [dbo].GetCotacaoPartnumberSimplificadoFunction(c.Partnumber)

	-- filter only not existing products and the ones that brand does not fit on the two sides (quotations - products)
	WHERE c.Referencia NOT IN
		(
			SELECT Codigo FROM [dbo].[Produtos]
		)
		AND p.MarcaCodigo <> c.MarcaCodigo]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[PartnumbersAmbiguosView].[Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[Produtos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetCotacaoPartnumberSimplificadoFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Referencia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[MarcaCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="518" />
				<Property Name="Length" Value="1137" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This view compares the deducted Product Codes from Incomplete Quotations and Product Codes already created. Then, when&#xD;&#xA;&#x9;they have a match and the entites (quotation vs product) have different brands, it assumes a Partnumber conflit.&#xD;&#xA;&#xD;&#xA;&#x9;The view shows ambiguous partnumbers, in other words, all partnumbers that on quotations side belongs to a brand 1 and in product table&#xD;&#xA;&#x9;belongs to brand 2..&#xD;&#xA;&#xD;&#xA;&#x9;If that prevention was a fake negative, user must create the product manually and map it manually too.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE VIEW [dbo].[PartnumbersAmbiguosView]&#xD;&#xA;&#x9;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_AvisosTipo]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[AvisosTipo].[Codigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[AvisosTipo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="8" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Catalogos]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Catalogos].[Codigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Catalogos]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="9" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Categorias]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Categorias].[Codigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Categorias]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="10" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_CategoriasMatching]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[CategoriasMatching].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[CategoriasMatching].[Codigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[CategoriasMatching]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="11" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Classes]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Classes].[Codigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Classes]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="14" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_ClassesCategorias]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[ClassesCategorias].[ClasseCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[ClassesCategorias].[CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[ClassesCategorias]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="16" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Complementos]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Complementos].[Codigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Complementos]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="19" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_ComplementosMatching]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[ComplementosMatching].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[ComplementosMatching].[Codigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[ComplementosMatching]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="20" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Cotacoes]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Cotacoes].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Cotacoes].[Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Cotacoes].[_ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Cotacoes].[_ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Cotacoes]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="23" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_CotacoesAvisos]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[CotacoesAvisos].[Id]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[CotacoesAvisos]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="33" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_CotacoesRegras]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[CotacoesRegras].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[CotacoesRegras].[MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[CotacoesRegras].[CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[CotacoesRegras].[StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[CotacoesRegras]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="37" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Estados]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Estados].[Codigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Estados]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="43" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_EstadosMatching]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[EstadosMatching].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[EstadosMatching].[Codigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[EstadosMatching]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="44" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Fornecedores]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Fornecedores].[Codigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="77" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_FornecedoresMarcas]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[FornecedoresMarcas].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[FornecedoresMarcas].[MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="78" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Grupos]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Grupos].[Codigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Grupos]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="79" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Idiomas]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Idiomas].[Codigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Idiomas]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="80" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Impostos]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Impostos].[Codigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Impostos]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="81" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_ImpostosMatching]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[ImpostosMatching].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[ImpostosMatching].[Codigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[ImpostosMatching]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="82" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Marcas]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Marcas].[Codigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Marcas]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="83" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_MarcasMatching]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[MarcasMatching].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[MarcasMatching].[Codigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[MarcasMatching]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="84" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Produtos]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Produtos].[Codigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Produtos]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="85" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_ProdutosDetalhe]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[ProdutosDetalhe].[ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[ProdutosDetalhe].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="86" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_ProdutosMatching]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[ProdutosMatching].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[ProdutosMatching].[ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[ProdutosMatching].[Codigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[ProdutosMatching]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="87" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Stocks]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Stocks].[Codigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="88" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_StocksMatching]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[StocksMatching].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[StocksMatching].[Codigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[StocksMatching]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="89" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Subgrupos]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Subgrupos].[Codigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Subgrupos]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="90" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_SubgruposClasses]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[SubgruposClasses].[SubgrupoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[SubgruposClasses].[ClasseCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[SubgruposClasses]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="91" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_TermosPreocupantes]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[TermosPreocupantes].[Termo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[TermosPreocupantes]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="92" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_Utilizadores]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Utilizadores].[Username]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Utilizadores]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="93" />
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[ProductCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([Codigo]) FROM [dbo].[Produtos]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="546" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[ProductCount]&#xD;&#xA;&#x9;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[ProductDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Produtos] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Produtos] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D02] ' + 'O registo que pretende eliminar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].[Produtos] Where [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDelete].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDelete].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDelete].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="40" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDelete].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1529" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[ProductDelete]&#xD;&#xA;&#x9;@Codigo nvarchar(40),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[ProductDetailsCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([CodigoProduto]) FROM [dbo].[ProdutosDetalhe]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="567" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[ProductDetailsCount]&#xD;&#xA;&#x9;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[ProductDetailsDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [ProdutoCodigo] FROM [dbo].[ProdutosDetalhe] WHERE [ProdutoCodigo] = @ProdutoCodigo AND [FornecedorCodigo] = @FornecedorCodigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [ProdutoCodigo] FROM [dbo].[ProdutosDetalhe] WHERE [ProdutoCodigo] = @ProdutoCodigo AND [FornecedorCodigo] = @FornecedorCodigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D02] ' + 'O registo que pretende eliminar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].ProdutosDetalhe Where [ProdutoCodigo] = @ProdutoCodigo AND [FornecedorCodigo] = @FornecedorCodigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsDelete].[@ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsDelete].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsDelete].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[FornecedorCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsDelete].[@ProdutoCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="40" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsDelete].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsDelete].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1780" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[ProductDetailsDelete]&#xD;&#xA;&#x9;@ProdutoCodigo nvarchar(40),&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[ProductDetailsInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Criacao smalldatetime, @Versao datetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Criacao = GETDATE()
	SET @Versao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[ProdutosDetalhe]
           ([ProdutoCodigo]
           ,[FornecedorCodigo]
           ,[Descricao]
           ,[DescricaoPontuacao]
           ,[DescricaoInativa]
           ,[Caracteristicas]
           ,[CaracteristicasPontuacao]
           ,[CaracteristicasInativas]
           ,[Link]
           ,[LinkPontuacao]
           ,[LinkInativo]
           ,[Imagem]
           ,[ImagemPontuacao]
           ,[ImagemInativa]
           ,[AtualizacaoAutomaticaInativa]
           ,[AtualizacaoManualNecessaria]
           ,[IndicePreocupacaoConteudo]
           ,[Criacao]
           ,[Versao])
		VALUES
           (@ProdutoCodigo,
			@FornecedorCodigo,
			@Descricao,
			@DescricaoPontuacao,
			@DescricaoInativa,
			@Caracteristicas,
			@CaracteristicasPontuacao,
			@CaracteristicasInativas,
			@Link,
			@LinkPontuacao,
			@LinkInativo,
			@Imagem,
			@ImagemPontuacao,
			@ImagemInativa,
			@AtualizacaoAutomaticaInativa,
			@AtualizacaoManualNecessaria,
			@IndicePreocupacaoConteudo,
            @Criacao,
            @Versao);
		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[DescricaoPontuacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[DescricaoInativa]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Caracteristicas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[CaracteristicasPontuacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[CaracteristicasInativas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Link]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[LinkPontuacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[LinkInativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Imagem]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[ImagemPontuacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[ImagemInativa]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[AtualizacaoAutomaticaInativa]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[AtualizacaoManualNecessaria]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[IndicePreocupacaoConteudo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsInsert].[@ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsInsert].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsInsert].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsInsert].[@DescricaoPontuacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsInsert].[@DescricaoInativa]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsInsert].[@Caracteristicas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsInsert].[@CaracteristicasPontuacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsInsert].[@CaracteristicasInativas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsInsert].[@Link]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsInsert].[@LinkPontuacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsInsert].[@LinkInativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsInsert].[@Imagem]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsInsert].[@ImagemPontuacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsInsert].[@ImagemInativa]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsInsert].[@AtualizacaoAutomaticaInativa]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsInsert].[@AtualizacaoManualNecessaria]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsInsert].[@IndicePreocupacaoConteudo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsInsert].[@ProdutoCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="40" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsInsert].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsInsert].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsInsert].[@DescricaoPontuacao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsInsert].[@DescricaoInativa]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsInsert].[@Caracteristicas]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="2048" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsInsert].[@CaracteristicasPontuacao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsInsert].[@CaracteristicasInativas]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsInsert].[@Link]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsInsert].[@LinkPontuacao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsInsert].[@LinkInativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsInsert].[@Imagem]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsInsert].[@ImagemPontuacao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsInsert].[@ImagemInativa]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsInsert].[@AtualizacaoAutomaticaInativa]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsInsert].[@AtualizacaoManualNecessaria]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsInsert].[@IndicePreocupacaoConteudo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[tinyint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="2552" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[ProductDetailsInsert]&#xD;&#xA;&#x9;@ProdutoCodigo nvarchar(40),&#xD;&#xA;    @FornecedorCodigo nvarchar(5),&#xD;&#xA;    @Descricao nvarchar(256),&#xD;&#xA;    @DescricaoPontuacao smallint,&#xD;&#xA;    @DescricaoInativa bit,&#xD;&#xA;    @Caracteristicas nvarchar(2048),&#xD;&#xA;&#x9;@CaracteristicasPontuacao smallint,&#xD;&#xA;    @CaracteristicasInativas bit,&#xD;&#xA;    @Link nvarchar(1024),&#xD;&#xA;    @LinkPontuacao smallint,&#xD;&#xA;    @LinkInativo bit,&#xD;&#xA;    @Imagem nvarchar(1024),&#xD;&#xA;    @ImagemPontuacao smallint,&#xD;&#xA;    @ImagemInativa bit,&#xD;&#xA;    @AtualizacaoAutomaticaInativa bit,&#xD;&#xA;    @AtualizacaoManualNecessaria bit,&#xD;&#xA;    @IndicePreocupacaoConteudo tinyint&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[ProductDetailsSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT p.[ProdutoCodigo]
					   ,p.[FornecedorCodigo]
					   ,f.[Nome] as FornecedorNome
					   ,p.[Descricao]
					   ,p.[DescricaoPontuacao]
					   ,p.[DescricaoInativa]
					   ,p.[Caracteristicas]
					   ,p.[CaracteristicasPontuacao]
					   ,p.[CaracteristicasInativas]
					   ,p.[Link]
					   ,p.[LinkPontuacao]
					   ,p.[LinkInativo]
					   ,p.[Imagem]
					   ,p.[ImagemPontuacao]
					   ,p.[ImagemInativa]
					   ,p.[AtualizacaoAutomaticaInativa]
					   ,p.[AtualizacaoManualNecessaria]
					   ,p.[IndicePreocupacaoConteudo]
					   ,p.[Criacao]
					   ,p.[Versao]				
					FROM [dbo].[ProdutosDetalhe] as p
					INNER JOIN [dbo].[Fornecedores] as f ON
						f.Codigo = FornecedorCodigo'
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1443" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[ProductDetailsSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[ProductDetailsUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [ProdutoCodigo] FROM [dbo].[ProdutosDetalhe] WHERE [ProdutoCodigo] = @ProdutoCodigo AND [FornecedorCodigo] = @FornecedorCodigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [ProdutoCodigo] FROM [dbo].[ProdutosDetalhe] WHERE [ProdutoCodigo] = @ProdutoCodigo AND [FornecedorCodigo] = @FornecedorCodigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U02] ' + 'O registo que pretende alterar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NovaVersao datetime, @NumeroLinhasAfetadas int

	SET @NovaVersao = GETDATE()


	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[ProdutosDetalhe] SET [Descricao] = @Descricao
			  ,[DescricaoPontuacao] = @DescricaoPontuacao 
			  ,[DescricaoInativa] = @DescricaoInativa 
			  ,[Caracteristicas] = @Caracteristicas
			  ,[CaracteristicasPontuacao] = @CaracteristicasPontuacao
			  ,[CaracteristicasInativas] = @CaracteristicasInativas 
			  ,[Link] = @Link 
			  ,[LinkPontuacao] = @LinkPontuacao
			  ,[LinkInativo] = @LinkInativo 
			  ,[Imagem] = @Imagem
			  ,[ImagemPontuacao] = @ImagemPontuacao
			  ,[ImagemInativa] = @ImagemInativa
			  ,[AtualizacaoAutomaticaInativa] = @AtualizacaoAutomaticaInativa
			  ,[AtualizacaoManualNecessaria] = @AtualizacaoManualNecessaria
			  ,[IndicePreocupacaoConteudo] = @IndicePreocupacaoConteudo
			  ,[Versao] = @NovaVersao
		   
								WHERE [ProdutoCodigo] = @ProdutoCodigo AND [FornecedorCodigo] = @FornecedorCodigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsUpdate].[@ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsUpdate].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsUpdate].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsUpdate].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[DescricaoPontuacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsUpdate].[@DescricaoPontuacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[DescricaoInativa]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsUpdate].[@DescricaoInativa]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Caracteristicas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsUpdate].[@Caracteristicas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[CaracteristicasPontuacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsUpdate].[@CaracteristicasPontuacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[CaracteristicasInativas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsUpdate].[@CaracteristicasInativas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Link]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsUpdate].[@Link]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[LinkPontuacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsUpdate].[@LinkPontuacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[LinkInativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsUpdate].[@LinkInativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Imagem]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsUpdate].[@Imagem]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[ImagemPontuacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsUpdate].[@ImagemPontuacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[ImagemInativa]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsUpdate].[@ImagemInativa]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[AtualizacaoAutomaticaInativa]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsUpdate].[@AtualizacaoAutomaticaInativa]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[AtualizacaoManualNecessaria]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsUpdate].[@AtualizacaoManualNecessaria]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[IndicePreocupacaoConteudo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductDetailsUpdate].[@IndicePreocupacaoConteudo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[FornecedorCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsUpdate].[@ProdutoCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="40" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsUpdate].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsUpdate].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsUpdate].[@DescricaoPontuacao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsUpdate].[@DescricaoInativa]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsUpdate].[@Caracteristicas]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="2048" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsUpdate].[@CaracteristicasPontuacao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsUpdate].[@CaracteristicasInativas]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsUpdate].[@Link]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsUpdate].[@LinkPontuacao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsUpdate].[@LinkInativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsUpdate].[@Imagem]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsUpdate].[@ImagemPontuacao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsUpdate].[@ImagemInativa]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsUpdate].[@AtualizacaoAutomaticaInativa]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsUpdate].[@AtualizacaoManualNecessaria]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsUpdate].[@IndicePreocupacaoConteudo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[tinyint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductDetailsUpdate].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="3074" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[ProductDetailsUpdate]&#xD;&#xA;&#x9;@ProdutoCodigo nvarchar(40),&#xD;&#xA;    @FornecedorCodigo nvarchar(5),&#xD;&#xA;    @Descricao nvarchar(256),&#xD;&#xA;    @DescricaoPontuacao smallint,&#xD;&#xA;    @DescricaoInativa bit,&#xD;&#xA;    @Caracteristicas nvarchar(2048),&#xD;&#xA;&#x9;@CaracteristicasPontuacao smallint,&#xD;&#xA;    @CaracteristicasInativas bit,&#xD;&#xA;    @Link nvarchar(1024),&#xD;&#xA;    @LinkPontuacao smallint,&#xD;&#xA;    @LinkInativo bit,&#xD;&#xA;    @Imagem nvarchar(1024),&#xD;&#xA;    @ImagemPontuacao smallint,&#xD;&#xA;    @ImagemInativa bit,&#xD;&#xA;    @AtualizacaoAutomaticaInativa bit,&#xD;&#xA;    @AtualizacaoManualNecessaria bit,&#xD;&#xA;    @IndicePreocupacaoConteudo tinyint,&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[ProductInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Criacao smalldatetime, @Versao datetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Criacao = GETDATE()
	SET @Versao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[Produtos] ([Codigo], [Descricao], [Partnumber], 
										[CategoriaCodigo], [MarcaCodigo], [ImpostoCodigo], 
										[FornecedorCodigo], [PrecoCusto], [PrecoCusto_Data], 
										[PrecoCusto_U1], [PrecoCusto_U1Data], [PrecoCusto_U2], 
										[PrecoCusto_U2Data], [PrecoCusto_U3], [PrecoCusto_U3Data], 
										[StockCodigo], [StockCodigo_Data], [StockCodigo_U1], 
										[StockCodigo_U1Data], [StockCodigo_U2], [StockCodigo_U2Data], 
										[StockCodigo_U3], [StockCodigo_U3Data], [Descontinuado], 
										[Inativo], [Criacao], [Versao]
									) 
					VALUES (@Codigo, @Descricao, @Partnumber, 
								@CategoriaCodigo, @MarcaCodigo, @ImpostoCodigo, 
								@FornecedorCodigo, @PrecoCusto, @PrecoCusto_Data, 
								@PrecoCusto_U1, @PrecoCusto_U1Data, @PrecoCusto_U2, 
								@PrecoCusto_U2Data, @PrecoCusto_U3, @PrecoCusto_U3Data, 
								@StockCodigo, @StockCodigo_Data, @StockCodigo_U1, 
								@StockCodigo_U1Data, @StockCodigo_U2, @StockCodigo_U2Data, 
								@StockCodigo_U3, @StockCodigo_U3Data, @Descontinuado, 
								@Inativo, @Criacao, @Versao
							);
		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[ImpostoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U1]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U1Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U2]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U2Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U3]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U3Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U1]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U1Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U2]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U2Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U3]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U3Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Descontinuado]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductInsert].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductInsert].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductInsert].[@Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductInsert].[@CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductInsert].[@MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductInsert].[@ImpostoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductInsert].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductInsert].[@PrecoCusto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductInsert].[@PrecoCusto_Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductInsert].[@PrecoCusto_U1]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductInsert].[@PrecoCusto_U1Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductInsert].[@PrecoCusto_U2]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductInsert].[@PrecoCusto_U2Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductInsert].[@PrecoCusto_U3]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductInsert].[@PrecoCusto_U3Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductInsert].[@StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductInsert].[@StockCodigo_Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductInsert].[@StockCodigo_U1]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductInsert].[@StockCodigo_U1Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductInsert].[@StockCodigo_U2]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductInsert].[@StockCodigo_U2Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductInsert].[@StockCodigo_U3]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductInsert].[@StockCodigo_U3Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductInsert].[@Descontinuado]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductInsert].[@Inativo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductInsert].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="40" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductInsert].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductInsert].[@Partnumber]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductInsert].[@CategoriaCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductInsert].[@MarcaCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductInsert].[@ImpostoCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductInsert].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductInsert].[@PrecoCusto]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductInsert].[@PrecoCusto_Data]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductInsert].[@PrecoCusto_U1]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductInsert].[@PrecoCusto_U1Data]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductInsert].[@PrecoCusto_U2]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductInsert].[@PrecoCusto_U2Data]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductInsert].[@PrecoCusto_U3]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductInsert].[@PrecoCusto_U3Data]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductInsert].[@StockCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductInsert].[@StockCodigo_Data]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductInsert].[@StockCodigo_U1]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductInsert].[@StockCodigo_U1Data]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductInsert].[@StockCodigo_U2]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductInsert].[@StockCodigo_U2Data]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductInsert].[@StockCodigo_U3]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductInsert].[@StockCodigo_U3Data]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductInsert].[@Descontinuado]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductInsert].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="2832" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[ProductInsert]&#xD;&#xA;&#x9;@Codigo nvarchar(40), &#xD;&#xA;&#x9;@Descricao nvarchar(256), &#xD;&#xA;&#x9;@Partnumber nvarchar(25), &#xD;&#xA;&#x9;@CategoriaCodigo nvarchar(20), &#xD;&#xA;&#x9;@MarcaCodigo nvarchar(5), &#xD;&#xA;&#x9;@ImpostoCodigo nvarchar(5), &#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5), &#xD;&#xA;&#x9;@PrecoCusto decimal(14,4), &#xD;&#xA;&#x9;@PrecoCusto_Data smalldatetime, &#xD;&#xA;&#x9;@PrecoCusto_U1 decimal(14,4), &#xD;&#xA;&#x9;@PrecoCusto_U1Data smalldatetime, &#xD;&#xA;&#x9;@PrecoCusto_U2 decimal(14,4), &#xD;&#xA;&#x9;@PrecoCusto_U2Data smalldatetime, &#xD;&#xA;&#x9;@PrecoCusto_U3 decimal(14,4), &#xD;&#xA;&#x9;@PrecoCusto_U3Data smalldatetime, &#xD;&#xA;&#x9;@StockCodigo nvarchar(5), &#xD;&#xA;&#x9;@StockCodigo_Data smalldatetime, &#xD;&#xA;&#x9;@StockCodigo_U1 nvarchar(5), &#xD;&#xA;&#x9;@StockCodigo_U1Data smalldatetime, &#xD;&#xA;&#x9;@StockCodigo_U2 nvarchar(5), &#xD;&#xA;&#x9;@StockCodigo_U2Data smalldatetime, &#xD;&#xA;&#x9;@StockCodigo_U3 nvarchar(5), &#xD;&#xA;&#x9;@StockCodigo_U3Data smalldatetime, &#xD;&#xA;&#x9;@Descontinuado bit, &#xD;&#xA;&#x9;@Inativo bit&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[ProductMatchingCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([Codigo]) FROM [dbo].[ProdutosMatching]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="562" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[ProductMatchingCount]&#xD;&#xA;&#x9;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[ProductMatchingDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[ProdutosMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo AND [ComplementoCodigo] = @ComplementoCodigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[ProdutosMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo AND [ComplementoCodigo] = @ComplementoCodigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D02] ' + 'O registo que pretende eliminar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].[ProdutosMatching] Where [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo AND [ComplementoCodigo] = @ComplementoCodigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingDelete].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingDelete].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingDelete].[@ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingDelete].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[ComplementoCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingDelete].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingDelete].[@ComplementoCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingDelete].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingDelete].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1895" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[ProductMatchingDelete]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@ComplementoCodigo nvarchar(256),&#xD;&#xA;&#x9;@Codigo nvarchar(256),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[ProductMatchingInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Criacao smalldatetime, @Versao datetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Criacao = GETDATE()
	SET @Versao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[ProdutosMatching] ([FornecedorCodigo], [Codigo], [MapTo], 
							[HorasValidadeCotacao], [StockCodigoSubstituto], [DispensaPrevencaoPrecosDesfasados], 
							[DispensaPrevencaoFalsoStock], [DataReset], [Notas], [Inativo], [Criacao], [Versao]) 
					VALUES (@FornecedorCodigo, @Codigo,  @MapTo, @HorasValidadeCotacao, @StockCodigoSubstituto,
							@DispensaPrevencaoPrecosDesfasados, @DispensaPrevencaoFalsoStock, @DataReset, @Notas, 
							@Inativo, @Criacao, @Versao);
		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[HorasValidadeCotacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[StockCodigoSubstituto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[DispensaPrevencaoPrecosDesfasados]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[DispensaPrevencaoFalsoStock]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[DataReset]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingInsert].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingInsert].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingInsert].[@MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingInsert].[@HorasValidadeCotacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingInsert].[@StockCodigoSubstituto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingInsert].[@DispensaPrevencaoPrecosDesfasados]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingInsert].[@DispensaPrevencaoFalsoStock]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingInsert].[@DataReset]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingInsert].[@Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingInsert].[@Inativo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingInsert].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingInsert].[@ComplementoCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingInsert].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingInsert].[@HorasValidadeCotacao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingInsert].[@StockCodigoSubstituto]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingInsert].[@DispensaPrevencaoPrecosDesfasados]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingInsert].[@DispensaPrevencaoFalsoStock]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingInsert].[@DataReset]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingInsert].[@Notas]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingInsert].[@MapTo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="40" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingInsert].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1739" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[ProductMatchingInsert]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@ComplementoCodigo nvarchar(128),&#xD;&#xA;&#x9;@Codigo nvarchar(256),&#xD;&#xA;&#x9;@HorasValidadeCotacao smallint,&#xD;&#xA;&#x9;@StockCodigoSubstituto nvarchar(5),&#xD;&#xA;&#x9;@DispensaPrevencaoPrecosDesfasados bit, &#xD;&#xA;&#x9;@DispensaPrevencaoFalsoStock bit,&#xD;&#xA;&#x9;@DataReset smalldatetime,&#xD;&#xA;&#x9;@Notas nvarchar(256),&#xD;&#xA;&#x9;@MapTo nvarchar(40),&#xD;&#xA;&#x9;@Inativo bit&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[ProductMatchingSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT m.[FornecedorCodigo], f.[Nome] as FornecedorNome, m.[Codigo], m.[ComplementoCodigo],
							m.[Descricao], COALESCE(m.[HorasValidadeCotacao], 0) as HorasValidadeCotacao, m.[StockCodigoSubstituto], s.[Descricao] as StockDescricao,
							m.[DispensaPrevencaoPrecosDesfasados],  m.[DispensaPrevencaoFalsoStock],
							m.[DataReset], m.[MapTo], m.[Notas], p.[Descricao] as ProdutoDescricao, m.[Inativo], m.[Criacao], m.[Versao]				
						FROM [dbo].[ProdutosMatching] m 
						INNER JOIN [dbo].[Fornecedores] f
							ON m.[FornecedorCodigo] = f.[Codigo] AND f.[INATIVO]='+'''FALSE''
						LEFT JOIN [dbo].[Stocks] s
							ON m.[StockCodigoSubstituto] = s.[Codigo] AND s.[INATIVO]='+'''FALSE''
						LEFT JOIN [dbo].[Produtos] p
							ON m.[MapTo] = p.[Codigo] AND p.[INATIVO]='+'''FALSE'''


	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1522" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[ProductMatchingSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[ProductMatchingUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[ProdutosMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo AND [ComplementoCodigo] = @ComplementoCodigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[ProdutosMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [ComplementoCodigo] = @ComplementoCodigo AND [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U02] ' + 'O registo que pretende alterar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NovaVersao datetime, @NumeroLinhasAfetadas int

	SET @NovaVersao = GETDATE()


	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[ProdutosMatching] SET [MapTo] = @MapTo,
									[HorasValidadeCotacao] = @HorasValidadeCotacao,
									[StockCodigoSubstituto] = @StockCodigoSubstituto,
									[DispensaPrevencaoPrecosDesfasados] = @DispensaPrevencaoPrecosDesfasados, 
									[DispensaPrevencaoFalsoStock] = @DispensaPrevencaoFalsoStock,
									[DataReset] = @DataReset,
									[Notas] = @Notas,
									[Inativo] = @Inativo,
									[Versao] = @NovaVersao
								WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo AND [ComplementoCodigo] = @ComplementoCodigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingUpdate].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingUpdate].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingUpdate].[@ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingUpdate].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingUpdate].[@MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[HorasValidadeCotacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingUpdate].[@HorasValidadeCotacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[StockCodigoSubstituto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingUpdate].[@StockCodigoSubstituto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[DispensaPrevencaoPrecosDesfasados]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingUpdate].[@DispensaPrevencaoPrecosDesfasados]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[DispensaPrevencaoFalsoStock]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingUpdate].[@DispensaPrevencaoFalsoStock]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[DataReset]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingUpdate].[@DataReset]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingUpdate].[@Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductMatchingUpdate].[@Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[ComplementoCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingUpdate].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingUpdate].[@ComplementoCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingUpdate].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingUpdate].[@HorasValidadeCotacao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingUpdate].[@StockCodigoSubstituto]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingUpdate].[@DispensaPrevencaoPrecosDesfasados]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingUpdate].[@DispensaPrevencaoFalsoStock]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingUpdate].[@DataReset]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingUpdate].[@Notas]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingUpdate].[@MapTo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="40" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingUpdate].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductMatchingUpdate].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="2618" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[ProductMatchingUpdate]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@ComplementoCodigo nvarchar(128),&#xD;&#xA;&#x9;@Codigo nvarchar(256),&#xD;&#xA;&#x9;@HorasValidadeCotacao smallint,&#xD;&#xA;&#x9;@StockCodigoSubstituto nvarchar(5),&#xD;&#xA;&#x9;@DispensaPrevencaoPrecosDesfasados bit, &#xD;&#xA;&#x9;@DispensaPrevencaoFalsoStock bit,&#xD;&#xA;&#x9;@DataReset smalldatetime,&#xD;&#xA;&#x9;@Notas nvarchar(256),&#xD;&#xA;&#x9;@MapTo nvarchar(40),&#xD;&#xA;&#x9;@Inativo bit,&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[ProductSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2500), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT p.[Codigo], p.[Descricao], p.[Partnumber], 
							p.[CategoriaCodigo], c.[Descricao] as CategoriaDescricao,
							p.[MarcaCodigo], m.[Descricao] as MarcaDescricao,
							p.[ImpostoCodigo], i.[Descricao] as ImpostoDescricao, i.[DesignacaoFiscal] as DesignacaoFiscal,
							p.[FornecedorCodigo], f.[Nome] as FonecedorNome, COALESCE(f.[ProdutosConfiancaPreco],0) as ProdutosConfiancaPreco, COALESCE(f.[ProdutosConfiancaDisponibilidade],0) as ProdutosConfiancaDisponibilidade, ICDFormula,
							pd.[AtualizacaoManualNecessaria] as AtualizacaoAutomatica,  COALESCE(pd.[IndicePreocupacaoConteudo], 0) as IPC,
							ICP, ICPFormula, ICPCEFormula, ICPCTFormula, ICPCFFormula,
							EEP, EEPFormula,
							EED, EEDFormula,
							ICD, ICDFormula, ICDCEFormula, ICDCTFormula, ICDCFFormula,							
							COALESCE(p.[PrecoCusto], 0) as PrecoCusto, p.[PrecoCusto_Data],
							COALESCE(p.[PrecoCusto_U1], 0) as PrecoCusto_U1, p.[PrecoCusto_U1Data], 
							COALESCE(p.[PrecoCusto_U2], 0) as PrecoCusto_U2, p.[PrecoCusto_U2Data], 
							COALESCE(p.[PrecoCusto_U3], 0) as PrecoCusto_U3, p.[PrecoCusto_U3Data], 
							p.[StockCodigo], s.[Descricao] as StockDescricao,p.[StockCodigo_Data], 
							p.[StockCodigo_U1], sU1.[Descricao] as StockDescricao_U1, p.[StockCodigo_U1Data], 
							p.[StockCodigo_U2], sU2.[Descricao] as StockDescricao_U2, p.[StockCodigo_U2Data], 
							p.[StockCodigo_U3], sU3.[Descricao] as StockDescricao_U3,p.[StockCodigo_U3Data], 
							p.[Descontinuado], p.[Inativo], 
							p.[Criacao], p.[Versao]
						FROM [dbo].[ProdutosView] p
						INNER JOIN  [dbo].[Fornecedores] f
							ON f.[Codigo] = p.[FornecedorCodigo]
						LEFT JOIN  [dbo].[Categorias] c
							ON c.[Codigo] = p.[CategoriaCodigo]
						LEFT JOIN  [dbo].[Marcas] m
							ON m.[Codigo] = p.[MarcaCodigo]
						LEFT JOIN  [dbo].[Impostos] i
							ON i.[Codigo] = p.[ImpostoCodigo]
						LEFT JOIN  [dbo].[ProdutosDetalhe] pd
							ON pd.[ProdutoCodigo] = p.[Codigo] AND pd.[FornecedorCodigo] = p.[FornecedorCodigo]
						LEFT JOIN  [dbo].[Stocks] s
							ON s.[Codigo] = p.[StockCodigo]
						LEFT JOIN  [dbo].[Stocks] sU1
							ON sU1.[Codigo] = p.[StockCodigo_U1]
						LEFT JOIN  [dbo].[Stocks] sU2
							ON sU2.[Codigo] = p.[StockCodigo_U2]
						LEFT JOIN  [dbo].[Stocks] sU3
							ON sU3.[Codigo] = p.[StockCodigo_U3]'
							 
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="3081" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[ProductSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[ProductUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Produtos] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Produtos] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U02] ' + 'O registo que pretende alterar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NovaVersao datetime, @NumeroLinhasAfetadas int

	SET @NovaVersao = GETDATE()


	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[Produtos] SET [Descricao]=@Descricao, 
									[Partnumber]=@Partnumber, 
									[CategoriaCodigo]=@CategoriaCodigo, 
									[MarcaCodigo]=@MarcaCodigo, 
									[ImpostoCodigo]=@ImpostoCodigo, 
									[FornecedorCodigo]=@FornecedorCodigo,
									[Descontinuado]=@Descontinuado, 
									[Inativo]=@Inativo, 
									[Versao] = @NovaVersao
								WHERE [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductUpdate].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductUpdate].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductUpdate].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductUpdate].[@Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductUpdate].[@CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductUpdate].[@MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[ImpostoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductUpdate].[@ImpostoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductUpdate].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Descontinuado]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductUpdate].[@Descontinuado]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProductUpdate].[@Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductUpdate].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="40" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductUpdate].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductUpdate].[@Partnumber]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductUpdate].[@CategoriaCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductUpdate].[@MarcaCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductUpdate].[@ImpostoCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductUpdate].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductUpdate].[@Descontinuado]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductUpdate].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ProductUpdate].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="2161" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[ProductUpdate]&#xD;&#xA;&#x9;@Codigo nvarchar(40), &#xD;&#xA;&#x9;@Descricao nvarchar(256), &#xD;&#xA;&#x9;@Partnumber nvarchar(25), &#xD;&#xA;&#x9;@CategoriaCodigo nvarchar(20), &#xD;&#xA;&#x9;@MarcaCodigo nvarchar(5), &#xD;&#xA;&#x9;@ImpostoCodigo nvarchar(5), &#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5), &#xD;&#xA;&#x9;@Descontinuado bit, &#xD;&#xA;&#x9;@Inativo bit, &#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Produtos]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[Codigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="40" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[Descricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[Partnumber]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="25" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[CategoriaCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[MarcaCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[ImpostoCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[FornecedorCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[PrecoCusto]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[PrecoCusto_Data]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[PrecoCusto_U1]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[PrecoCusto_U1Data]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[PrecoCusto_U2]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[PrecoCusto_U2Data]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[PrecoCusto_U3]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="14" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[PrecoCusto_U3Data]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[StockCodigo]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[StockCodigo_Data]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[StockCodigo_U1]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[StockCodigo_U1Data]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[StockCodigo_U2]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[StockCodigo_U2Data]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[StockCodigo_U3]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[StockCodigo_U3Data]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[Descontinuado]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[Inativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[Criacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Produtos].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="85" />
						<AttachedAnnotation Disambiguator="53" />
						<AttachedAnnotation Disambiguator="56" />
						<AttachedAnnotation Disambiguator="55" />
						<AttachedAnnotation Disambiguator="54" />
						<AttachedAnnotation Disambiguator="57" />
						<AttachedAnnotation Disambiguator="58" />
						<AttachedAnnotation Disambiguator="59" />
						<AttachedAnnotation Disambiguator="60" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlView" Name="[dbo].[ProdutosAtivosView]">
			<Property Name="IsSchemaBound" Value="True" />
			<Property Name="QueryScript">
				<Value><![CDATA[ 
	SELECT [Codigo], [Descricao], [Partnumber], [CategoriaCodigo], [MarcaCodigo], [ImpostoCodigo], [FornecedorCodigo],
		   [PrecoCusto], [PrecoCusto_Data], [PrecoCusto_U1], [PrecoCusto_U1Data], [PrecoCusto_U2], [PrecoCusto_U2Data], [PrecoCusto_U3], [PrecoCusto_U3Data],
           [StockCodigo], [StockCodigo_Data], [StockCodigo_U1], [StockCodigo_U1Data], [StockCodigo_U2], [StockCodigo_U2Data], [StockCodigo_U3], [StockCodigo_U3Data],
           [Descontinuado], [Inativo], [Criacao], [Versao]
	FROM [dbo].[Produtos]
	WHERE Inativo = CAST('false' as bit)
		  AND Descontinuado = CAST('false' as bit)]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[Codigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[Codigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[FornecedorCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[PrecoCusto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[PrecoCusto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[PrecoCusto_Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[PrecoCusto_Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[PrecoCusto_U1]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[PrecoCusto_U1]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[PrecoCusto_U1Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[PrecoCusto_U1Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[PrecoCusto_U2]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[PrecoCusto_U2]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[PrecoCusto_U2Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[PrecoCusto_U2Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[PrecoCusto_U3]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[PrecoCusto_U3]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[PrecoCusto_U3Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[PrecoCusto_U3Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[StockCodigo_Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[StockCodigo_Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[StockCodigo_U1]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[StockCodigo_U1]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[StockCodigo_U1Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[StockCodigo_U1Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[StockCodigo_U2]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[StockCodigo_U2]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[StockCodigo_U2Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[StockCodigo_U2Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[StockCodigo_U3]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[StockCodigo_U3]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[StockCodigo_U3Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[StockCodigo_U3Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[Descontinuado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[Descontinuado]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[Inativo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[Inativo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[Criacao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[Criacao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtivosView].[Versao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[Versao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[Produtos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[ImpostoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U1]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U1Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U2]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U2Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U3]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U3Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U1]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U1Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U2]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U2Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U3]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U3Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Descontinuado]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Versao]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="122" />
				<Property Name="Length" Value="946" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This view shows only active produts (Inativo='false') and not descontinued products (Descontinuado='false')&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE VIEW [dbo].[ProdutosAtivosView] WITH SchemaBinding -- all fields must be specified because we want a materialized view&#xD;&#xA;&#x9;AS" />
				<Property Name="FooterContents" Value=";&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;-- index that transforms this view a mateirialized view calls IDX_ProdutosAtivos" />
			</Annotation>
		</Element>
		<Element Type="SqlIndex" Name="[dbo].[ProdutosAtivosView].[ProdutosAtivosViewIndex]">
			<Property Name="IsUnique" Value="True" />
			<Property Name="IsClustered" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[Codigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[dbo].[ProdutosAtivosView]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlView" Name="[dbo].[ProdutosAtuaisView]">
			<Property Name="QueryScript">
				<Value><![CDATA[ 
	SELECT p.*, 
		   mp.*,
		   md.*,
		   s.Descricao as StockDescricao,
		   s1.Descricao as StockDescricao_U1,
		   s2.Descricao as StockDescricao_U2,
		   s3.Descricao as StockDescricao_U3,
		   COALESCE(pd.AtualizacaoManualNecessaria, 0) as AtualizacaoAutomatica,
		   COALESCE(f.ProdutosConfiancaPreco, 0) as ProdutosConfiancaPreco,
		   COALESCE(f.ProdutosConfiancaDisponibilidade, 0) as ProdutosConfiancaDisponibilidade,
		   COALESCE
			   (
					(
						SELECT MAX(pd.IndicePreocupacaoConteudo)
						FROM [dbo].[ProdutosDetalhe] pd
						WHERE pd.ProdutoCodigo = p.Codigo
					)
			   , 0) IPC


	FROM [dbo].[ProdutosAtivosView] p
		 INNER JOIN [dbo].[Fornecedores] f
			   ON p.FornecedorCodigo = f.Codigo
		 LEFT JOIN [dbo].[Stocks] s3
			  ON p.StockCodigo_U3 = s3.Codigo
		 LEFT JOIN [dbo].[Stocks] s2
			  ON p.StockCodigo_U2 = s2.Codigo
		 LEFT JOIN [dbo].[Stocks] s1
			  ON p.StockCodigo_U1 = s1.Codigo
		 LEFT JOIN [dbo].[Stocks] s
			  ON p.StockCodigo = s.Codigo
		LEFT JOIN  [dbo].[ProdutosDetalhe] pd
					ON pd.[ProdutoCodigo] = p.[Codigo] AND pd.[FornecedorCodigo] = p.[FornecedorCodigo]

		 CROSS APPLY [dbo].GetProdutoMedidasPrecoFunction( 
															p.PrecoCusto_U3, p.PrecoCusto_U3Data,
															p.PrecoCusto_U2, p.PrecoCusto_U2Data,
															p.PrecoCusto_U1, p.PrecoCusto_U1Data,
															p.PrecoCusto, p.PrecoCusto_Data,
															f.ProdutosConfiancaPreco
														 ) mp

		 CROSS APPLY [dbo].GetProdutoMedidasDisponibilidadeFunction(
																			s3.DisponibilidadeNivel, p.StockCodigo_U3Data,
																			s2.DisponibilidadeNivel, p.StockCodigo_U2Data,
																			s1.DisponibilidadeNivel, p.StockCodigo_U1Data,
																			s.DisponibilidadeNivel, p.StockCodigo_Data,
																			f.ProdutosConfiancaDisponibilidade
																   ) md]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[Codigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[Codigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[FornecedorCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[PrecoCusto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[PrecoCusto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[PrecoCusto_Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[PrecoCusto_Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[PrecoCusto_U1]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[PrecoCusto_U1]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[PrecoCusto_U1Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[PrecoCusto_U1Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[PrecoCusto_U2]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[PrecoCusto_U2]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[PrecoCusto_U2Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[PrecoCusto_U2Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[PrecoCusto_U3]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[PrecoCusto_U3]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[PrecoCusto_U3Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[PrecoCusto_U3Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[StockCodigo_Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[StockCodigo_Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[StockCodigo_U1]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[StockCodigo_U1]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[StockCodigo_U1Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[StockCodigo_U1Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[StockCodigo_U2]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[StockCodigo_U2]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[StockCodigo_U2Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[StockCodigo_U2Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[StockCodigo_U3]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[StockCodigo_U3]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[StockCodigo_U3Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[StockCodigo_U3Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[Descontinuado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[Descontinuado]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[Inativo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[Inativo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[Criacao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[Criacao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[Versao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[ProdutosAtivosView].[Versao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[__idMedidaPreco]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[__idMedidaPreco]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[U3VP]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[U3VP]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[U2VP]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[U2VP]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[U1VP]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[U1VP]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[EEP]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[EEP]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[ICP]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[ICP]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[EEPFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[EEPFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[ICPCEFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[ICPCEFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[ICPCTFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[ICPCTFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[ICPCFFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[ICPCFFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[ICPFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[ICPFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[__idMedidaDisponibilidade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[__idMedidaDisponibilidade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[U3VD]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[U3VD]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[U2VD]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[U2VD]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[U1VD]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[U1VD]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[EED]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[EED]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[ICD]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[ICD]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[EEDFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[EEDFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[ICDCEFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[ICDCEFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[ICDCTFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[ICDCTFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[ICDCFFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[ICDCFFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[ICDFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[ICDFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[StockDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Stocks].[Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[StockDescricao_U1]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Stocks].[Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[StockDescricao_U2]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Stocks].[Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[StockDescricao_U3]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Stocks].[Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[AtualizacaoAutomatica]" />
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[ProdutosConfiancaPreco]" />
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[ProdutosConfiancaDisponibilidade]" />
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosAtuaisView].[IPC]" />
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[ProdutosAtivosView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosAtivosView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosAtivosView].[StockCodigo_U3]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosAtivosView].[StockCodigo_U2]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosAtivosView].[StockCodigo_U1]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosAtivosView].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosAtivosView].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosAtivosView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosAtivosView].[PrecoCusto_U3]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosAtivosView].[PrecoCusto_U3Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosAtivosView].[PrecoCusto_U2]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosAtivosView].[PrecoCusto_U2Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosAtivosView].[PrecoCusto_U1]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosAtivosView].[PrecoCusto_U1Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosAtivosView].[PrecoCusto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosAtivosView].[PrecoCusto_Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ProdutosConfiancaPreco]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoMedidasPrecoFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[DisponibilidadeNivel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosAtivosView].[StockCodigo_U3Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[DisponibilidadeNivel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosAtivosView].[StockCodigo_U2Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[DisponibilidadeNivel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosAtivosView].[StockCodigo_U1Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[DisponibilidadeNivel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosAtivosView].[StockCodigo_Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ProdutosConfiancaDisponibilidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[AtualizacaoManualNecessaria]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ProdutosConfiancaPreco]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ProdutosConfiancaDisponibilidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[IndicePreocupacaoConteudo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosAtivosView].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="253" />
				<Property Name="Length" Value="2183" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This view shows active not descontinued products with adicional fields&#xD;&#xA;&#xD;&#xA;&#x9;IPC - (Indice Preocupação Conteudo) means Content Concern Index, and it is a value that represents problematic text that can &#xD;&#xA;&#x9;      exist on each product detail.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE VIEW [dbo].[ProdutosAtuaisView]&#xD;&#xA;&#x9;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlView" Name="[dbo].[ProdutosCodigosInexistentesView]">
			<Property Name="QueryScript">
				<Value><![CDATA[ 
	
	-- set of Product Codes (ProdutoCodigo) deducted from Incomplete Quotations (missing only ProdutoCodigo mapping)
	SELECT DISTINCT Referencia
	FROM [dbo].[CotacoesIncompletasMapeamentoProdutoView]

	EXCEPT

	-- set of all existing (already) created Product Codes (ProdutoCodigo)
	SELECT Codigo
	FROM Produtos]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosCodigosInexistentesView].[Referencia]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Referencia]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Referencia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="108" />
				<Property Name="Length" Value="486" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This view represents all Product Codes (ProdutoCodigo) that does not exist and must be created.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE VIEW [dbo].[ProdutosCodigosInexistentesView]&#xD;&#xA;&#x9;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[ProdutosDetalhe]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosDetalhe].[ProdutoCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="40" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosDetalhe].[FornecedorCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosDetalhe].[Descricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosDetalhe].[DescricaoPontuacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosDetalhe].[DescricaoInativa]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosDetalhe].[Caracteristicas]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="2048" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosDetalhe].[CaracteristicasPontuacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosDetalhe].[CaracteristicasInativas]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosDetalhe].[Link]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosDetalhe].[LinkPontuacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosDetalhe].[LinkInativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosDetalhe].[Imagem]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosDetalhe].[ImagemPontuacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosDetalhe].[ImagemInativa]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosDetalhe].[AtualizacaoAutomaticaInativa]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosDetalhe].[AtualizacaoManualNecessaria]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosDetalhe].[IndicePreocupacaoConteudo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[tinyint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosDetalhe].[Criacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosDetalhe].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="86" />
						<AttachedAnnotation Disambiguator="62" />
						<AttachedAnnotation Disambiguator="61" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[ProdutosMatching]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosMatching].[FornecedorCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosMatching].[ComplementoCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosMatching].[Codigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosMatching].[Descricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosMatching].[MapTo]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="40" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosMatching].[HorasValidadeCotacao]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosMatching].[StockCodigoSubstituto]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosMatching].[DispensaPrevencaoPrecosDesfasados]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosMatching].[DispensaPrevencaoFalsoStock]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosMatching].[DataReset]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosMatching].[Notas]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosMatching].[Inativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosMatching].[Criacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[ProdutosMatching].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="87" />
						<AttachedAnnotation Disambiguator="63" />
						<AttachedAnnotation Disambiguator="64" />
						<AttachedAnnotation Disambiguator="65" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlView" Name="[dbo].[ProdutosView]">
			<Property Name="QueryScript">
				<Value><![CDATA[ 
	SELECT p.*, 
		   mp.*,
		   md.*,
		   s.Descricao as StockDescricao,
		   s1.Descricao as StockDescricao_U1,
		   s2.Descricao as StockDescricao_U2,
		   s3.Descricao as StockDescricao_U3,
		   COALESCE(pd.AtualizacaoManualNecessaria, 0) as AtualizacaoAutomatica,
		   COALESCE(f.ProdutosConfiancaPreco, 0) as ProdutosConfiancaPreco,
		   COALESCE(f.ProdutosConfiancaDisponibilidade, 0) as ProdutosConfiancaDisponibilidade,
		   COALESCE
			   (
					(
						SELECT MAX(pd.IndicePreocupacaoConteudo)
						FROM [dbo].[ProdutosDetalhe] pd
						WHERE pd.ProdutoCodigo = p.Codigo
					)
			   , 0) IPC


	FROM [dbo].[Produtos] p
		 INNER JOIN [dbo].[Fornecedores] f
			   ON p.FornecedorCodigo = f.Codigo
		 LEFT JOIN [dbo].[Stocks] s3
			  ON p.StockCodigo_U3 = s3.Codigo
		 LEFT JOIN [dbo].[Stocks] s2
			  ON p.StockCodigo_U2 = s2.Codigo
		 LEFT JOIN [dbo].[Stocks] s1
			  ON p.StockCodigo_U1 = s1.Codigo
		 LEFT JOIN [dbo].[Stocks] s
			  ON p.StockCodigo = s.Codigo
		LEFT JOIN  [dbo].[ProdutosDetalhe] pd
					ON pd.[ProdutoCodigo] = p.[Codigo] AND pd.[FornecedorCodigo] = p.[FornecedorCodigo]

		 CROSS APPLY [dbo].GetProdutoMedidasPrecoFunction( 
															p.PrecoCusto_U3, p.PrecoCusto_U3Data,
															p.PrecoCusto_U2, p.PrecoCusto_U2Data,
															p.PrecoCusto_U1, p.PrecoCusto_U1Data,
															p.PrecoCusto, p.PrecoCusto_Data,
															f.ProdutosConfiancaPreco
														 ) mp

		 CROSS APPLY [dbo].GetProdutoMedidasDisponibilidadeFunction(
																			s3.DisponibilidadeNivel, p.StockCodigo_U3Data,
																			s2.DisponibilidadeNivel, p.StockCodigo_U2Data,
																			s1.DisponibilidadeNivel, p.StockCodigo_U1Data,
																			s.DisponibilidadeNivel, p.StockCodigo_Data,
																			f.ProdutosConfiancaDisponibilidade
																   ) md]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[Codigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[Codigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[Descricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[Partnumber]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[Partnumber]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[CategoriaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[CategoriaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[MarcaCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[MarcaCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[ImpostoCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[ImpostoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[FornecedorCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[PrecoCusto]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[PrecoCusto]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[PrecoCusto_Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[PrecoCusto_Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[PrecoCusto_U1]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[PrecoCusto_U1]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[PrecoCusto_U1Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[PrecoCusto_U1Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[PrecoCusto_U2]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[PrecoCusto_U2]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[PrecoCusto_U2Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[PrecoCusto_U2Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[PrecoCusto_U3]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[PrecoCusto_U3]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[PrecoCusto_U3Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[PrecoCusto_U3Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[StockCodigo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[StockCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[StockCodigo_Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[StockCodigo_Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[StockCodigo_U1]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[StockCodigo_U1]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[StockCodigo_U1Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[StockCodigo_U1Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[StockCodigo_U2]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[StockCodigo_U2]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[StockCodigo_U2Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[StockCodigo_U2Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[StockCodigo_U3]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[StockCodigo_U3]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[StockCodigo_U3Data]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[StockCodigo_U3Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[Descontinuado]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[Descontinuado]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[Inativo]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[Inativo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[Criacao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[Criacao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[Versao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Produtos].[Versao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[__idMedidaPreco]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[__idMedidaPreco]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[U3VP]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[U3VP]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[U2VP]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[U2VP]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[U1VP]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[U1VP]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[EEP]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[EEP]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[ICP]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[ICP]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[EEPFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[EEPFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[ICPCEFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[ICPCEFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[ICPCTFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[ICPCTFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[ICPCFFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[ICPCFFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[ICPFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasPrecoFunction].[ICPFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[__idMedidaDisponibilidade]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[__idMedidaDisponibilidade]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[U3VD]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[U3VD]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[U2VD]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[U2VD]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[U1VD]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[U1VD]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[EED]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[EED]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[ICD]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[ICD]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[EEDFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[EEDFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[ICDCEFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[ICDCEFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[ICDCTFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[ICDCTFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[ICDCFFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[ICDCFFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[ICDFormula]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction].[ICDFormula]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[StockDescricao]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Stocks].[Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[StockDescricao_U1]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Stocks].[Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[StockDescricao_U2]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Stocks].[Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[StockDescricao_U3]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[Stocks].[Descricao]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[AtualizacaoAutomatica]" />
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[ProdutosConfiancaPreco]" />
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[ProdutosConfiancaDisponibilidade]" />
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[ProdutosView].[IPC]" />
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[Produtos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U3]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U2]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U1]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U3]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U3Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U2]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U2Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U1]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U1Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ProdutosConfiancaPreco]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoMedidasPrecoFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[DisponibilidadeNivel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U3Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[DisponibilidadeNivel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U2Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[DisponibilidadeNivel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U1Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[DisponibilidadeNivel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ProdutosConfiancaDisponibilidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoMedidasDisponibilidadeFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[AtualizacaoManualNecessaria]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ProdutosConfiancaPreco]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ProdutosConfiancaDisponibilidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[IndicePreocupacaoConteudo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1914" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE VIEW [dbo].[ProdutosView]&#xD;&#xA;&#x9;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[QuotationRuleCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([FornecedorCodigo]) FROM [dbo].[CotacoesRegras]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationRuleCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationRuleCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="568" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[QuotationRuleCount]&#xD;&#xA;&#x9;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[QuotationRuleDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [FornecedorCodigo] FROM [dbo].[CotacoesRegras] WHERE [FornecedorCodigo] = @FornecedorCodigo 
																			AND [MarcaCodigo] = @MarcaCodigo
																			AND [CategoriaCodigo] = @CategoriaCodigo
																			AND [StockCodigo] = @StockCodigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [FornecedorCodigo] FROM [dbo].[CotacoesRegras] WHERE [FornecedorCodigo] = @FornecedorCodigo 
																			AND [MarcaCodigo] = @MarcaCodigo
																			AND [CategoriaCodigo] = @CategoriaCodigo
																			AND [StockCodigo] = @StockCodigo
																			AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D02] ' + 'O registo que pretende eliminar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].[CotacoesRegras] Where [FornecedorCodigo] = @FornecedorCodigo 
												AND [MarcaCodigo] = @MarcaCodigo
												AND [CategoriaCodigo] = @CategoriaCodigo
												AND [StockCodigo] = @StockCodigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationRuleDelete].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationRuleDelete].[@MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationRuleDelete].[@CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationRuleDelete].[@StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationRuleDelete].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[StockCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationRuleDelete].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationRuleDelete].[@MarcaCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationRuleDelete].[@CategoriaCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationRuleDelete].[@StockCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationRuleDelete].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="2234" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[QuotationRuleDelete]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@MarcaCodigo nvarchar(5),&#xD;&#xA;&#x9;@CategoriaCodigo nvarchar(20),&#xD;&#xA;&#x9;@StockCodigo nvarchar(5),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[QuotationRuleInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Criacao smalldatetime, @Versao datetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Criacao = GETDATE()
	SET @Versao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[CotacoesRegras] ([FornecedorCodigo], [MarcaCodigo], [CategoriaCodigo], [StockCodigo], 
						[HorasValidade], [StockCodigoSubstituto], [DataReset], [Notas], [Versao]) 
					VALUES (@FornecedorCodigo, @MarcaCodigo, @CategoriaCodigo, @StockCodigo, 
						@HorasValidade, @StockCodigoSubstituto, @DataReset, @Notas, @Versao);
		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[HorasValidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[StockCodigoSubstituto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[DataReset]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationRuleInsert].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationRuleInsert].[@MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationRuleInsert].[@CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationRuleInsert].[@StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationRuleInsert].[@HorasValidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationRuleInsert].[@StockCodigoSubstituto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationRuleInsert].[@DataReset]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationRuleInsert].[@Notas]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationRuleInsert].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationRuleInsert].[@MarcaCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationRuleInsert].[@CategoriaCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationRuleInsert].[@StockCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationRuleInsert].[@HorasValidade]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationRuleInsert].[@StockCodigoSubstituto]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationRuleInsert].[@DataReset]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationRuleInsert].[@Notas]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1487" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[QuotationRuleInsert]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@MarcaCodigo nvarchar(5),&#xD;&#xA;&#x9;@CategoriaCodigo nvarchar(20),&#xD;&#xA;&#x9;@StockCodigo nvarchar(5),&#xD;&#xA;&#x9;@HorasValidade smallint,&#xD;&#xA;&#x9;@StockCodigoSubstituto nvarchar(5),&#xD;&#xA;&#x9;@DataReset smalldatetime,&#xD;&#xA;&#x9;@Notas nvarchar(256)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[QuotationRuleSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT cr.[FornecedorCodigo], f.[Nome] as FornecedorNome, 
							cr.[MarcaCodigo],  m.[Descricao] as MarcaDescricao,
							cr.[CategoriaCodigo],  c.[Descricao] as CategoriaDescricao,
							cr.[StockCodigo],  s.[Descricao] as StockDescricao, s.DisponibilidadeNivel,
							cr.[HorasValidade], cr.[StockCodigoSubstituto], s1.[Descricao] as StockDescricaoSubstituto, cr.[DataReset], cr.[Notas], cr.[Versao]				
						FROM [dbo].[CotacoesRegras] cr 
						LEFT JOIN [dbo].[Fornecedores] f
							ON cr.[FornecedorCodigo] = f.[Codigo] AND f.[INATIVO]='+'''FALSE'''+
						'LEFT JOIN [dbo].[Marcas] m
							ON cr.[MarcaCodigo] = m.[Codigo] AND m.[INATIVO]='+'''FALSE'''+
						'LEFT JOIN [dbo].[Categorias] c
							ON cr.[CategoriaCodigo] = c.[Codigo]AND c.[INATIVO]='+'''FALSE'''+
						'LEFT JOIN [dbo].[Stocks] s
							ON cr.[StockCodigo] = s.[Codigo]AND s.[INATIVO]='+'''FALSE'''+
						'LEFT JOIN [dbo].[Stocks] s1
							ON cr.[StockCodigoSubstituto] = s1.[Codigo]AND s1.[INATIVO]='+'''FALSE'''
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationRuleSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationRuleSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationRuleSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationRuleSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1724" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[QuotationRuleSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[QuotationRuleUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [FornecedorCodigo] FROM [dbo].[CotacoesRegras] WHERE [FornecedorCodigo] = @FornecedorCodigo 
																AND [MarcaCodigo] = @MarcaCodigo
																AND [CategoriaCodigo] = @CategoriaCodigo
																AND [StockCodigo] = @StockCodigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [FornecedorCodigo] FROM [dbo].[CotacoesRegras] WHERE [FornecedorCodigo] = @FornecedorCodigo 
																AND [MarcaCodigo] = @MarcaCodigo
																AND [CategoriaCodigo] = @CategoriaCodigo
																AND [StockCodigo] = @StockCodigo 
																AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U02] ' + 'O registo que pretende alterar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NovaVersao datetime, @NumeroLinhasAfetadas int

	SET @NovaVersao = GETDATE()


	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[CotacoesRegras] SET [HorasValidade] = @HorasValidade,
									[StockCodigoSubstituto] = @StockCodigoSubstituto,
									[DataReset] = @DataReset,
									[Notas] = @Notas,
									[Versao] = @NovaVersao
								WHERE [FornecedorCodigo] = @FornecedorCodigo 
									AND [MarcaCodigo] = @MarcaCodigo
									AND [CategoriaCodigo] = @CategoriaCodigo
									AND [StockCodigo] = @StockCodigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationRuleUpdate].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationRuleUpdate].[@MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationRuleUpdate].[@CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationRuleUpdate].[@StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationRuleUpdate].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[HorasValidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationRuleUpdate].[@HorasValidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[StockCodigoSubstituto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationRuleUpdate].[@StockCodigoSubstituto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[DataReset]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationRuleUpdate].[@DataReset]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationRuleUpdate].[@Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[StockCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationRuleUpdate].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationRuleUpdate].[@MarcaCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationRuleUpdate].[@CategoriaCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationRuleUpdate].[@StockCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationRuleUpdate].[@HorasValidade]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationRuleUpdate].[@StockCodigoSubstituto]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationRuleUpdate].[@DataReset]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationRuleUpdate].[@Notas]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationRuleUpdate].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="2572" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[QuotationRuleUpdate]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@MarcaCodigo nvarchar(5),&#xD;&#xA;&#x9;@CategoriaCodigo nvarchar(20),&#xD;&#xA;&#x9;@StockCodigo nvarchar(5),&#xD;&#xA;&#x9;@HorasValidade smallint,&#xD;&#xA;&#x9;@StockCodigoSubstituto nvarchar(5),&#xD;&#xA;&#x9;@DataReset smalldatetime,&#xD;&#xA;&#x9;@Notas nvarchar(256),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[QuotationWarningCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([Id]) FROM [dbo].[CotacoesAvisos]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationWarningCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationWarningCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="557" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[QuotationWarningCount]&#xD;&#xA;&#x9;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[QuotationWarningDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [Id] FROM [dbo].[CotacoesAvisos] WHERE [Id] = @Id)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].[CotacoesAvisos] Where [Id] = @Id

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Id]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationWarningDelete].[@Id]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Id]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationWarningDelete].[@Id]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1174" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[QuotationWarningDelete]&#xD;&#xA;&#x9;@Id nvarchar(5)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[QuotationWarningInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Criacao smalldatetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Criacao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[CotacoesAvisos] ([Id], [Data], [_ProdutoCodigo], [_ComplementoCodigo], [FornecedorCodigo], [AvisoTipoCodigo], [Descricao], [Criacao]) 
					VALUES (@Id, @Data, @ProdutoCodigo, @ComplementoCodigo, @FornecedorCodigo, @AvisoTipoCodigo, @Descricao, @Criacao);
		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Id]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[AvisoTipoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationWarningInsert].[@Id]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationWarningInsert].[@Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationWarningInsert].[@ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationWarningInsert].[@ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationWarningInsert].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationWarningInsert].[@AvisoTipoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationWarningInsert].[@Descricao]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationWarningInsert].[@Id]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationWarningInsert].[@Data]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationWarningInsert].[@ProdutoCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationWarningInsert].[@ComplementoCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationWarningInsert].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationWarningInsert].[@AvisoTipoCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationWarningInsert].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1345" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[QuotationWarningInsert]&#xD;&#xA;&#x9;@Id uniqueidentifier,&#xD;&#xA;&#x9;@Data smalldatetime,&#xD;&#xA;&#x9;@ProdutoCodigo nvarchar(256),&#xD;&#xA;&#x9;@ComplementoCodigo nvarchar(128),&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@AvisoTipoCodigo nvarchar(5),&#xD;&#xA;&#x9;@Descricao nvarchar(20)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[QuotationWarningSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT c.[Id], c.[Data], c.[_ProdutoCodigo], 
							c.[_ComplementoCodigo], c.[FornecedorCodigo], f.[Nome], f.[Contribuinte],
							c.[AvisoTipoCodigo], av.[Descricao] as AvisoTipoDescricao, av.[Gravidade], c.[Descricao], c.[Criacao]				
						FROM [dbo].[CotacoesAvisos] c 
						INNER JOIN [dbo].[Fornecedores] f
							ON c.[FornecedorCodigo] = f.[Codigo] and f.[Inativo]='+'''FALSE'''+'
						INNER JOIN [dbo].[AvisosTipo] av
							ON c.[AvisoTipoCodigo] = av.[Codigo] and av.[Inativo]='+'''FALSE'''  
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationWarningSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationWarningSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationWarningSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationWarningSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1227" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[QuotationWarningSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[QuotationWarningUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [Id] FROM [dbo].[CotacoesAvisos] WHERE [Id] = @Id)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE  @NumeroLinhasAfetadas int

	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[CotacoesAvisos] SET [Data] = @Data,
										[_ProdutoCodigo]=@ProdutoCodigo,
										[_ComplementoCodigo]=@ComplementoCodigo,
										[FornecedorCodigo] = @FornecedorCodigo,
										[AvisoTipoCodigo] = @AvisoTipoCodigo,
										[Descricao] = @Descricao
									WHERE [Id] = @Id

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Id]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationWarningUpdate].[@Id]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationWarningUpdate].[@Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationWarningUpdate].[@ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationWarningUpdate].[@ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationWarningUpdate].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[AvisoTipoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationWarningUpdate].[@AvisoTipoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[QuotationWarningUpdate].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Id]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationWarningUpdate].[@Id]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationWarningUpdate].[@Data]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationWarningUpdate].[@ProdutoCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationWarningUpdate].[@ComplementoCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationWarningUpdate].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationWarningUpdate].[@AvisoTipoCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[QuotationWarningUpdate].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1616" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[QuotationWarningUpdate]&#xD;&#xA;&#x9;@Id uniqueidentifier,&#xD;&#xA;&#x9;@Data smalldatetime,&#xD;&#xA;&#x9;@ProdutoCodigo nvarchar(256),&#xD;&#xA;&#x9;@ComplementoCodigo nvarchar(128),&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@AvisoTipoCodigo nvarchar(5),&#xD;&#xA;&#x9;@Descricao nvarchar(20)&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlScalarFunction" Name="[dbo].[RemoveAccentuationFunction]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[RemoveAccentuationFunction].[@texto]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN

	-- remove accents
	SET @texto = REPLACE(@texto, 'À' COLLATE Latin1_General_CS_AS, 'A'); -- CS -> Case Sensitive
	SET @texto = REPLACE(@texto, 'Á' COLLATE Latin1_General_CS_AS, 'A');
	SET @texto = REPLACE(@texto, 'Ã' COLLATE Latin1_General_CS_AS, 'A');
	SET @texto = REPLACE(@texto, 'Â' COLLATE Latin1_General_CS_AS, 'A');
	SET @texto = REPLACE(@texto, 'Ä' COLLATE Latin1_General_CS_AS, 'A');
	SET @texto = REPLACE(@texto, 'È' COLLATE Latin1_General_CS_AS, 'E');
	SET @texto = REPLACE(@texto, 'É' COLLATE Latin1_General_CS_AS, 'E');
	SET @texto = REPLACE(@texto, 'Ê' COLLATE Latin1_General_CS_AS, 'E');
	SET @texto = REPLACE(@texto, 'Ë' COLLATE Latin1_General_CS_AS, 'E');
	SET @texto = REPLACE(@texto, 'Ì' COLLATE Latin1_General_CS_AS, 'I');
	SET @texto = REPLACE(@texto, 'Í' COLLATE Latin1_General_CS_AS, 'I');
	SET @texto = REPLACE(@texto, 'Î' COLLATE Latin1_General_CS_AS, 'I');
	SET @texto = REPLACE(@texto, 'Ï' COLLATE Latin1_General_CS_AS, 'I');
	SET @texto = REPLACE(@texto, 'Ò' COLLATE Latin1_General_CS_AS, 'O');
	SET @texto = REPLACE(@texto, 'Ó' COLLATE Latin1_General_CS_AS, 'O');
	SET @texto = REPLACE(@texto, 'Õ' COLLATE Latin1_General_CS_AS, 'O');
	SET @texto = REPLACE(@texto, 'Ô' COLLATE Latin1_General_CS_AS, 'O');
	SET @texto = REPLACE(@texto, 'Ö' COLLATE Latin1_General_CS_AS, 'O');
	SET @texto = REPLACE(@texto, 'Ù' COLLATE Latin1_General_CS_AS, 'U');
	SET @texto = REPLACE(@texto, 'Ú' COLLATE Latin1_General_CS_AS, 'U');
	SET @texto = REPLACE(@texto, 'Û' COLLATE Latin1_General_CS_AS, 'U');
	SET @texto = REPLACE(@texto, 'Ü' COLLATE Latin1_General_CS_AS, 'U');
	SET @texto = REPLACE(@texto, 'Ç' COLLATE Latin1_General_CS_AS, 'C');

	SET @texto = REPLACE(@texto, 'à' COLLATE Latin1_General_CS_AS, 'a');
	SET @texto = REPLACE(@texto, 'á' COLLATE Latin1_General_CS_AS, 'a');
	SET @texto = REPLACE(@texto, 'ã' COLLATE Latin1_General_CS_AS, 'a');
	SET @texto = REPLACE(@texto, 'â' COLLATE Latin1_General_CS_AS, 'a');
	SET @texto = REPLACE(@texto, 'ä' COLLATE Latin1_General_CS_AS, 'a');
	SET @texto = REPLACE(@texto, 'è' COLLATE Latin1_General_CS_AS, 'e');
	SET @texto = REPLACE(@texto, 'é' COLLATE Latin1_General_CS_AS, 'e');
	SET @texto = REPLACE(@texto, 'ê' COLLATE Latin1_General_CS_AS, 'e');
	SET @texto = REPLACE(@texto, 'ë' COLLATE Latin1_General_CS_AS, 'e');
	SET @texto = REPLACE(@texto, 'ì' COLLATE Latin1_General_CS_AS, 'i');
	SET @texto = REPLACE(@texto, 'í' COLLATE Latin1_General_CS_AS, 'i');
	SET @texto = REPLACE(@texto, 'î' COLLATE Latin1_General_CS_AS, 'i');
	SET @texto = REPLACE(@texto, 'ï' COLLATE Latin1_General_CS_AS, 'i');
	SET @texto = REPLACE(@texto, 'ò' COLLATE Latin1_General_CS_AS, 'o');
	SET @texto = REPLACE(@texto, 'ó' COLLATE Latin1_General_CS_AS, 'o');
	SET @texto = REPLACE(@texto, 'õ' COLLATE Latin1_General_CS_AS, 'o');
	SET @texto = REPLACE(@texto, 'ô' COLLATE Latin1_General_CS_AS, 'o');
	SET @texto = REPLACE(@texto, 'ö' COLLATE Latin1_General_CS_AS, 'o');
	SET @texto = REPLACE(@texto, 'ù' COLLATE Latin1_General_CS_AS, 'u');
	SET @texto = REPLACE(@texto, 'ú' COLLATE Latin1_General_CS_AS, 'u');
	SET @texto = REPLACE(@texto, 'û' COLLATE Latin1_General_CS_AS, 'u');
	SET @texto = REPLACE(@texto, 'ü' COLLATE Latin1_General_CS_AS, 'u');
	SET @texto = REPLACE(@texto, 'ç' COLLATE Latin1_General_CS_AS, 'c');

	-- return text cleaned
	RETURN @texto;
END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="110" />
							<Property Name="Length" Value="3584" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;O objetivo desta função é limpar uma string com caracteres lixo e espaço em excesso, por exemplo.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE FUNCTION [dbo].RemoveAccentuationFunction&#xD;&#xA;(&#xD;&#xA;&#x9;@texto nvarchar(256)&#xD;&#xA;)&#xD;&#xA;RETURNS nvarchar(256)&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[RemoveAccentuationFunction].[@texto]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Type">
				<Entry>
					<Element Type="SqlTypeSpecifier">
						<Property Name="Length" Value="256" />
						<Relationship Name="Type">
							<Entry>
								<References ExternalSource="BuiltIns" Name="[nvarchar]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlMultiStatementTableValuedFunction" Name="[dbo].[SplitStringFunction]">
			<Property Name="ReturnTableVariable" Value="@list" />
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SplitStringFunction].[@splitChar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SplitStringFunction].[@stringToSplit]" />
				</Entry>
			</Relationship>
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[SplitStringFunction].[Element]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN
	
	-- variables
	DECLARE @name nvarchar(256), @pos integer;

	-- build list of splitted terms
	WHILE CHARINDEX(@splitChar, @stringToSplit) > 0
	BEGIN

		-- keep term and current position
		SELECT @pos = CHARINDEX(@splitChar, @stringToSplit);
		SELECT @name = SUBSTRING(@stringToSplit, 1, @pos-1);

		-- insert extracted term into @list
		INSERT INTO @list
		SELECT @name;

		-- new stringToSplit is reduced
		SELECT @stringToSplit = SUBSTRING(@stringToSplit, @pos+1, LEN(@stringToSplit)-@pos);

	END

	-- finally
	INSERT INTO @list
	SELECT @stringToSplit;

	-- get out
	RETURN
END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="89" />
							<Property Name="Length" Value="861" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;this function receives a string and returns a table with all splitted terms.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE FUNCTION [dbo].[SplitStringFunction]&#xD;&#xA;(&#xD;&#xA;&#x9;@stringToSplit nvarchar(256),&#xD;&#xA;&#x9;@splitChar char(1)&#xD;&#xA;)&#xD;&#xA;RETURNS @list TABLE &#xD;&#xA;(&#xD;&#xA;&#x9;[Element] nvarchar(256)&#xD;&#xA;)" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SplitStringFunction].[@stringToSplit]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SplitStringFunction].[@splitChar]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[char]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[StateCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([Codigo]) FROM [dbo].[Estados]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="543" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[StateCount]&#xD;&#xA;&#x9;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[StateDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Estados] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Estados] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D02] ' + 'O registo que pretende eliminar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].[Estados] Where [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Estados]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Estados].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateDelete].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Estados].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateDelete].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Estados].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateDelete].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateDelete].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1523" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[StateDelete]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[StateInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Criacao smalldatetime, @Versao datetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Criacao = GETDATE()
	SET @Versao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[Estados] ([Codigo], [Descricao], [Inativo], [Criacao], [Versao]) 
					VALUES (@Codigo, @Descricao, @Inativo, @Criacao, @Versao);
		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Estados]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Estados].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Estados].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Estados].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Estados].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Estados].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateInsert].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateInsert].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateInsert].[@Inativo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateInsert].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateInsert].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateInsert].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1111" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[StateInsert]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Descricao nvarchar(50),&#xD;&#xA;&#x9;@Inativo bit&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[StateMatchingCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([Codigo]) FROM [dbo].[EstadosMatching]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateMatchingCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateMatchingCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="559" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[StateMatchingCount]&#xD;&#xA;&#x9;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[StateMatchingDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[EstadosMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[EstadosMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D02] ' + 'O registo que pretende eliminar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].[EstadosMatching] Where [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateMatchingDelete].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateMatchingDelete].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateMatchingDelete].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateMatchingDelete].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateMatchingDelete].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateMatchingDelete].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1719" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[StateMatchingDelete]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@Codigo nvarchar(128),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[StateMatchingInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Criacao smalldatetime, @Versao datetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Criacao = GETDATE()
	SET @Versao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[EstadosMatching] ([FornecedorCodigo], [Codigo], [Descricao], [MapTo], [Inativo], [Criacao], [Versao]) 
					VALUES (@FornecedorCodigo, @Codigo, @Descricao, @MapTo, @Inativo, @Criacao, @Versao);
		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateMatchingInsert].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateMatchingInsert].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateMatchingInsert].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateMatchingInsert].[@MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateMatchingInsert].[@Inativo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateMatchingInsert].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateMatchingInsert].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateMatchingInsert].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateMatchingInsert].[@MapTo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateMatchingInsert].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1241" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[StateMatchingInsert]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@Codigo nvarchar(128),&#xD;&#xA;&#x9;@Descricao nvarchar(128),&#xD;&#xA;&#x9;@MapTo nvarchar(5),&#xD;&#xA;&#x9;@Inativo bit&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[StateMatchingSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT matching.[FornecedorCodigo], fornecedores.[Nome] as FornecedorNome, matching.[Codigo], matching.[Descricao], 
							matching.[MapTo], matching.[Inativo], matching.[Criacao], matching.[Versao]				
						FROM [dbo].[EstadosMatching] matching 
						INNER JOIN [dbo].[Fornecedores] fornecedores
							ON matching.[FornecedorCodigo] = fornecedores.[Codigo] AND fornecedores.[INATIVO]='+'''FALSE'''
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateMatchingSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateMatchingSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateMatchingSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateMatchingSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1115" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[StateMatchingSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[StateMatchingUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[EstadosMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[EstadosMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U02] ' + 'O registo que pretende alterar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NovaVersao datetime, @NumeroLinhasAfetadas int

	SET @NovaVersao = GETDATE()


	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[EstadosMatching] SET [Descricao] = @Descricao,
									[MapTo] = @MapTo,
									[Inativo] = @Inativo,
									[Versao] = @NovaVersao
								WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateMatchingUpdate].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateMatchingUpdate].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateMatchingUpdate].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateMatchingUpdate].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateMatchingUpdate].[@MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateMatchingUpdate].[@Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateMatchingUpdate].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateMatchingUpdate].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateMatchingUpdate].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateMatchingUpdate].[@MapTo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateMatchingUpdate].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateMatchingUpdate].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1963" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[StateMatchingUpdate]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@Codigo nvarchar(128),&#xD;&#xA;&#x9;@Descricao nvarchar(128),&#xD;&#xA;&#x9;@MapTo nvarchar(5),&#xD;&#xA;&#x9;@Inativo bit,&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[StateSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT e.[Codigo], e.[Descricao], e.[Inativo], e.[Criacao], e.[Versao]				
						FROM [dbo].[Estados] e' 
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="807" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[StateSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[StateUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Estados] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Estados] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U02] ' + 'O registo que pretende alterar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NovaVersao datetime, @NumeroLinhasAfetadas int

	SET @NovaVersao = GETDATE()


	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[Estados] SET [Descricao] = @Descricao,
									[Inativo] = @Inativo,
									[Versao] = @NovaVersao
								WHERE [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Estados]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Estados].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateUpdate].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Estados].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateUpdate].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Estados].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateUpdate].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Estados].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StateUpdate].[@Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Estados].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Estados].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateUpdate].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateUpdate].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateUpdate].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StateUpdate].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1716" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[StateUpdate]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Descricao nvarchar(50),&#xD;&#xA;&#x9;@Inativo bit,&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step1a1_DeleteIncompleteAndNotIntegratedExistingQuotations]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- variables
	DECLARE @numberOfAffectedRows integer = 0;


	-- delete incomplete quotations
	BEGIN TRY

		-- remove all not integrated quotations from the supplier received on @FornecedorCodigo
		DELETE FROM [dbo].[CotacoesNaoIntegradasView] WHERE FornecedorCodigo = @FornecedorCodigo;

		-- sum to @numberOfAffectedRows
		SET @numberOfAffectedRows += @@ROWCOUNT;



		-- remove all incomplete quotations from the supplier too
		DELETE FROM [dbo].CotacoesIncompletasView WHERE [FornecedorCodigo] = @FornecedorCodigo

		-- sum to @numberOfAffectedRows
		SET @numberOfAffectedRows += @@ROWCOUNT;



		-- fill output @info with sucess message
		SET @Info = '[Step1a1_DeleteIncompleteAndNotIntegratedExistingQuotations-01] Were removed sucessfully, ' + CAST(@numberOfAffectedRows as nvarchar) + ' not integrated and incomplete quotations of the supplier ' + @FornecedorCodigo +'.';

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step1a1_DeleteIncompleteAndNotIntegratedExistingQuotations-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesNaoIntegradasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesNaoIntegradasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step1a1_DeleteIncompleteAndNotIntegratedExistingQuotations].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step1a1_DeleteIncompleteAndNotIntegratedExistingQuotations].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step1a1_DeleteIncompleteAndNotIntegratedExistingQuotations].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step1a1_DeleteIncompleteAndNotIntegratedExistingQuotations].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="89" />
				<Property Name="Length" Value="1478" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP deletes all Incomplete and Not Integrated Quotations from database&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step1a1_DeleteIncompleteAndNotIntegratedExistingQuotations]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(20),&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2a1_Preparation_CleanAllExistingWarnings]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- CLEAN TABLE
	BEGIN TRY

		-- clean CotacoesAvisos
		TRUNCATE Table [dbo].[CotacoesAvisos]

		-- fill output @info with sucess message
		SET @Info = '[Step2a1_Preparation_CleanAllExistingWarnings-01] Limpeza com sucesso da tabela CotacoesAvisos';

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2a1_Preparation_CleanAllExistingWarnings-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' +ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAvisos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2a1_Preparation_CleanAllExistingWarnings].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2a1_Preparation_CleanAllExistingWarnings].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="64" />
				<Property Name="Length" Value="744" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP cleans all rows from CotacoesAvisos Table&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2a1_Preparation_CleanAllExistingWarnings]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2a2_Preparation_DeleteExpiredQuotations]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- clean old quotations
	BEGIN TRY

		-- remove all expired and inactive Cotacoes
		DELETE FROM [dbo].[Cotacoes] WHERE Inativo = CAST('true' as bit) AND Validade < DATEADD(MONTH, -3, GETDATE())

		-- fill output @info with sucess message
		SET @Info = '[Step2a2_Preparation_DeleteExpiredQuotations-01] Limpeza com sucesso das cotacoes inativas fora de validade (+3 meses)';

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2a2_Preparation_DeleteExpiredQuotations-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Cotacoes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[Inativo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Cotacoes].[Validade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2a2_Preparation_DeleteExpiredQuotations].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2a2_Preparation_DeleteExpiredQuotations].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="79" />
				<Property Name="Length" Value="883" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP remove from database all expired and inactive quotations&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2a2_Preparation_DeleteExpiredQuotations]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2b1a_Mappings_Addons_FeedNewRules]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- new rules feeding
	BEGIN TRY

		/*
			Feed (..)Matching table with new incomplete rules, to simplify mapping work to the user.
		*/
		INSERT [dbo].[ComplementosMatching] (FornecedorCodigo, Codigo, Descricao, MapTo, Inativo, Criacao, Versao)
	
		SELECT um.FornecedorCodigo, 
			   um.Codigo,
			   (
					-- get 1st existing description in CotacoesIncompletasView for this entity
					SELECT TOP 1 CASE WHEN ci._ComplementoDescricao IS NULL THEN '(vazio)'
									  ELSE ci._ComplementoDescricao
								 END
					FROM [dbo].[CotacoesIncompletasView] ci
					WHERE ci.FornecedorCodigo = um.FornecedorCodigo
						  AND ci._ComplementoCodigo = um.Codigo
				    ORDER BY ci._ComplementoDescricao DESC  -- prevents the existence of some _ComplementoDescricao = NULL
		      ) AS [Descricao],
			  NULL, -- MapTo will be filled later by user
			  CAST('false' as bit),
			  GETDATE(),
			  GETDATE()
		FROM
			  (
					-- un-existing but needed matching rules
					SELECT DISTINCT ci.FornecedorCodigo, ci._ComplementoCodigo AS Codigo
					FROM [dbo].[CotacoesIncompletasView] ci
					EXCEPT
					SELECT cm.FornecedorCodigo, cm.Codigo
					FROM [dbo].[ComplementosMatching] cm
			  ) um

		



		-- fill output @info with sucess message
		SET @Info = '[Step2b1a_Mappings_Addons_FeedNewRules-01] Number of created matching rules: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2b1a_Mappings_Addons_FeedNewRules-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[ComplementosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ComplementoDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2b1a_Mappings_Addons_FeedNewRules].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2b1a_Mappings_Addons_FeedNewRules].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="106" />
				<Property Name="Length" Value="1918" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP feeds Addons Matching table with new rules, considering the new incoming quotations&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2b1a_Mappings_Addons_FeedNewRules]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2b1a_Mappings_Brands_FeedNewRules]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- new rules feeding
	BEGIN TRY

		/*
			Feed (..)Matching table with new incomplete rules, to simplify mapping work to the user.
		*/

		INSERT [dbo].[MarcasMatching] (FornecedorCodigo, Codigo, Descricao, MapTo, Inativo, Criacao, Versao)
	
		SELECT um.FornecedorCodigo, 
			   um.Codigo,
			   (
					-- get 1st existing description in CotacoesIncompletasView for this entity
					SELECT TOP 1 CASE WHEN ci._MarcaDescricao IS NULL THEN '(vazio)'
									  ELSE ci._MarcaDescricao
								 END
					FROM [dbo].[CotacoesIncompletasView] ci
					WHERE ci.FornecedorCodigo = um.FornecedorCodigo
						  AND ci._MarcaCodigo = um.Codigo
				    ORDER BY ci._MarcaDescricao DESC  -- prevents the existence of some _MarcaDescricao = NULL
		      ) AS [Descricao],
			  NULL, -- MapTo will be filled later by user
			  CAST('false' as bit),
			  GETDATE(),
			  GETDATE()
		FROM
			  (
					-- un-existing but needed matching rules
					SELECT DISTINCT ci.FornecedorCodigo, ci._MarcaCodigo AS Codigo
					FROM [dbo].[CotacoesIncompletasView] ci
					EXCEPT
					SELECT mm.FornecedorCodigo, mm.Codigo
					FROM [dbo].[MarcasMatching] mm
			  ) um
		



		-- fill output @info with sucess message
		SET @Info = '[Step2b1a_Mappings_Brands_FeedNewRules-01] Number of created matching rules: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2b1a_Mappings_Brands_FeedNewRules-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[MarcasMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_MarcaDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_MarcaCodigo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2b1a_Mappings_Brands_FeedNewRules].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2b1a_Mappings_Brands_FeedNewRules].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="105" />
				<Property Name="Length" Value="1869" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP feeds MarcasMatching table with new rules, considering the new incoming quotations&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2b1a_Mappings_Brands_FeedNewRules]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2b1a_Mappings_Categories_FeedNewRules]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- new rules feeding
	BEGIN TRY

		/*
			Feed (..)Matching table with new incomplete rules, to simplify mapping work to the user.
		*/

		INSERT [dbo].[CategoriasMatching] (FornecedorCodigo, Codigo, Descricao, MapTo, Inativo, Criacao, Versao)
	
		SELECT um.FornecedorCodigo, 
			   um.Codigo,
			   (
					-- get 1st existing description in CotacoesIncompletasView for this entity
					SELECT TOP 1 CASE WHEN ci._CategoriaDescricao IS NULL THEN '(vazio)'
									  ELSE ci._CategoriaDescricao
								 END
					FROM [dbo].[CotacoesIncompletasView] ci
					WHERE ci.FornecedorCodigo = um.FornecedorCodigo
						  AND ci._CategoriaCodigo = um.Codigo
				    ORDER BY ci._CategoriaDescricao DESC  -- prevents the existence of some _CategoriaDescricao = NULL
		      ) AS [Descricao],
			  NULL, -- MapTo will be filled later by user
			  CAST('false' as bit),
			  GETDATE(),
			  GETDATE()
		FROM
			  (
					-- un-existing but needed matching rules
					SELECT DISTINCT ci.FornecedorCodigo, ci._CategoriaCodigo AS Codigo
					FROM [dbo].[CotacoesIncompletasView] ci
					EXCEPT
					SELECT tm.FornecedorCodigo, tm.Codigo
					FROM [dbo].[CategoriasMatching] tm
			  ) um
		



		-- fill output @info with sucess message
		SET @Info = '[Step2b1a_Mappings_Categories_FeedNewRules-01] Number of created matching rules: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2b1a_Mappings_Categories_FeedNewRules-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CategoriasMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_CategoriaDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2b1a_Mappings_Categories_FeedNewRules].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2b1a_Mappings_Categories_FeedNewRules].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="109" />
				<Property Name="Length" Value="1917" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP feeds CategoriesMatching table with new rules, considering the new incoming quotations&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2b1a_Mappings_Categories_FeedNewRules]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2b1a_Mappings_Statuses_FeedNewRules]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- new rules feeding
	BEGIN TRY

		/*
			Feed (..)Matching table with new incomplete rules, to simplify mapping work to the user.
		*/
		INSERT [dbo].[EstadosMatching] (FornecedorCodigo, Codigo, Descricao, MapTo, Inativo, Criacao, Versao)
	
		SELECT um.FornecedorCodigo, 
			   um.Codigo,
			   (
					-- get 1st existing description in CotacoesIncompletasView for this entity
					SELECT TOP 1 CASE WHEN ci._EstadoDescricao IS NULL THEN '(vazio)'
									  ELSE ci._EstadoDescricao
								 END
					FROM [dbo].[CotacoesIncompletasView] ci
					WHERE ci.FornecedorCodigo = um.FornecedorCodigo
						  AND ci._EstadoCodigo = um.Codigo
				    ORDER BY ci._EstadoDescricao DESC  -- prevents the existence of some _EstadoDescricao = NULL
		      ) AS [Descricao],
			  NULL, -- MapTo will be filled later by user
			  CAST('false' as bit),
			  GETDATE(),
			  GETDATE()
		FROM
			  (
					-- un-existing but needed matching rules
					SELECT DISTINCT ci.FornecedorCodigo, ci._EstadoCodigo AS Codigo
					FROM [dbo].[CotacoesIncompletasView] ci
					EXCEPT
					SELECT dm.FornecedorCodigo, dm.Codigo
					FROM [dbo].[EstadosMatching] dm
			  ) um

		



		-- fill output @info with sucess message
		SET @Info = '[Step2b1a_Mappings_Statuses_FeedNewRules-01] Number of created matching rules: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2b1a_Mappings_Statuses_FeedNewRules-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[EstadosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_EstadoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_EstadoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_EstadoDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_EstadoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_EstadoCodigo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2b1a_Mappings_Statuses_FeedNewRules].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2b1a_Mappings_Statuses_FeedNewRules].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="108" />
				<Property Name="Length" Value="1886" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP feeds Statuses Matching table with new rules, considering the new incoming quotations&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2b1a_Mappings_Statuses_FeedNewRules]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2b1a_Mappings_Stocks_FeedNewRules]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- new rules feeding
	BEGIN TRY

		/*
			Feed (..)Matching table with new incomplete rules, to simplify mapping work to the user.
		*/

		INSERT [dbo].[StocksMatching] (FornecedorCodigo, Codigo, Descricao, MapTo, Inativo, Criacao, Versao)
	
		SELECT um.FornecedorCodigo, 
			   um.Codigo,
			   (
					-- get 1st existing description in CotacoesIncompletasView for this entity
					SELECT TOP 1 CASE WHEN ci._StockDescricao IS NULL THEN '(vazio)'
									  ELSE ci._StockDescricao
								 END
					FROM [dbo].[CotacoesIncompletasView] ci
					WHERE ci.FornecedorCodigo = um.FornecedorCodigo
						  AND ci._StockCodigo = um.Codigo
				    ORDER BY ci._StockDescricao DESC  -- prevents the existence of some _StockDescricao = NULL
		      ) AS [Descricao],
			  NULL, -- MapTo will be filled later by user
			  CAST('false' as bit),
			  GETDATE(),
			  GETDATE()
		FROM
			  (
					-- un-existing but needed matching rules
					SELECT DISTINCT ci.FornecedorCodigo, ci._StockCodigo AS Codigo
					FROM [dbo].[CotacoesIncompletasView] ci
					EXCEPT
					SELECT sm.FornecedorCodigo, sm.Codigo
					FROM [dbo].[StocksMatching] sm
			  ) um
		



		-- fill output @info with sucess message
		SET @Info = '[Step2b1a_Mappings_Stocks_FeedNewRules-01] Number of created matching rules: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2b1a_Mappings_Stocks_FeedNewRules-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[StocksMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_StockDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_StockCodigo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2b1a_Mappings_Stocks_FeedNewRules].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2b1a_Mappings_Stocks_FeedNewRules].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="105" />
				<Property Name="Length" Value="1869" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP feeds StocksMatching table with new rules, considering the new incoming quotations&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2b1a_Mappings_Stocks_FeedNewRules]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2b1a_Mappings_Taxes_FeedNewRules]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- new rules feeding
	BEGIN TRY

		/*
			Feed (..)Matching table with new incomplete rules, to simplify mapping work to the user.
		*/

		INSERT [dbo].[ImpostosMatching] (FornecedorCodigo, Codigo, Descricao, MapTo, Inativo, Criacao, Versao)
	
		SELECT um.FornecedorCodigo, 
			   um.Codigo,
			   (
					-- get 1st existing description in CotacoesIncompletasView for this entity
					SELECT TOP 1 CASE WHEN ci._ImpostoDescricao IS NULL THEN '(vazio)'
									  ELSE ci._ImpostoDescricao
								 END
					FROM [dbo].[CotacoesIncompletasView] ci
					WHERE ci.FornecedorCodigo = um.FornecedorCodigo
						  AND ci._ImpostoCodigo = um.Codigo
				    ORDER BY ci._ImpostoDescricao DESC  -- prevents the existence of some _ImpostoDescricao = NULL
		      ) AS [Descricao],
			  NULL, -- MapTo will be filled later by user
			  CAST('false' as bit),
			  GETDATE(),
			  GETDATE()
		FROM
			  (
					-- un-existing but needed matching rules
					SELECT DISTINCT ci.FornecedorCodigo, ci._ImpostoCodigo AS Codigo
					FROM [dbo].[CotacoesIncompletasView] ci
					EXCEPT
					SELECT im.FornecedorCodigo, im.Codigo
					FROM [dbo].[ImpostosMatching] im
			  ) um
		



		-- fill output @info with sucess message
		SET @Info = '[Step2b1a_Mappings_Taxes_FeedNewRules-01] Number of created matching rules: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2b1a_Mappings_Taxes_FeedNewRules-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[ImpostosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ImpostoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ImpostoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ImpostoDescricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ImpostoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ImpostoCodigo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2b1a_Mappings_Taxes_FeedNewRules].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2b1a_Mappings_Taxes_FeedNewRules].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="105" />
				<Property Name="Length" Value="1882" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP feeds Taxes Matching table with new rules, considering the new incoming quotations&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2b1a_Mappings_Taxes_FeedNewRules]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2b1b_Mappings_Addons_Map]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- begin matching
	BEGIN TRY

		/*
			Map entities considering (..)Matching rules.
		*/
		UPDATE [dbo].[CotacoesIncompletasView]
		SET ComplementoCodigo = cm.MapTo,
			Versao = GETDATE()

		/*  Using (..)IncompletasView I am assuring that I'm only working with Cotacoes where Inactivo='false' and Completo='false'
			(although, with this mapping lack, never the quotation whould be completed - so this control is redundant)
		*/
		FROM [dbo].[CotacoesIncompletasView] ci
			INNER JOIN [dbo].[ComplementosMatching] cm
				ON ci.FornecedorCodigo = cm.FornecedorCodigo
					AND ci._ComplementoCodigo = cm.Codigo

		-- filter only active matching rules with MapTo already settled, and not mapped incomplete quotations
		WHERE cm.Inativo = CAST('false' as bit)
			  AND ci.ComplementoCodigo IS NULL
			  AND cm.MapTo IS NOT NULL



		-- fill output @info with sucess message
		SET @Info = '[Step2b1b_Mappings_Addons_Map-01] Number of mapped quotations: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2b1b_Mappings_Addons_Map-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2b1b_Mappings_Addons_Map].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2b1b_Mappings_Addons_Map].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="72" />
				<Property Name="Length" Value="1473" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP, perform Addons Mapping of incomplete Quotations.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2b1b_Mappings_Addons_Map]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2b1b_Mappings_Brands_Map]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- begin matching
	BEGIN TRY

		/*
			Map entities considering (..)Matching rules.
		*/
		UPDATE [dbo].[CotacoesIncompletasView]
		SET MarcaCodigo = mm.MapTo,
			Versao = GETDATE()

		/*  Using (..)IncompletasView I am assuring that I'm only working with Cotacoes where Inactivo='false' and Completo='false'
			(although, with this mapping lack, never the quotation whould be completed - so this control is redundant)
		*/
		FROM [dbo].[CotacoesIncompletasView] ci
			INNER JOIN [dbo].[MarcasMatching] mm
				ON ci.FornecedorCodigo = mm.FornecedorCodigo
					AND ci._MarcaCodigo = mm.Codigo

		-- filter only active matching rules with MapTo already settled, and not mapped incomplete quotations
		WHERE mm.Inativo = CAST('false' as bit)
			  AND ci.MarcaCodigo IS NULL
			  AND mm.MapTo IS NOT NULL



		-- fill output @info with sucess message
		SET @Info = '[Step2b1b_Mappings_Brands_Map-01] Number of mapped quotations: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2b1b_Mappings_Brands_Map-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2b1b_Mappings_Brands_Map].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2b1b_Mappings_Brands_Map].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="71" />
				<Property Name="Length" Value="1448" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP, perform Brand Mapping of incomplete Quotations.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2b1b_Mappings_Brands_Map]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2b1b_Mappings_Categories_Map]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- begin matching
	BEGIN TRY

		/*
			Map entities considering (..)Matching rules.
		*/
		UPDATE [dbo].[CotacoesIncompletasView]
		SET CategoriaCodigo = tm.MapTo,
			Versao = GETDATE()

		/*  Using (..)IncompletasView I am assuring that I'm only working with Cotacoes where Inactivo='false' and Completo='false'
			(although, with this mapping lack, never the quotation whould be completed - so this control is redundant)
		*/
		FROM [dbo].[CotacoesIncompletasView] ci
			INNER JOIN [dbo].[CategoriasMatching] tm
				ON ci.FornecedorCodigo = tm.FornecedorCodigo
					AND ci._CategoriaCodigo = tm.Codigo

		-- filter only active matching rules with MapTo already settled, and not mapped incomplete quotations
		WHERE tm.Inativo = CAST('false' as bit)
			  AND ci.CategoriaCodigo IS NULL
			  AND tm.MapTo IS NOT NULL



		-- fill output @info with sucess message
		SET @Info = '[Step2b1b_Mappings_Categories_Map-01] Number of mapped quotations: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2b1b_Mappings_Categories_Map-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2b1b_Mappings_Categories_Map].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2b1b_Mappings_Categories_Map].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="74" />
				<Property Name="Length" Value="1479" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP, perform Category Mapping of incomplete Quotations.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2b1b_Mappings_Categories_Map]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2b1b_Mappings_Statuses_Map]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- begin matching
	BEGIN TRY

		/*
			Map entities considering (..)Matching rules.
		*/
		UPDATE [dbo].[CotacoesIncompletasView]
		SET EstadoCodigo = dm.MapTo,
			Versao = GETDATE()

		/*  Using (..)IncompletasView I am assuring that I'm only working with Cotacoes where Inactivo='false' and Completo='false'
			(although, with this mapping lack, never the quotation whould be completed - so this control is redundant)
		*/
		FROM [dbo].[CotacoesIncompletasView] ci
			INNER JOIN [dbo].[EstadosMatching] dm
				ON ci.FornecedorCodigo = dm.FornecedorCodigo
					AND ci._EstadoCodigo = dm.Codigo

		-- filter only active matching rules with MapTo already settled, and not mapped incomplete quotations
		WHERE dm.Inativo = CAST('false' as bit)
			  AND ci.EstadoCodigo IS NULL
			  AND dm.MapTo IS NOT NULL



		-- fill output @info with sucess message
		SET @Info = '[Step2b1b_Mappings_Statuses_Map-01] Number of mapped quotations: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2b1b_Mappings_Statuses_Map-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_EstadoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[EstadoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[EstadoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2b1b_Mappings_Statuses_Map].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2b1b_Mappings_Statuses_Map].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="74" />
				<Property Name="Length" Value="1461" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP, perform Statuses Mapping of incomplete Quotations.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2b1b_Mappings_Statuses_Map]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2b1b_Mappings_Stocks_Map]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- begin matching
	BEGIN TRY

		/*
			Map entities considering (..)Matching rules.
		*/
		UPDATE [dbo].[CotacoesIncompletasView]
		SET StockCodigo = sm.MapTo,
			Versao = GETDATE()

		/*  Using (..)IncompletasView I am assuring that I'm only working with Cotacoes where Inactivo='false' and Completo='false'
			(although, with this mapping lack, never the quotation whould be completed - so this control is redundant)
		*/
		FROM [dbo].[CotacoesIncompletasView] ci
			INNER JOIN [dbo].[StocksMatching] sm
				ON ci.FornecedorCodigo = sm.FornecedorCodigo
					AND ci._StockCodigo = sm.Codigo

		-- filter only active matching rules with MapTo already settled, and not mapped incomplete quotations
		WHERE sm.Inativo = CAST('false' as bit)
			  AND ci.StockCodigo IS NULL
			  AND sm.MapTo IS NOT NULL



		-- fill output @info with sucess message
		SET @Info = '[Step2b1b_Mappings_Stocks_Map-01] Number of mapped quotations: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2b1b_Mappings_Stocks_Map-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2b1b_Mappings_Stocks_Map].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2b1b_Mappings_Stocks_Map].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="71" />
				<Property Name="Length" Value="1448" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP, perform Stock Mapping of incomplete Quotations.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2b1b_Mappings_Stocks_Map]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2b1b_Mappings_Taxes_Map]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- begin matching
	BEGIN TRY

		/*
			Map entities considering (..)Matching rules.
		*/
		UPDATE [dbo].[CotacoesIncompletasView]
		SET ImpostoCodigo = im.MapTo,
			Versao = GETDATE()

		/*  Using (..)IncompletasView I am assuring that I'm only working with Cotacoes where Inactivo='false' and Completo='false'
			(although, with this mapping lack, never the quotation whould be completed - so this control is redundant)
		*/
		FROM [dbo].[CotacoesIncompletasView] ci
			INNER JOIN [dbo].[ImpostosMatching] im
				ON ci.FornecedorCodigo = im.FornecedorCodigo
					AND ci._ImpostoCodigo = im.Codigo

		-- filter only active matching rules with MapTo already settled, and not mapped incomplete quotations
		WHERE im.Inativo = CAST('false' as bit)
			  AND ci.ImpostoCodigo IS NULL
			  AND im.MapTo IS NOT NULL



		-- fill output @info with sucess message
		SET @Info = '[Step2b1b_Mappings_Taxes_Map-01] Number of mapped quotations: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2b1b_Mappings_Taxes_Map-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ImpostoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[ImpostoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[ImpostoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2b1b_Mappings_Taxes_Map].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2b1b_Mappings_Taxes_Map].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="71" />
				<Property Name="Length" Value="1453" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP, perform Taxes Mapping of incomplete Quotations.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2b1b_Mappings_Taxes_Map]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2b1c_Mappings_Addons_Notifications]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- insert notifications on CotacoesAvisos table
	BEGIN TRY

		/*
			Insert notifications rows for all incomplete quotations that remain unmapped
		*/
		INSERT INTO [dbo].[CotacoesAvisos] 
				    (Id, FornecedorCodigo, Data, _ProdutoCodigo, _ComplementoCodigo, AvisoTipoCodigo, Descricao, Criacao)

		SELECT NEWID(), 
			   ci.FornecedorCodigo,
			   ci.Data,
			   ci._ProdutoCodigo,
			   ci._ComplementoCodigo,
			   CASE WHEN cm.Inativo = CAST('true' as bit) THEN 'CICM1' -- inactive mapping rule
					ELSE 'CICM0'									   -- incomplete mapping rule
			   END AS AvisoTipoCodigo,
			   'verifique regra de matching!' AS Descricao,
			   GETDATE() AS Criacao

		FROM [dbo].[CotacoesIncompletasView] ci
			 INNER JOIN [dbo].[ComplementosMatching] cm
				ON ci.FornecedorCodigo = cm.FornecedorCodigo
					AND ci._ComplementoCodigo = cm.Codigo

		-- filter all quotations not yet mapped after the mapping occurrence
		WHERE ci.ComplementoCodigo IS NULL



		-- fill output @info with sucess message
		SET @Info = '[Step2b1c_Mappings_Addons_Notifications-01] Number of inserted notifications: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2b1c_Mappings_Addons_Notifications-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAvisos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Id]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[AvisoTipoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2b1c_Mappings_Addons_Notifications].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2b1c_Mappings_Addons_Notifications].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="133" />
				<Property Name="Length" Value="1706" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP makes sure that user is notified via CotacoesAvisos table, that something &#xD;&#xA;&#x9;wrong happened in the mapping task.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2b1c_Mappings_Addons_Notifications]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2b1c_Mappings_Brands_Notifications]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- insert notifications on CotacoesAvisos table
	BEGIN TRY

		/*
			Insert notifications rows for all incomplete quotations that remain unmapped
		*/
		INSERT INTO [dbo].[CotacoesAvisos] 
				    (Id, FornecedorCodigo, Data, _ProdutoCodigo, _ComplementoCodigo, AvisoTipoCodigo, Descricao, Criacao)

		SELECT NEWID(), 
			   ci.FornecedorCodigo,
			   ci.Data,
			   ci._ProdutoCodigo,
			   ci._ComplementoCodigo,
			   CASE WHEN mm.Inativo = CAST('true' as bit) THEN 'CIMM1' -- inactive mapping rule
					ELSE 'CIMM0'									   -- incomplete mapping rule
			   END AS AvisoTipoCodigo,
			   'verifique regra de matching!' AS Descricao,
			   GETDATE() AS Criacao

		FROM [dbo].[CotacoesIncompletasView] ci
			 INNER JOIN [dbo].[MarcasMatching] mm
				ON ci.FornecedorCodigo = mm.FornecedorCodigo
					AND ci._MarcaCodigo = mm.Codigo

		-- filter all quotations not yet mapped after the mapping occurrence
		WHERE ci.MarcaCodigo IS NULL



		-- fill output @info with sucess message
		SET @Info = '[Step2b1c_Mappings_Brands_Notifications-01] Number of inserted notifications: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2b1c_Mappings_Brands_Notifications-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAvisos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Id]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[AvisoTipoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[MarcasMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2b1c_Mappings_Brands_Notifications].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2b1c_Mappings_Brands_Notifications].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="133" />
				<Property Name="Length" Value="1688" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP makes sure that user is notified via CotacoesAvisos table, that something &#xD;&#xA;&#x9;wrong happened in the mapping task.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2b1c_Mappings_Brands_Notifications]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2b1c_Mappings_Categories_Notifications]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- insert notifications on CotacoesAvisos table
	BEGIN TRY

		/*
			Insert notifications rows for all incomplete quotations that remain unmapped
		*/
		INSERT INTO [dbo].[CotacoesAvisos] 
				    (Id, FornecedorCodigo, Data, _ProdutoCodigo, _ComplementoCodigo, AvisoTipoCodigo, Descricao, Criacao)

		SELECT NEWID(), 
			   ci.FornecedorCodigo,
			   ci.Data,
			   ci._ProdutoCodigo,
			   ci._ComplementoCodigo,
			   CASE WHEN tm.Inativo = CAST('true' as bit) THEN 'CITM1' -- inactive mapping rule
					ELSE 'CITM0'									   -- incomplete mapping rule
			   END AS AvisoTipoCodigo,
			   'verifique regra de matching!' AS Descricao,
			   GETDATE() AS Criacao

		FROM [dbo].[CotacoesIncompletasView] ci
			 INNER JOIN [dbo].[CategoriasMatching] tm
				ON ci.FornecedorCodigo = tm.FornecedorCodigo
					AND ci._CategoriaCodigo = tm.Codigo

		-- filter all quotations not yet mapped after the mapping occurrence
		WHERE ci.CategoriaCodigo IS NULL



		-- fill output @info with sucess message
		SET @Info = '[Step2b1c_Mappings_Categories_Notifications-01] Number of inserted notifications: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2b1c_Mappings_Categories_Notifications-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAvisos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Id]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[AvisoTipoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CategoriasMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2b1c_Mappings_Categories_Notifications].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2b1c_Mappings_Categories_Notifications].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="133" />
				<Property Name="Length" Value="1712" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP makes sure that user is notified via CotacoesAvisos table, that something &#xD;&#xA;&#x9;wrong happened in the mapping task.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2b1c_Mappings_Categories_Notifications]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2b1c_Mappings_Statuses_Notifications]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- insert notifications on CotacoesAvisos table
	BEGIN TRY

		/*
			Insert notifications rows for all incomplete quotations that remain unmapped
		*/
		INSERT INTO [dbo].[CotacoesAvisos] 
				    (Id, FornecedorCodigo, Data, _ProdutoCodigo, _ComplementoCodigo, AvisoTipoCodigo, Descricao, Criacao)

		SELECT NEWID(), 
			   ci.FornecedorCodigo,
			   ci.Data,
			   ci._ProdutoCodigo,
			   ci._ComplementoCodigo,
			   CASE WHEN dm.Inativo = CAST('true' as bit) THEN 'CIDM1' -- inactive mapping rule
					ELSE 'CIDM0'									   -- incomplete mapping rule
			   END AS AvisoTipoCodigo,
			   'verifique regra de matching!' AS Descricao,
			   GETDATE() AS Criacao

		FROM [dbo].[CotacoesIncompletasView] ci
			 INNER JOIN [dbo].[EstadosMatching] dm
				ON ci.FornecedorCodigo = dm.FornecedorCodigo
					AND ci._EstadoCodigo = dm.Codigo

		-- filter all quotations not yet mapped after the mapping occurrence
		WHERE ci.EstadoCodigo IS NULL



		-- fill output @info with sucess message
		SET @Info = '[Step2b1c_Mappings_Statuses_Notifications-01] Number of inserted notifications: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2b1c_Mappings_Statuses_Notifications-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAvisos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Id]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[AvisoTipoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_EstadoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[EstadosMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[EstadoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2b1c_Mappings_Statuses_Notifications].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2b1c_Mappings_Statuses_Notifications].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="133" />
				<Property Name="Length" Value="1697" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP makes sure that user is notified via CotacoesAvisos table, that something &#xD;&#xA;&#x9;wrong happened in the mapping task.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2b1c_Mappings_Statuses_Notifications]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2b1c_Mappings_Stocks_Notifications]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- insert notifications on CotacoesAvisos table
	BEGIN TRY

		/*
			Insert notifications rows for all incomplete quotations that remain unmapped
		*/
		INSERT INTO [dbo].[CotacoesAvisos] 
				    (Id, FornecedorCodigo, Data, _ProdutoCodigo, _ComplementoCodigo, AvisoTipoCodigo, Descricao, Criacao)

		SELECT NEWID(), 
			   ci.FornecedorCodigo,
			   ci.Data,
			   ci._ProdutoCodigo,
			   ci._ComplementoCodigo,
			   CASE WHEN sm.Inativo = CAST('true' as bit) THEN 'CISM1' -- inactive mapping rule
					ELSE 'CISM0'									   -- incomplete mapping rule
			   END AS AvisoTipoCodigo,
			   'verifique regra de matching!' AS Descricao,
			   GETDATE() AS Criacao

		FROM [dbo].[CotacoesIncompletasView] ci
			 INNER JOIN [dbo].[StocksMatching] sm
				ON ci.FornecedorCodigo = sm.FornecedorCodigo
					AND ci._StockCodigo = sm.Codigo

		-- filter all quotations not yet mapped after the mapping occurrence
		WHERE ci.StockCodigo IS NULL



		-- fill output @info with sucess message
		SET @Info = '[Step2b1c_Mappings_Stocks_Notifications-01] Number of inserted notifications: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2b1c_Mappings_Stocks_Notifications-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAvisos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Id]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[AvisoTipoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2b1c_Mappings_Stocks_Notifications].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2b1c_Mappings_Stocks_Notifications].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="133" />
				<Property Name="Length" Value="1688" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP makes sure that user is notified via CotacoesAvisos table, that something &#xD;&#xA;&#x9;wrong happened in the mapping task.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2b1c_Mappings_Stocks_Notifications]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2b1c_Mappings_Taxes_Notifications]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- insert notifications on CotacoesAvisos table
	BEGIN TRY

		/*
			Insert notifications rows for all incomplete quotations that remain unmapped
		*/
		INSERT INTO [dbo].[CotacoesAvisos] 
				    (Id, FornecedorCodigo, Data, _ProdutoCodigo, _ComplementoCodigo, AvisoTipoCodigo, Descricao, Criacao)

		SELECT NEWID(), 
			   ci.FornecedorCodigo,
			   ci.Data,
			   ci._ProdutoCodigo,
			   ci._ComplementoCodigo,
			   CASE WHEN im.Inativo = CAST('true' as bit) THEN 'CIIM1' -- inactive mapping rule
					ELSE 'CIIM0'									   -- incomplete mapping rule
			   END AS AvisoTipoCodigo,
			   'verifique regra de matching!' AS Descricao,
			   GETDATE() AS Criacao

		FROM [dbo].[CotacoesIncompletasView] ci
			 INNER JOIN [dbo].[ImpostosMatching] im
				ON ci.FornecedorCodigo = im.FornecedorCodigo
					AND ci._ImpostoCodigo = im.Codigo

		-- filter all quotations not yet mapped after the mapping occurrence
		WHERE ci.ImpostoCodigo IS NULL



		-- fill output @info with sucess message
		SET @Info = '[Step2b1c_Mappings_Taxes_Notifications-01] Number of inserted notifications: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2b1c_Mappings_Taxes_Notifications-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAvisos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Id]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[AvisoTipoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ImpostoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[ImpostoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2b1c_Mappings_Taxes_Notifications].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2b1c_Mappings_Taxes_Notifications].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="133" />
				<Property Name="Length" Value="1691" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP makes sure that user is notified via CotacoesAvisos table, that something &#xD;&#xA;&#x9;wrong happened in the mapping task.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2b1c_Mappings_Taxes_Notifications]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2b1z_QuotationRules_FeedNewRules]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- new rules feeding
	BEGIN TRY

		/*
			Feed CotacoesRegras table with new incomplete rules. 
			Consider only Quotations that are already mapped.
		*/
		
		INSERT [dbo].[CotacoesRegras] (FornecedorCodigo, MarcaCodigo, CategoriaCodigo, StockCodigo, HorasValidade, StockCodigoSubstituto, DataReset, Notas, Versao)

		SELECT um.FornecedorCodigo, 
			   um.MarcaCodigo,
			   um.CategoriaCodigo,
			   um.StockCodigo, 
			   f.HorasValidadeSugestao,
			   NULL,
			   NULL,
			   NULL,
			   GETDATE()

		FROM
			  (
					-- un-existing but needed Quotation Rules (CotacoesRegras)
					SELECT DISTINCT ci.FornecedorCodigo, ci.MarcaCodigo, CategoriaCodigo, StockCodigo
					FROM [dbo].[CotacoesIncompletasView] ci
					WHERE MarcaCodigo IS NOT NULL
						  AND CategoriaCodigo IS NOT NULL
						  AND StockCodigo IS NOT NULL
						  AND ImpostoCodigo IS NOT NULL
						  AND ComplementoCodigo IS NOT NULL
						  AND EstadoCodigo IS NOT NULL

					EXCEPT

					SELECT cr.FornecedorCodigo, cr.MarcaCodigo, cr.CategoriaCodigo, cr.StockCodigo
					FROM [dbo].[CotacoesRegras] cr
			  ) um

			INNER JOIN [dbo].[Fornecedores] f
				ON um.FornecedorCodigo = f.Codigo



		-- fill output @info with sucess message
		SET @Info = '[Step2b1z_QuotationRules_FeedNewRules-01] Number of created rules: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2b1z_QuotationRules_FeedNewRules-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesRegras]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[HorasValidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[StockCodigoSubstituto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[DataReset]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[ImpostoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[EstadoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasView].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[HorasValidadeSugestao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2b1z_QuotationRules_FeedNewRules].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2b1z_QuotationRules_FeedNewRules].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="126" />
				<Property Name="Length" Value="1900" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP feeds Quotations Rues (CotacoesRegras) table with new rules, considering the new just mapped quotations&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2b1z_QuotationRules_FeedNewRules]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2c1_MappingProducts_FeedNewRules]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- new rules feeding
	BEGIN TRY

		/*
			Feed (..)Matching table with new incomplete rules, to simplify mapping work to the user or to be automatically mapped later.
		*/
		INSERT [dbo].[ProdutosMatching] (FornecedorCodigo, ComplementoCodigo, Codigo, Descricao, MapTo, 
			   HorasValidadeCotacao, StockCodigoSubstituto, DispensaPrevencaoPrecosDesfasados, DispensaPrevencaoFalsoStock, DataReset, Notas,
			   Inativo, Criacao, Versao)

		SELECT um.FornecedorCodigo,
			   um.ComplementoCodigo, 
			   um.Codigo,
			   (
					-- get 1st existing description in CotacoesIncompletasMapeamentoProdutoView for this product
					SELECT TOP 1 CASE WHEN ci._Descricao IS NULL THEN '(vazio)'
									  ELSE ci._Descricao
								 END
					FROM [dbo].[CotacoesIncompletasMapeamentoProdutoView] ci
					WHERE ci.FornecedorCodigo = um.FornecedorCodigo
						  AND ci.ComplementoCodigo = um.ComplementoCodigo
						  AND ci._ProdutoCodigo = um.Codigo
				    ORDER BY ci._Descricao DESC  -- prevents the existence of some _Descricao = NULL
		      ) AS [Descricao],
			  NULL,		-- MapTo will be filled later by user or automatic next in the algorithm (specific to products)
			  NULL,		-- this null means that prevails the rules defined on CotacoesRegras. (to automatic set as inative all quotations for this supplier / product, set this value to -1)
			  NULL,		-- use this field if you want to specify a stock position directly to the product. this rule prevails to CotacoesRegras rules
			  CAST('false' as bit),	-- by default all products must be tested to offset prices.
			  CAST('false' as bit),	-- by default all products must be tested on FakeStock prevention
			  NULL,		-- Date to auto reset this custom definitions
			  NULL,
			  CAST('false' as bit),
			  GETDATE(),
			  GETDATE()
		FROM
			  (
					-- un-existing but needed matching rules
					SELECT DISTINCT ci.FornecedorCodigo, ci.ComplementoCodigo, ci._ProdutoCodigo AS Codigo
					FROM [dbo].[CotacoesIncompletasMapeamentoProdutoView] ci
					EXCEPT
					SELECT pm.FornecedorCodigo, pm.ComplementoCodigo, pm.Codigo
					FROM [dbo].[ProdutosMatching] pm
			  ) um



		-- fill output @info with sucess message
		SET @Info = '[Step2c1_MappingProducts_FeedNewRules-01] Number of created matching rules: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2c1_MappingProducts_FeedNewRules-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[ProdutosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[HorasValidadeCotacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[StockCodigoSubstituto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[DispensaPrevencaoPrecosDesfasados]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[DispensaPrevencaoFalsoStock]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[DataReset]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2c1_MappingProducts_FeedNewRules].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2c1_MappingProducts_FeedNewRules].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="191" />
				<Property Name="Length" Value="2941" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP feeds Products Matching rules (ProdutosMatching) with new rules to be filled manually by user&#xD;&#xA;&#x9;or automatic (specific to products matching) later in algorithm process.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2c1_MappingProducts_FeedNewRules]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2c2_MappingProducts_InsertNewProducts]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- new rules feeding
	BEGIN TRY

		/*
			Insert new Products
		*/
		INSERT [dbo].[Produtos] 
			   (
					Codigo, MarcaCodigo, CategoriaCodigo, ImpostoCodigo, FornecedorCodigo, Partnumber, Descricao,
					Descontinuado, Inativo, Criacao, Versao
			   )

		SELECT Referencia, MarcaCodigo, CategoriaCodigo, ImpostoCodigo, FornecedorCodigo, Partnumber, '(' + Partnumber + ')',
		       CAST('false' as bit), CAST('false' as bit), GETDATE(), GETDATE()
		FROM [dbo].[CotacoesMatrizCriacaoProdutosView]



		-- fill output @info with sucess message
		SET @Info = '[Step2c2_MappingProducts_InsertNewProducts-01] Number of created products: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2c2_MappingProducts_InsertNewProducts-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Produtos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[ImpostoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Descontinuado]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesMatrizCriacaoProdutosView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[Referencia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[CategoriaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[ImpostoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesMatrizCriacaoProdutosView].[Partnumber]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2c2_MappingProducts_InsertNewProducts].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2c2_MappingProducts_InsertNewProducts].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="91" />
				<Property Name="Length" Value="1196" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP create new Products based on new quotations received from suppliers.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2c2_MappingProducts_InsertNewProducts]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2c3_MappingProducts_FillMapTo]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- begin fill MapTo fields of ProdutosMatching tasble
	BEGIN TRY

		/*
			begin automatic fill of MapTo fields
		*/
		UPDATE [dbo].[ProdutosMatching]
		SET MapTo = c.Referencia,
			Versao = GETDATE()

		/*  CotacoesMatrizPreenchimentoMapToView ensures that only suppliers autorized to automatic Matching are considered int this process
		    and only existing products (in products table) are setted.
		*/
		FROM [dbo].[ProdutosMatching] pm
			 INNER JOIN [dbo].[CotacoesMatrizPreenchimentoMapToView] c
				ON pm.FornecedorCodigo = c.FornecedorCodigo
				   AND pm.ComplementoCodigo = c.ComplementoCodigo
				   AND pm.Codigo = c._ProdutoCodigo

		-- filter only matching rules with a not set MapTo
		WHERE pm.MapTo IS NULL



		-- fill output @info with sucess message
		SET @Info = '[Step2c3_MappingProducts_FillMapTo-01] Number of ProdutosMatching, filled with a MapTo: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2c3_MappingProducts_FillMapTo-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[ProdutosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesMatrizPreenchimentoMapToView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesMatrizPreenchimentoMapToView].[Referencia]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2c3_MappingProducts_FillMapTo].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2c3_MappingProducts_FillMapTo].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="113" />
				<Property Name="Length" Value="1448" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP, fills the MapTo field of de ProdutosMatching of suppliers autorized to automatic mapping.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2c3_MappingProducts_FillMapTo]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2c4_MappingProducts_Map]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- begin matching
	BEGIN TRY

		/*
			Map entities considering ProdutosMatching rules.
		*/
		UPDATE ci
		SET ProdutoCodigo = pm.MapTo,
			Versao = GETDATE()

		/*  Using CotacoesIncompletasMapeamentoProdutoView, I am assuring that I'm only working with Cotacoes where Inactivo='false' and Completo='false'
			(although, with this mapping lack, never the quotation whould be completed - so this control is redundant)
		*/
		FROM [dbo].[CotacoesIncompletasMapeamentoProdutoView] ci
			INNER JOIN [dbo].[ProdutosMatching] pm
				ON ci.FornecedorCodigo = pm.FornecedorCodigo
				   AND ci.ComplementoCodigo = pm.ComplementoCodigo
				   AND ci._ProdutoCodigo = pm.Codigo
			INNER JOIN [dbo].[Fornecedores] f
				ON ci.FornecedorCodigo = f.Codigo

		-- filter only active matching rules with MapTo already settled, and not mapped incomplete quotations
		WHERE pm.Inativo = CAST('false' as bit)
			  AND pm.MapTo IS NOT NULL
			  AND f.ProdutosMatchingAutomatico = CAST('true' as bit)



		-- fill output @info with sucess message
		SET @Info = '[Step2c4_MappingProducts_Map-01] Number of mapped quotations: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2c4_MappingProducts_Map-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ProdutosMatchingAutomatico]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2c4_MappingProducts_Map].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2c4_MappingProducts_Map].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="73" />
				<Property Name="Length" Value="1630" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP, perform Product Mapping of incomplete Quotations.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2c4_MappingProducts_Map]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2c5_MappingProducts_Notifications1]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- insert notifications on CotacoesAvisos table
	BEGIN TRY

		/*
			Insert notifications rows for all incomplete quotations that remain unmapped
		*/
		INSERT INTO [dbo].[CotacoesAvisos] 
				    (Id, FornecedorCodigo, Data, _ProdutoCodigo, _ComplementoCodigo, AvisoTipoCodigo, Descricao, Criacao)

		SELECT NEWID(), 
			   ci.FornecedorCodigo,
			   ci.Data,
			   ci._ProdutoCodigo,
			   ci._ComplementoCodigo,
			   
			   CASE WHEN pm.Inativo = CAST('true' as bit) THEN 'CIPM1'															-- rule mapping inactive
			        WHEN pm.Inativo = CAST('false' as bit) AND f.ProdutosCriacaoAutomatica = CAST('false' as bit) THEN 'CIPM2'	-- supplier can not insert products..
					WHEN pm.Inativo = CAST('false' as bit) AND f.ProdutosMatchingAutomatico = CAST('false' as bit) THEN 'CIPM3'	-- supplier can not do automatic matching
					ELSE 'CIPM0'																								-- mapping rule is incomplete (misses MapTo)
			   END AS AvisoTipoCodigo,

			   'verifique configurações de matching!' AS Descricao,
			   GETDATE() AS Criacao

		-- consider again only quotations missing yet (after processing) ProdutoCodigo mapping.
		FROM [dbo].[CotacoesIncompletasMapeamentoProdutoView] ci
			 INNER JOIN [dbo].[ProdutosMatching] pm
				ON ci.FornecedorCodigo = pm.FornecedorCodigo
				   AND ci.ComplementoCodigo = pm.ComplementoCodigo
				   AND ci._ProdutoCodigo = pm.Codigo
			 INNER JOIN [dbo].[Fornecedores] f
				ON ci.FornecedorCodigo = f.Codigo

		-- consider only quotations not in Partnumbers ambiguous list
		WHERE ci.Partnumber NOT IN
			  (
				   SELECT Partnumber FROM [dbo].[PartnumbersAmbiguosView]
			  )




		-- fill output @info with sucess message
		SET @Info = '[Step2c5_MappingProducts_Notifications1-01] Number of inserted notifications: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2c5_MappingProducts_Notifications1-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAvisos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Id]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[AvisoTipoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ProdutosCriacaoAutomatica]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ProdutosMatchingAutomatico]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[PartnumbersAmbiguosView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[PartnumbersAmbiguosView].[Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2c5_MappingProducts_Notifications1].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2c5_MappingProducts_Notifications1].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="190" />
				<Property Name="Length" Value="2440" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;Notifications SP: 1 of 3&#x9;(not ambiguous partnumbers)&#xD;&#xA;&#xD;&#xA;&#x9;This SP makes sure that user is notified via CotacoesAvisos table, that something &#xD;&#xA;&#x9;wrong happened in the mapping task.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2c5_MappingProducts_Notifications1]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2c5_MappingProducts_Notifications2]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- insert notifications on CotacoesAvisos table
	BEGIN TRY

		/*
			Insert notifications rows for all incomplete quotations that remain unmapped
		*/
		INSERT INTO [dbo].[CotacoesAvisos] 
				    (Id, FornecedorCodigo, Data, _ProdutoCodigo, _ComplementoCodigo, AvisoTipoCodigo, Descricao, Criacao)

		SELECT NEWID(), 
			   ci.FornecedorCodigo,
			   ci.Data,
			   ci._ProdutoCodigo,
			   ci._ComplementoCodigo,
			   'CIPM9',	-- Partnumber belongs to PartnumbersAmbiguous SET
			   'proceda à criação e mapeamento do produto manualmente!' AS Descricao,
			   GETDATE() AS Criacao

		-- consider again only quotations missing yet (after processing) ProdutoCodigo mapping.
		FROM [dbo].[CotacoesIncompletasMapeamentoProdutoView] ci
			 INNER JOIN [dbo].[ProdutosMatching] pm
				ON ci.FornecedorCodigo = pm.FornecedorCodigo
				   AND ci.ComplementoCodigo = pm.ComplementoCodigo
				   AND ci._ProdutoCodigo = pm.Codigo

		-- consider only quotations that are in Partnumbers ambiguous list
		WHERE ci.Partnumber IN
			  (
				   SELECT Partnumber FROM [dbo].[PartnumbersAmbiguosView]
			  )



		-- fill output @info with sucess message
		SET @Info = '[Step2c5_MappingProducts_Notifications2-01] Number of inserted notifications: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2c5_MappingProducts_Notifications2-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAvisos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Id]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[AvisoTipoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasMapeamentoProdutoView].[Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[PartnumbersAmbiguosView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[PartnumbersAmbiguosView].[Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2c5_MappingProducts_Notifications2].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2c5_MappingProducts_Notifications2].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="188" />
				<Property Name="Length" Value="1900" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;Notifications SP: 2 of 3   (ambiguous partnumbers)&#xD;&#xA;&#xD;&#xA;&#x9;This SP makes sure that user is notified via CotacoesAvisos table, that something &#xD;&#xA;&#x9;wrong happened in the mapping task.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2c5_MappingProducts_Notifications2]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2c5_MappingProducts_Notifications3]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- insert notifications on CotacoesAvisos table
	BEGIN TRY

		/*
			Insert notifications rows for all inactive products with active quotations
		*/
		INSERT INTO [dbo].[CotacoesAvisos] 
				    (Id, FornecedorCodigo, Data, _ProdutoCodigo, _ComplementoCodigo, AvisoTipoCodigo, Descricao, Criacao)

		SELECT NEWID(), 
			   c.FornecedorCodigo,
			   c.Data,
			   c._ProdutoCodigo,
			   c._ComplementoCodigo,
			   'CIPM4',	-- product is configured as inative (not active)
			   'produto configurado como inativo mas com cotações ativas, verifque!' AS Descricao,
			   GETDATE() AS Criacao

		-- consider again only quotations missing yet (after processing) ProdutoCodigo mapping.
		FROM [dbo].[CotacoesAtivasView] c
			 INNER JOIN [dbo].[Produtos] p
				ON c.ProdutoCodigo = p.Codigo

		-- consider only quotations that are in Partnumbers ambiguous list
		WHERE p.Inativo = CAST('true' as bit)



		-- fill output @info with sucess message
		SET @Info = '[Step2c5_MappingProducts_Notifications3-01] Number of inserted notifications: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2c5_MappingProducts_Notifications3-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAvisos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Id]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[AvisoTipoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtivasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtivasView].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtivasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtivasView].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtivasView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtivasView].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Inativo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2c5_MappingProducts_Notifications3].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2c5_MappingProducts_Notifications3].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="204" />
				<Property Name="Length" Value="1713" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;Notifications SP: 3 of 3   (inactive products)&#xD;&#xA;&#xD;&#xA;&#x9;This SP makes sure that user is notified via CotacoesAvisos table, that althought the quotation is mapped&#xD;&#xA;&#x9;the product record is inactive..&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2c5_MappingProducts_Notifications3]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2d1_Normalization_OtherFieldsFulfillment]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	BEGIN TRY

		/*
			Normalize and fill the remain Quotation internal fields.
		*/
		UPDATE ci
		SET ci.Descricao = ci.DescricaoUniformizada,
			ci.Caracteristicas = ci.CaracteristicasUniformizadas,
			ci.Link = ci.LinkUniformizado,
			ci.Imagem = ci.ImagemUniformizada,

			-- cost price
			ci.PrecoCusto = ci.PrecoCustoCalculado,
			ci.PrecoCustoFormula = ci.FormulaPrecoCustoCalculado,

			-- expiration date
			ci.Validade = ci.ValidadeCalculada,
			ci.ValidadeFormula = ci.FormulaValidadeCalculada,

			-- stockSubstituto
			ci.StockCodigoSubstituto = ci.StockCodigoSubstitutoCalculado,
			ci.StockCodigoSubstitutoJustificacao = ci.JustificacaoStockCodigoSubstitutoCalculado,
			
			-- version
			ci.Versao = GETDATE()


		/*  Using CotacoesIncompletasNormalizacaoView, I'm ensuring that I am working only with Incomplete Quotations  
			and adicional fields are generated only inside this view to simplify work of set internal fields of Quotations
			in Cotacoes table.
		*/
		FROM [dbo].[CotacoesIncompletasNormalizacaoView] ci



		-- fill output @info with sucess message
		SET @Info = '[Step2d1_Normalization_OtherFieldsFulfillment-01] Number of processed quotations: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2d1_Normalization_OtherFieldsFulfillment-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasNormalizacaoView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasNormalizacaoView].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasNormalizacaoView].[DescricaoUniformizada]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasNormalizacaoView].[Caracteristicas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasNormalizacaoView].[CaracteristicasUniformizadas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasNormalizacaoView].[Link]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasNormalizacaoView].[LinkUniformizado]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasNormalizacaoView].[Imagem]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasNormalizacaoView].[ImagemUniformizada]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasNormalizacaoView].[PrecoCusto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasNormalizacaoView].[PrecoCustoCalculado]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasNormalizacaoView].[PrecoCustoFormula]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasNormalizacaoView].[FormulaPrecoCustoCalculado]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasNormalizacaoView].[Validade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasNormalizacaoView].[ValidadeCalculada]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasNormalizacaoView].[ValidadeFormula]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasNormalizacaoView].[FormulaValidadeCalculada]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasNormalizacaoView].[StockCodigoSubstituto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasNormalizacaoView].[StockCodigoSubstitutoCalculado]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasNormalizacaoView].[StockCodigoSubstitutoJustificacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasNormalizacaoView].[JustificacaoStockCodigoSubstitutoCalculado]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasNormalizacaoView].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2d1_Normalization_OtherFieldsFulfillment].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2d1_Normalization_OtherFieldsFulfillment].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="67" />
				<Property Name="Length" Value="1737" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP, perform Quotation other fields fulfillment.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2d1_Normalization_OtherFieldsFulfillment]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step2d2_Normalization_SetComplete]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	BEGIN TRY

		/*
			Set complete all filled quotations
		*/
		UPDATE ci
		SET ci.Completo = CAST('true' as bit),
			ci.Versao = GETDATE()


		/*  Using CotacoesIncompletasFinalizacaoView, I'm ensuring that I am working only with Incomplete Quotations  
			that are ready to be settled as Completo = true
		*/
		FROM [dbo].[CotacoesIncompletasFinalizacaoView] ci



		-- fill output @info with sucess message
		SET @Info = '[Step2d2_Normalization_SetComplete-01] Number of quotations settled as completed: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step2d2_Normalization_SetComplete-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasFinalizacaoView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasFinalizacaoView].[Completo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesIncompletasFinalizacaoView].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step2d2_Normalization_SetComplete].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step2d2_Normalization_SetComplete].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="90" />
				<Property Name="Length" Value="1048" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP, set all filled quotations with the complete flat (Completo = true)&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step2d2_Normalization_SetComplete]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step3a1_Preparation_ProductMatchingsReset]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	BEGIN TRY

		/*
			Reset to default Product Matching rules with DataReset date <= GETDATE()
		*/
		
		UPDATE pm

			-- restablish defaults
		SET pm.HorasValidadeCotacao = NULL,
		    pm.StockCodigoSubstituto = NULL,
			pm.DispensaPrevencaoPrecosDesfasados = CAST('false' as bit),
			
			-- if there are some notes already settled on row do not remove them (append text at begining)
			pm.Notas =
					CASE WHEN pm.Notas IS NULL THEN '!reset (' + CONVERT(varchar, GETDATE(), 120) + ')'
					     ELSE SUBSTRING('!reset (' + CONVERT(varchar, GETDATE(), 120) + ') | ' + pm.Notas, 1, 256)
					END,

			-- set DataReset to default to
			pm.DataReset = NULL,

			-- thats a new row version
			pm.Versao = GETDATE()


		/*  Join to Suppliers table is not necessary at the moment, but could make sense in future to retreive defaults from
			Supplier data
		*/
		FROM [dbo].[ProdutosMatching] pm
			 INNER JOIN [dbo].[Fornecedores] f
				   ON pm.FornecedorCodigo = f.Codigo

		-- filter all rules with a DataReset settled with a date <= today..
		WHERE pm.DataReset IS NOT NULL
			  AND pm.DataReset <= GETDATE()




		-- fill output @info with sucess message
		SET @Info = '[Step3a1_Preparation_ProductMatchingsReset-01] Number of ProductMatching rules reseted to default: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step3a1_Preparation_ProductMatchingsReset-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[ProdutosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[HorasValidadeCotacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[StockCodigoSubstituto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[DispensaPrevencaoPrecosDesfasados]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Notas]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[DataReset]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosMatching].[DataReset]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step3a1_Preparation_ProductMatchingsReset].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step3a1_Preparation_ProductMatchingsReset].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="140" />
				<Property Name="Length" Value="1900" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP, resets all Product Matching rules (ProdutosMatching table) to it's defaults when date on DataReset field is reached.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step3a1_Preparation_ProductMatchingsReset]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step3a2_Preparation_QuotationRulesReset]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	BEGIN TRY

		/*
			Reset to default Quotation Rules with DataReset date <= GETDATE()
		*/
		
		UPDATE cr

			-- restablish defaults
		SET cr.HorasValidade = f.HorasValidadeSugestao,
			cr.StockCodigoSubstituto = NULL,
			
			-- if there are some notes already settled on row do not remove them (append text at begining)
			cr.Notas =
					CASE WHEN cr.Notas IS NULL THEN '!reset (' + CONVERT(varchar, GETDATE(), 120) + ')'
					     ELSE SUBSTRING('!reset (' + CONVERT(varchar, GETDATE(), 120) + ') | ' + cr.Notas, 1, 256)
					END,
		
			-- set DataReset to default to
			cr.DataReset = NULL,

			-- thats a new row version
			cr.Versao = GETDATE()


		FROM [dbo].[CotacoesRegras] cr
			 INNER JOIN [dbo].[Fornecedores] f
				   ON cr.FornecedorCodigo = f.Codigo

		-- filter all rules with a DataReset settled with a date <= today..
		WHERE cr.DataReset IS NOT NULL
			  AND cr.DataReset <= GETDATE()





		-- fill output @info with sucess message
		SET @Info = '[Step3a2_Preparation_QuotationRulesReset-01] Number of Quotation Rules reseted to default: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step3a2_Preparation_QuotationRulesReset-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesRegras]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[HorasValidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[HorasValidadeSugestao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[StockCodigoSubstituto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[Notas]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[DataReset]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesRegras].[DataReset]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step3a2_Preparation_QuotationRulesReset].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step3a2_Preparation_QuotationRulesReset].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="131" />
				<Property Name="Length" Value="1674" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP, resets all Quotation Rules (CotacoesRegras table) to it's defaults when date on DataReset field is reached.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step3a2_Preparation_QuotationRulesReset]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step3b1_Promotion_PromoteQuotations]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	-- begin transacion
	BEGIN TRANSACTION


		BEGIN TRY

			/*
				disable all Actual Quotations that have a newly not integrated quotation (CotacoesNaoIntegradas)
			*/

			WITH CotacoesAtuaisDespromover AS
			(
				/*	Intersect all existing Atual Quotations with Not Integrated Quotations.
					The resulting set of this query represents all quotations that must be disabled, because
					there are newly quotations to take their places
				*/
				SELECT FornecedorCodigo, ProdutoCodigo FROM CotacoesAtuaisView
				INTERSECT
				SELECT FornecedorCodigo, ProdutoCodigo FROM CotacoesNaoIntegradasView
			)

			UPDATE c
			SET c.Inativo = CAST('true' as bit),
				c.Versao = GETDATE()
			FROM [dbo].[CotacoesAtuaisView] c
				 INNER JOIN CotacoesAtuaisDespromover cd
					   ON c.FornecedorCodigo = cd.FornecedorCodigo
					      AND c.ProdutoCodigo = cd.ProdutoCodigo


			-- fill output @info with sucess message
			SET @Info = '[Step3b1_Promotion_PromoteQuotations-01] Disabled Quotations: ' + CAST(@@ROWCOUNT as nvarchar);
			
			
			/*
				set all Not Integrated Quotations (CotacoesNaoIntegradasView) to integrated status.
				
				(at this moment, we have total sure that we can promote all Not Integrated Quotations (CotacoesNaoIntegradasView)
				ensuring that will exist one Actual Quotation for each FornecedorCodigo / ProdutoCodigo)
			*/

			UPDATE c
			SET c.Integrado = CAST('true' as bit),
				c.Versao = GETDATE()
			FROM [dbo].[CotacoesNaoIntegradasView] c


			-- fill output @info with sucess message
			SET @Info += '; Promoted Quotations: ' + CAST(@@ROWCOUNT as nvarchar);


			-- commit transaction
			COMMIT TRANSACTION;

			-- send true to output
			RETURN 1;

		END TRY

		BEGIN CATCH
			-- fill output @info with occurred error message
			SET @Info = '[Step3b1_Promotion_PromoteQuotations-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

			-- rollback transaction;
			ROLLBACK TRANSACTION;

			-- send false to output
			RETURN 0;

		END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesNaoIntegradasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesNaoIntegradasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesNaoIntegradasView].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[Inativo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step3b1_Promotion_PromoteQuotations].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesNaoIntegradasView].[Integrado]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesNaoIntegradasView].[Versao]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[dbo].[Step3b1_Promotion_PromoteQuotations].[CTE1].[CotacoesAtuaisDespromover]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Step3b1_Promotion_PromoteQuotations].[CTE1].[CotacoesAtuaisDespromover].[FornecedorCodigo]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[CotacoesAtuaisView].[FornecedorCodigo]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[Step3b1_Promotion_PromoteQuotations].[CTE1].[CotacoesAtuaisDespromover].[ProdutoCodigo]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[CotacoesAtuaisView].[ProdutoCodigo]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step3b1_Promotion_PromoteQuotations].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="188" />
				<Property Name="Length" Value="2353" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP, disable old Actual Quotations and Promote just completed quotations to Actual Quotations&#xD;&#xA;&#x9;This procedure is executed inside a transaction to ensure data integrity.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step3b1_Promotion_PromoteQuotations]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step4a1_Preparation_Notifications]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	-- variables
	DECLARE @numberOfAffectedRows integer = 0;


	BEGIN TRY

		/*
			Insert notifications (CotacoesAvisos) of quotations changed values due to changes in rules ProdutosMatching and CotacoesRegras
		*/
				-- cost price update notifications
		INSERT INTO [dbo].[CotacoesAvisos] 
				    (Id, FornecedorCodigo, Data, _ProdutoCodigo, _ComplementoCodigo, AvisoTipoCodigo, Descricao, Criacao)

		SELECT NEWID() AS Id, 
			   c.FornecedorCodigo,
			   c.Data,
			   c._ProdutoCodigo,
			   c._ComplementoCodigo,
			   'CAC01' AS AvisoTipoCodigo,
			   'esta informação pode resultar de uma alteração recente de regras (ProdutosMatching ou CotacoesRegras)!' AS Descricao,
			   GETDATE() AS Criacao

		-- consider all quotations on CotacoesAtuaisRecalcularView, because all of them have changes to report
		FROM [dbo].CotacoesAtuaisRecalcularView c
		WHERE c.PrecoCusto <> c.PrecoCustoCalculado;

		-- sum to @numberOfAffectedRows
		SET @numberOfAffectedRows += @@ROWCOUNT;




		-- cost price formula update notifications
		INSERT INTO [dbo].[CotacoesAvisos] 
				    (Id, FornecedorCodigo, Data, _ProdutoCodigo, _ComplementoCodigo, AvisoTipoCodigo, Descricao, Criacao)

		SELECT NEWID() AS Id, 
			   c.FornecedorCodigo,
			   c.Data,
			   c._ProdutoCodigo,
			   c._ComplementoCodigo,
			   'CAC02' AS AvisoTipoCodigo,
			   'esta informação pode resultar de uma alteração recente da formula correspondente!' AS Descricao,
			   GETDATE() AS Criacao

		-- consider all quotations on CotacoesAtuaisRecalcularView, because all of them have changes to report
		FROM [dbo].CotacoesAtuaisRecalcularView c
		WHERE c.PrecoCustoFormula <> c.FormulaPrecoCustoCalculado;

		-- sum to @numberOfAffectedRows
		SET @numberOfAffectedRows += @@ROWCOUNT;



		-- expiration date update notifications
		INSERT INTO [dbo].[CotacoesAvisos] 
				    (Id, FornecedorCodigo, Data, _ProdutoCodigo, _ComplementoCodigo, AvisoTipoCodigo, Descricao, Criacao)

		SELECT NEWID() AS Id, 
			   c.FornecedorCodigo,
			   c.Data,
			   c._ProdutoCodigo,
			   c._ComplementoCodigo,
			   'CAC03' AS AvisoTipoCodigo,
			   'esta informação pode resultar de uma alteração recente de regras (ProdutosMatching ou CotacoesRegras)!' AS Descricao,
			   GETDATE() AS Criacao

		-- consider all quotations on CotacoesAtuaisRecalcularView, because all of them have changes to report
		FROM [dbo].CotacoesAtuaisRecalcularView c
		WHERE c.Validade <> c.ValidadeCalculada;

		-- sum to @numberOfAffectedRows
		SET @numberOfAffectedRows += @@ROWCOUNT;




		-- expiration date formula update notifications
		INSERT INTO [dbo].[CotacoesAvisos] 
				    (Id, FornecedorCodigo, Data, _ProdutoCodigo, _ComplementoCodigo, AvisoTipoCodigo, Descricao, Criacao)

		SELECT NEWID() AS Id, 
			   c.FornecedorCodigo,
			   c.Data,
			   c._ProdutoCodigo,
			   c._ComplementoCodigo,
			   'CAC04' AS AvisoTipoCodigo,
			   'esta informação pode resultar de uma alteração recente da formula correspondente!' AS Descricao,
			   GETDATE() AS Criacao

		-- consider all quotations on CotacoesAtuaisRecalcularView, because all of them have changes to report
		FROM [dbo].CotacoesAtuaisRecalcularView c
		WHERE c.ValidadeFormula <> c.FormulaValidadeCalculada;

		-- sum to @numberOfAffectedRows
		SET @numberOfAffectedRows += @@ROWCOUNT;




		-- description update notifications
		INSERT INTO [dbo].[CotacoesAvisos] 
				    (Id, FornecedorCodigo, Data, _ProdutoCodigo, _ComplementoCodigo, AvisoTipoCodigo, Descricao, Criacao)

		SELECT NEWID() AS Id, 
			   c.FornecedorCodigo,
			   c.Data,
			   c._ProdutoCodigo,
			   c._ComplementoCodigo,
			   'CAC05' AS AvisoTipoCodigo,
			   'esta informação pode resultar de uma alteração recente da formula de normalização!' AS Descricao,
			   GETDATE() AS Criacao

		-- consider all quotations on CotacoesAtuaisRecalcularView, because all of them have changes to report
		FROM [dbo].CotacoesAtuaisRecalcularView c
		WHERE c.Descricao <> c.DescricaoUniformizada;

		-- sum to @numberOfAffectedRows
		SET @numberOfAffectedRows += @@ROWCOUNT;




		-- features update notifications
		INSERT INTO [dbo].[CotacoesAvisos] 
				    (Id, FornecedorCodigo, Data, _ProdutoCodigo, _ComplementoCodigo, AvisoTipoCodigo, Descricao, Criacao)

		SELECT NEWID() AS Id, 
			   c.FornecedorCodigo,
			   c.Data,
			   c._ProdutoCodigo,
			   c._ComplementoCodigo,
			   'CAC06' AS AvisoTipoCodigo,
			   'esta informação pode resultar de uma alteração recente da formula de normalização!' AS Descricao,
			   GETDATE() AS Criacao

		-- consider all quotations on CotacoesAtuaisRecalcularView, because all of them have changes to report
		FROM [dbo].CotacoesAtuaisRecalcularView c
		WHERE c.Caracteristicas <> c.CaracteristicasUniformizadas;

		-- sum to @numberOfAffectedRows
		SET @numberOfAffectedRows += @@ROWCOUNT;



				
		-- link update notifications
		INSERT INTO [dbo].[CotacoesAvisos] 
				    (Id, FornecedorCodigo, Data, _ProdutoCodigo, _ComplementoCodigo, AvisoTipoCodigo, Descricao, Criacao)

		SELECT NEWID() AS Id, 
			   c.FornecedorCodigo,
			   c.Data,
			   c._ProdutoCodigo,
			   c._ComplementoCodigo,
			   'CAC07' AS AvisoTipoCodigo,
			   'esta informação pode resultar de uma alteração recente da formula de normalização!' AS Descricao,
			   GETDATE() AS Criacao

		-- consider all quotations on CotacoesAtuaisRecalcularView, because all of them have changes to report
		FROM [dbo].CotacoesAtuaisRecalcularView c
		WHERE c.Link <> c.LinkUniformizado;

		-- sum to @numberOfAffectedRows
		SET @numberOfAffectedRows += @@ROWCOUNT;




		-- image update notifications
		INSERT INTO [dbo].[CotacoesAvisos] 
				    (Id, FornecedorCodigo, Data, _ProdutoCodigo, _ComplementoCodigo, AvisoTipoCodigo, Descricao, Criacao)

		SELECT NEWID() AS Id, 
			   c.FornecedorCodigo,
			   c.Data,
			   c._ProdutoCodigo,
			   c._ComplementoCodigo,
			   'CAC08' AS AvisoTipoCodigo,
			   'esta informação pode resultar de uma alteração recente da formula de normalização!' AS Descricao,
			   GETDATE() AS Criacao

		-- consider all quotations on CotacoesAtuaisRecalcularView, because all of them have changes to report
		FROM [dbo].CotacoesAtuaisRecalcularView c
		WHERE c.Imagem <> c.ImagemUniformizada;

		-- sum to @numberOfAffectedRows
		SET @numberOfAffectedRows += @@ROWCOUNT;
		



		-- substitute stock update notifications
		INSERT INTO [dbo].[CotacoesAvisos] 
				    (Id, FornecedorCodigo, Data, _ProdutoCodigo, _ComplementoCodigo, AvisoTipoCodigo, Descricao, Criacao)

		SELECT NEWID() AS Id, 
			   c.FornecedorCodigo,
			   c.Data,
			   c._ProdutoCodigo,
			   c._ComplementoCodigo,
			   'CAC09' AS AvisoTipoCodigo,
			   'esta informação pode resultar de uma alteração recente de regras (ProdutosMatching ou CotacoesRegras)!' AS Descricao,
			   GETDATE() AS Criacao

		-- consider all quotations on CotacoesAtuaisRecalcularView, because all of them have changes to report
		FROM [dbo].CotacoesAtuaisRecalcularView c
		WHERE c.StockCodigoSubstituto <> c.StockCodigoSubstitutoCalculado;

		-- sum to @numberOfAffectedRows
		SET @numberOfAffectedRows += @@ROWCOUNT;
		



		-- substitute stock formula update notifications
		INSERT INTO [dbo].[CotacoesAvisos] 
				    (Id, FornecedorCodigo, Data, _ProdutoCodigo, _ComplementoCodigo, AvisoTipoCodigo, Descricao, Criacao)

		SELECT NEWID() AS Id, 
			   c.FornecedorCodigo,
			   c.Data,
			   c._ProdutoCodigo,
			   c._ComplementoCodigo,
			   'CAC10' AS AvisoTipoCodigo,
			   'esta informação pode resultar de uma alteração recente da formula correspondente!' AS Descricao,
			   GETDATE() AS Criacao

		-- consider all quotations on CotacoesAtuaisRecalcularView, because all of them have changes to report
		FROM [dbo].CotacoesAtuaisRecalcularView c
		WHERE c.StockCodigoSubstitutoJustificacao <> c.JustificacaoStockCodigoSubstitutoCalculado;

		-- sum to @numberOfAffectedRows
		SET @numberOfAffectedRows += @@ROWCOUNT;






		-- fill output @info with sucess message
		SET @Info = '[Step4a1_Preparation_Notifications-01] Number of inserted notifications: ' + CAST(@numberOfAffectedRows as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step4a1_Preparation_Notifications-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Id]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[AvisoTipoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[PrecoCusto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[PrecoCustoCalculado]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[PrecoCustoFormula]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[FormulaPrecoCustoCalculado]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[Validade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[ValidadeCalculada]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[ValidadeFormula]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[FormulaValidadeCalculada]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[DescricaoUniformizada]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[Caracteristicas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[CaracteristicasUniformizadas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[Link]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[LinkUniformizado]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[Imagem]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[ImagemUniformizada]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[StockCodigoSubstituto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[StockCodigoSubstitutoCalculado]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[StockCodigoSubstitutoJustificacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[JustificacaoStockCodigoSubstitutoCalculado]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step4a1_Preparation_Notifications].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step4a1_Preparation_Notifications].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="156" />
				<Property Name="Length" Value="8857" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;Register on CotacoesAvisos, all change that will be sended to database, based on changed rules defined in ProdutosMatching and CotacoesRegras&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step4a1_Preparation_Notifications]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step4a2_Preparation_OtherFieldsRefresh]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	BEGIN TRY

		/*
			Refresh values of quotation fields, as needed
		*/
		
		UPDATE c
		
		SET c.PrecoCusto = c.PrecoCustoCalculado,
		    c.PrecoCustoFormula = c.FormulaPrecoCustoCalculado,
			c.Validade = c.ValidadeCalculada,
			c.ValidadeFormula = c.FormulaValidadeCalculada,
			c.Descricao = c.DescricaoUniformizada,
			c.Caracteristicas = c.CaracteristicasUniformizadas,
			c.Link = c.LinkUniformizado,
			c.Imagem = c.ImagemUniformizada,
			c.StockCodigoSubstituto = c.StockCodigoSubstitutoCalculado,
			c.StockCodigoSubstitutoJustificacao = c.JustificacaoStockCodigoSubstitutoCalculado,
			c.Versao = GETDATE()

		FROM [dbo].[CotacoesAtuaisRecalcularView] c




		-- fill output @info with sucess message
		SET @Info = '[Step4a2_Preparation_OtherFieldsRefresh-01] Number of Refreshed Quotations: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step4a2_Preparation_OtherFieldsRefresh-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[PrecoCusto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[PrecoCustoCalculado]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[PrecoCustoFormula]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[FormulaPrecoCustoCalculado]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[Validade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[ValidadeCalculada]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[ValidadeFormula]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[FormulaValidadeCalculada]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[DescricaoUniformizada]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[Caracteristicas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[CaracteristicasUniformizadas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[Link]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[LinkUniformizado]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[Imagem]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[ImagemUniformizada]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[StockCodigoSubstituto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[StockCodigoSubstitutoCalculado]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[StockCodigoSubstitutoJustificacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[JustificacaoStockCodigoSubstitutoCalculado]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisRecalcularView].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step4a2_Preparation_OtherFieldsRefresh].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step4a2_Preparation_OtherFieldsRefresh].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="197" />
				<Property Name="Length" Value="1470" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;Update (refresh) Quotations information that must be changed due to ProdutosMatching or CotacoesRegras updated rules.&#xD;&#xA;&#x9;This SP uses CotacoesAtuaisRecalcular to simplify the process.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step4a2_Preparation_OtherFieldsRefresh]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step4a3_Preparation_SetInactiveExpiredQuotations]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- change expired quotations inactive field value
	BEGIN TRY

		-- set inactive all expired quotations
		UPDATE c
		SET c.Inativo = CAST('true' as bit),
		    c.Versao = GETDATE()
		FROM [dbo].[CotacoesAtuaisView] c
		WHERE Validade < GETDATE();


		-- fill output @info with sucess message
		SET @Info = '[Step4a3_Preparation_SetInactiveExpiredQuotations-01] Inativação de quotações expiradas realizada com sucesso';

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step4a3_Preparation_SetInactiveExpiredQuotations-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[Inativo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[Validade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step4a3_Preparation_SetInactiveExpiredQuotations].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step4a3_Preparation_SetInactiveExpiredQuotations].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="200" />
				<Property Name="Length" Value="1063" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP set as inactive all expired quotations on Cotacoes table.&#xD;&#xA;&#x9;It is executed only in this step, because Validade field could be updated till last instruction (OtherFieldsRefresh).&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step4a3_Preparation_SetInactiveExpiredQuotations]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step4a4_Finishing_ProductDescontinuation]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	BEGIN TRY

		/*
			Set descontinued all products without Actual Quotations.
		*/
		UPDATE p
		SET p.Descontinuado = CAST('true' as bit),
			p.Versao = GETDATE()

		FROM [dbo].[ProdutosAtuaisView] p

		-- it is not necessary to filter only inativo='false' and descontinuado='false' because ProdutosAtuaisView already filter it
		WHERE p.Codigo NOT IN 
							  (
									SELECT DISTINCT ProdutoCodigo FROM [dbo].[CotacoesAtuaisView]
							  )



		-- fill output @info with sucess message
		SET @Info = '[Step4a4_Finishing_ProductDescontinuation-01] Number of Descontinued Products: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step4a4_Finishing_ProductDescontinuation-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[ProdutosAtuaisView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosAtuaisView].[Descontinuado]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosAtuaisView].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosAtuaisView].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step4a4_Finishing_ProductDescontinuation].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step4a4_Finishing_ProductDescontinuation].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="217" />
				<Property Name="Length" Value="1271" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP, set as descontinued all products that don't have any Actual Quotation (CotacoesAtuais).&#xD;&#xA;&#x9;If a product doesn't have any Actual Quotation, that means that it is not possible to sell it any more.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step4a4_Finishing_ProductDescontinuation]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step4a5_Finishing_ProductResurrection]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	BEGIN TRY

		/*
			Set as ressurected (not descontinued) all descontinued products that have Actual Quotations (again).
		*/

		UPDATE p
		SET p.Descontinuado = CAST('false' as bit),
			p.Versao = GETDATE()

		FROM [dbo].[Produtos] p
		WHERE p.Inativo = CAST('false' as bit)
			  AND p.Descontinuado = CAST('true' as bit)
			  AND p.Codigo IN 
						  (
							   SELECT DISTINCT ProdutoCodigo FROM [dbo].[CotacoesAtuaisView]
						  )


		-- fill output @info with sucess message
		SET @Info = '[Step4a5_Finishing_ProductResurrection-01] Number of Resurrected Products: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step4a5_Finishing_ProductResurrection-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Produtos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Descontinuado]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Inativo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step4a5_Finishing_ProductResurrection].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step4a5_Finishing_ProductResurrection].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="322" />
				<Property Name="Length" Value="1357" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP, set as not descontinued all descontinued products that back to have Actual Quotations (CotacoesAtuais).&#xD;&#xA;&#x9;If a product no longer have quotations (CotacoesAtuais), that means that the product is been descontinued. Hoever, if it&#xD;&#xA;&#x9;comes back having quotations later, the product must be ressurected..&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step4a5_Finishing_ProductResurrection]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step4b1_Cautions_FakeStock_Notifications]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- insert notifications on CotacoesAvisos table
	BEGIN TRY

		/*
			Insert notifications rows for all quotations that can have a fake stock classification
		*/
		INSERT INTO [dbo].[CotacoesAvisos] 
				    (Id, FornecedorCodigo, Data, _ProdutoCodigo, _ComplementoCodigo, AvisoTipoCodigo, Descricao, Criacao)

		SELECT NEWID(), 
			   c.FornecedorCodigo,
			   c.Data,
			   c._ProdutoCodigo,
			   c._ComplementoCodigo,
			   'PFS' AS AvisoTipoCodigo,
			   CASE WHEN (GETDATE() >= c.P90) AND (c.ValidadeP90_StockCodigo IS NOT NULL) THEN 
								'!Prevenção[FalsoStock] (' + CONVERT(varchar, GETDATE(), 103) + ') P90 atingido! '
					
					WHEN (GETDATE() >= c.P80) AND (c.ValidadeP80_StockCodigo IS NOT NULL) THEN
								'!Prevenção[FalsoStock] (' + CONVERT(varchar, GETDATE(), 103) + ') P80 atingido! '
					
					WHEN (GETDATE() >= c.P70) AND (c.ValidadeP70_StockCodigo IS NOT NULL) THEN
								'!Prevenção[FalsoStock] (' + CONVERT(varchar, GETDATE(), 103) + ') P70 atingido! '

					WHEN (GETDATE() >= c.P60) AND (c.ValidadeP60_StockCodigo IS NOT NULL) THEN
								'!Prevenção[FalsoStock] (' + CONVERT(varchar, GETDATE(), 103) + ') P60 atingido! '

					WHEN (GETDATE() >= c.P50) AND (c.ValidadeP50_StockCodigo IS NOT NULL) THEN
								'!Prevenção[FalsoStock] (' + CONVERT(varchar, GETDATE(), 103) + ') P50 atingido! '

					ELSE c.StockCodigoSubstitutoJustificacao
			   END,

			   GETDATE() AS Criacao

		-- consider only quotations filtered to FakeStock prevention
		FROM [dbo].[CotacoesAtuaisFalsoStockView] c



		-- fill output @info with sucess message
		SET @Info = '[Step4b1_Cautions_FakeStock_Notifications-01] Number of inserted notifications: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step4b1_Cautions_FakeStock_Notifications-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAvisos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Id]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[AvisoTipoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[P90]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[ValidadeP90_StockCodigo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[P80]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[ValidadeP80_StockCodigo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[P70]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[ValidadeP70_StockCodigo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[P60]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[ValidadeP60_StockCodigo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[P50]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[ValidadeP50_StockCodigo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[StockCodigoSubstitutoJustificacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step4b1_Cautions_FakeStock_Notifications].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step4b1_Cautions_FakeStock_Notifications].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="228" />
				<Property Name="Length" Value="2385" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP makes sure that user is notified via CotacoesAvisos table, that some actual quotations were updated with&#xD;&#xA;&#x9;new StockCodigoSubsituto due to date evolution and configuration of percentil codes on Stocks table.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step4b1_Cautions_FakeStock_Notifications]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step4b2_Cautions_FakeStock_Execution]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	BEGIN TRY

		/*
			Update quotations with a new Stock Code to prevent a fack stock promotion.
		*/
		UPDATE c

		SET StockCodigoSubstitutoJustificacao =
				CASE WHEN (GETDATE() >= c.P90) AND (c.ValidadeP90_StockCodigo IS NOT NULL) THEN 
								SUBSTRING('!Prevenção[FalsoStock] (' + CONVERT(varchar, GETDATE(), 103) + ') P90 atingido! ' + COALESCE(c.StockCodigoSubstitutoJustificacao, ''), 1, 256)

					 WHEN (GETDATE() >= c.P80) AND (c.ValidadeP80_StockCodigo IS NOT NULL) THEN
								SUBSTRING('!Prevenção[FalsoStock] (' + CONVERT(varchar, GETDATE(), 103) + ') P80 atingido! ' + COALESCE(c.StockCodigoSubstitutoJustificacao, ''), 1, 256)

					 WHEN (GETDATE() >= c.P70) AND (c.ValidadeP70_StockCodigo IS NOT NULL) THEN
								SUBSTRING('!Prevenção[FalsoStock] (' + CONVERT(varchar, GETDATE(), 103) + ') P70 atingido! ' + COALESCE(c.StockCodigoSubstitutoJustificacao, ''), 1, 256)

					 WHEN (GETDATE() >= c.P60) AND (c.ValidadeP60_StockCodigo IS NOT NULL) THEN
								SUBSTRING('!Prevenção[FalsoStock] (' + CONVERT(varchar, GETDATE(), 103) + ') P60 atingido! ' + COALESCE(c.StockCodigoSubstitutoJustificacao, ''), 1, 256)

					 WHEN (GETDATE() >= c.P50) AND (c.ValidadeP50_StockCodigo IS NOT NULL) THEN
								SUBSTRING('!Prevenção[FalsoStock] (' + CONVERT(varchar, GETDATE(), 103) + ') P50 atingido! ' + COALESCE(c.StockCodigoSubstitutoJustificacao, ''), 1, 256)

					 ELSE c.StockCodigoSubstitutoJustificacao
				END,
			
			StockCodigoSubstituto =
				CASE WHEN (GETDATE() >= c.P90) AND (c.ValidadeP90_StockCodigo IS NOT NULL) THEN 
								c.ValidadeP90_StockCodigo

					 WHEN (GETDATE() >= c.P80) AND (c.ValidadeP80_StockCodigo IS NOT NULL) THEN 
								c.ValidadeP80_StockCodigo

					 WHEN (GETDATE() >= c.P70) AND (c.ValidadeP70_StockCodigo IS NOT NULL) THEN 
								c.ValidadeP70_StockCodigo

					 WHEN (GETDATE() >= c.P60) AND (c.ValidadeP60_StockCodigo IS NOT NULL) THEN 
								c.ValidadeP60_StockCodigo

					 WHEN (GETDATE() >= c.P50) AND (c.ValidadeP50_StockCodigo IS NOT NULL) THEN 
								c.ValidadeP50_StockCodigo

					 ELSE c.StockCodigoSubstituto
				END,
			
			c.Versao = GETDATE()

		FROM [dbo].[CotacoesAtuaisFalsoStockView] c




		-- fill output @info with sucess message
		SET @Info = '[Step4b2_Cautions_FakeStock_Execution-01] Number of executed FakeStock preventions: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step4b2_Cautions_FakeStock_Execution-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[StockCodigoSubstitutoJustificacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[P90]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[ValidadeP90_StockCodigo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[StockCodigoSubstitutoJustificacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[P80]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[ValidadeP80_StockCodigo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[P70]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[ValidadeP70_StockCodigo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[P60]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[ValidadeP60_StockCodigo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[P50]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[ValidadeP50_StockCodigo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[StockCodigoSubstituto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[StockCodigoSubstituto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisFalsoStockView].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step4b2_Cautions_FakeStock_Execution].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step4b2_Cautions_FakeStock_Execution].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="274" />
				<Property Name="Length" Value="3086" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This stored procedure entends to lower stock availability on all quotations that have more than 2/3 of it's valid life.&#xD;&#xA;&#x9;Every Actual Quotations that have more than 2/3 of its life (to expire), must be reconfigured with a more secure availability stock code.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step4b2_Cautions_FakeStock_Execution]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step4b3_Cautions_OutOfInterval_Notifications]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- insert notifications on CotacoesAvisos table
	BEGIN TRY

		/*
			Insert notifications rows for all disabled quotations
		*/
		INSERT INTO [dbo].[CotacoesAvisos] 
				    (Id, FornecedorCodigo, Data, _ProdutoCodigo, _ComplementoCodigo, AvisoTipoCodigo, Descricao, Criacao)

		SELECT NEWID(), 
			   c.FornecedorCodigo,
			   c.Data,
			   c._ProdutoCodigo,
			   c._ComplementoCodigo,
			   'IAPD1' AS AvisoTipoCodigo,
			   '!Prevenção[Preço Desfasado] (' + CONVERT(varchar, GETDATE(), 103) + ') Preço fora do intervalo ' +
			   '[' + CONVERT(varchar, c.PrecoMinimoPermitido) + ',' +
			   CONVERT(varchar, c.PrecoMaximoPermitido) + ']',
			   GETDATE() AS Criacao

		-- consider only quotations filtered to Out of Interval prevention
		FROM [dbo].[CotacoesAtuaisPrecosForaIntervaloView] c



		-- fill output @info with sucess message
		SET @Info = '[Step4b3_Cautions_OutOfInterval_Notifications-01] Number of inserted notifications: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step4b3_Cautions_OutOfInterval_Notifications-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAvisos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Id]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[AvisoTipoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[PrecoMinimoPermitido]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[PrecoMaximoPermitido]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step4b3_Cautions_OutOfInterval_Notifications].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step4b3_Cautions_OutOfInterval_Notifications].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="208" />
				<Property Name="Length" Value="1632" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP makes sure that user is notified via CotacoesAvisos table, that some actual quotations were disabled becouse the&#xD;&#xA;&#x9;it's price is out of the interval specified on Category interval allowed&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step4b3_Cautions_OutOfInterval_Notifications]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step4b4_Cautions_OutOfInterval_Execution]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	BEGIN TRY

		/*
			Inactivate Actual Quotations that has a irregular price (Out Of Interval)
		*/
		UPDATE c
		
		SET c.Inativo = CAST('true' as bit),
			c.Versao = GETDATE()

		FROM [dbo].[CotacoesAtuaisPrecosForaIntervaloView] c



		-- fill output @info with sucess message
		SET @Info = '[Step4b2_Cautions_FakeStock_Execution-01] Number of executed Out Of Interval preventions: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step4b4_Cautions_OutOfInterval_Execution-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[Inativo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisPrecosForaIntervaloView].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step4b4_Cautions_OutOfInterval_Execution].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step4b4_Cautions_OutOfInterval_Execution].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="151" />
				<Property Name="Length" Value="998" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This stored procedure entends to inactivate Actual Quotations that has it's price out of the interval defined on correspondent category.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step4b4_Cautions_OutOfInterval_Execution]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step4b5_Cautions_IrregularAmplitude_Notifications]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	-- insert notifications on CotacoesAvisos table
	BEGIN TRY

		/*
			Insert notifications rows for all disabled quotations
		*/
		INSERT INTO [dbo].[CotacoesAvisos] 
				    (Id, FornecedorCodigo, Data, _ProdutoCodigo, _ComplementoCodigo, AvisoTipoCodigo, Descricao, Criacao)

		SELECT NEWID(), 
			   c.FornecedorCodigo,
			   c.Data,
			   c._ProdutoCodigo,
			   c._ComplementoCodigo,
			   'IAPD2' AS AvisoTipoCodigo,
			   '!Prevenção[Preço Desfasado] (' + CONVERT(varchar, GETDATE(), 103) + ') Preço com amplitude irregular ' +
			   '[' + c.AmplitudeFormulaDetecaoDesfasamento + ']. ' +
			   'O preço desfasado é ' + CONVERT(varchar, c.PrecoDesfasado) + ' ' +
			   '[' + c.PrecoDesfasadoFormulaDecisao + '].',

			   GETDATE() AS Criacao

		-- consider only quotations filtered to Out of Interval prevention
		FROM [dbo].[CotacoesAtuaisAmplitudeIrregularView] c



		-- fill output @info with sucess message
		SET @Info = '[Step4b5_Cautions_IrregularAmplitude_Notifications-01] Number of inserted notifications: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step4b5_Cautions_IrregularAmplitude_Notifications-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAvisos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Id]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[AvisoTipoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAvisos].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[_ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[_ComplementoCodigo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[AmplitudeFormulaDetecaoDesfasamento]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[PrecoDesfasado]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[PrecoDesfasadoFormulaDecisao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step4b5_Cautions_IrregularAmplitude_Notifications].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step4b5_Cautions_IrregularAmplitude_Notifications].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="212" />
				<Property Name="Length" Value="1729" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This SP makes sure that user is notified via CotacoesAvisos table, that some actual quotations were disabled because the&#xD;&#xA;&#x9;it's price is causing an irregular price amplitude (inside the same product)&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step4b5_Cautions_IrregularAmplitude_Notifications]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step4b6_Cautions_IrregularAmplitude_Execution]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	BEGIN TRY

		/*
			Inactivate Actual Quotations that has a irregular price (Out Of Interval)
		*/
		UPDATE c
		
		SET c.Inativo = CAST('true' as bit),
			c.Versao = GETDATE()

		FROM [dbo].[CotacoesAtuaisAmplitudeIrregularView] c



		-- fill output @info with sucess message
		SET @Info = '[Step4b6_Cautions_IrregularAmplitude_Execution-01] Number of executed Irregular Amplitude preventions: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- fill output @info with occurred error message
		SET @Info = '[Step4b6_Cautions_IrregularAmplitude_Execution-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[Inativo]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisAmplitudeIrregularView].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step4b6_Cautions_IrregularAmplitude_Execution].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step4b6_Cautions_IrregularAmplitude_Execution].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="162" />
				<Property Name="Length" Value="1031" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This stored procedure entends to inactivate Actual Quotations with irregular amplitude quotations (most irregular price grouping by ProdutoCodigo).&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step4b6_Cautions_IrregularAmplitude_Execution]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step4c1_Finishing_ProductsUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	-- variables
	DECLARE @numberOfAffectedRows integer = 0;


	-- start a transaction scope
	BEGIN TRANSACTION


	BEGIN TRY

		/*
			Update Product information
		*/
		-- new day prices update (do update price history) (update prices if needed of products not updated today already)
		UPDATE p
		SET p.PrecoCusto_U3 = p.PrecoCusto_U2,
			p.PrecoCusto_U3Data = p.PrecoCusto_U2Data,
			p.PrecoCusto_U2 = p.PrecoCusto_U1,
			p.PrecoCusto_U2Data = p.PrecoCusto_U1Data,
			p.PrecoCusto_U1 = p.PrecoCusto,
			p.PrecoCusto_U1Data = p.PrecoCusto_Data,
			p.PrecoCusto = c.PrecoCusto,
			p.PrecoCusto_Data = CAST(GETDATE() AS DATE),
			p.Versao = GETDATE()

		FROM [dbo].[Produtos] p
			 INNER JOIN [dbo].[CotacoesVencedorasView] c
				   ON p.Codigo = c.ProdutoCodigo

		-- we want to update only different prices (product vs quotations) and last update date was not today..
		WHERE COALESCE(p.PrecoCusto, -999999999) <> c.PrecoCusto
			  AND COALESCE(p.PrecoCusto_Data, CAST('01-01-2000' as date)) <> CAST(GETDATE() AS DATE)


		-- sum to @numberOfAffectedRows
		SET @numberOfAffectedRows += @@ROWCOUNT;





		-- same day prices update (do NOT update price history)
		UPDATE p
		SET p.PrecoCusto = c.PrecoCusto,
			p.Versao = GETDATE()

		FROM [dbo].[Produtos] p
			 INNER JOIN [dbo].[CotacoesVencedorasView] c
				   ON p.Codigo = c.ProdutoCodigo

		-- we want to update only different prices (product vs quotations) and last update date was today..
		WHERE COALESCE(p.PrecoCusto, -999999999) <> c.PrecoCusto
			  AND COALESCE(p.PrecoCusto_Data, CAST('01-01-2000' as date)) = CAST(GETDATE() AS DATE)


		-- sum to @numberOfAffectedRows
		SET @numberOfAffectedRows += @@ROWCOUNT;





		-- new day stock update (do update stock history) (update stocks if needed of products not updated today already)
		UPDATE p
		SET p.StockCodigo_U3 = p.StockCodigo_U2,
			p.StockCodigo_U3Data = p.StockCodigo_U2Data,
			p.StockCodigo_U2 = p.StockCodigo_U1,
			p.StockCodigo_U2Data = p.StockCodigo_U1Data,
			p.StockCodigo_U1 = p.StockCodigo,
			p.StockCodigo_U1Data = p.StockCodigo_Data,
			p.StockCodigo = c.StockCodigoEfetivo,
			p.StockCodigo_Data = CAST(GETDATE() AS DATE),
			p.Versao = GETDATE()

		FROM [dbo].[Produtos] p
			 INNER JOIN [dbo].[CotacoesVencedorasView] c
				   ON p.Codigo = c.ProdutoCodigo

		-- we want to update only different stocks (product vs quotations) and last update date was not today..
		WHERE COALESCE(p.StockCodigo, '') <> c.StockCodigoEfetivo
			  AND COALESCE(p.StockCodigo_Data, CAST('01-01-2000' as date)) <> CAST(GETDATE() AS DATE)


		-- sum to @numberOfAffectedRows
		SET @numberOfAffectedRows += @@ROWCOUNT;





		-- same day stocks update (do NOT update stock history)
		UPDATE p
		SET p.StockCodigo = c.StockCodigoEfetivo,
			p.Versao = GETDATE()

		FROM [dbo].[Produtos] p
			 INNER JOIN [dbo].[CotacoesVencedorasView] c
				   ON p.Codigo = c.ProdutoCodigo

		-- we want to update only different stocks (product vs quotations) and last update date was today..
		WHERE COALESCE(p.StockCodigo, '') <> c.StockCodigoEfetivo
			  AND COALESCE(p.StockCodigo_Data, CAST('01-01-2000' as date)) = CAST(GETDATE() AS DATE)


		-- sum to @numberOfAffectedRows
		SET @numberOfAffectedRows += @@ROWCOUNT;





		-- update other fields of quotation
		UPDATE p
		SET p.Descricao = c.Descricao,
			p.Partnumber = c.Partnumber,
			p.FornecedorCodigo = c.FornecedorCodigo,
			p.Versao = GETDATE()

		FROM [dbo].[Produtos] p
			 INNER JOIN [dbo].[CotacoesVencedorasView] c
				   ON p.Codigo = c.ProdutoCodigo

		-- filter only records with info to be updated
		WHERE COALESCE(p.Descricao,'') <> c.Descricao
			  OR COALESCE(p.Partnumber, '') <> c.Partnumber
			  OR COALESCE(p.FornecedorCodigo, '') <> c.FornecedorCodigo


		-- sum to @numberOfAffectedRows
		SET @numberOfAffectedRows += @@ROWCOUNT;




		-- commit all changes
		COMMIT TRANSACTION

		-- fill output @info with sucess message
		SET @Info = '[Step4c1_Finishing_ProductsUpdate-01] Total of affected rows (one product could be updated by several instructions): ' + CAST(@numberOfAffectedRows as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- rollback transaction
		ROLLBACK TRANSACTION

		-- fill output @info with occurred error message
		SET @Info = '[Step4c1_Finishing_ProductsUpdate-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesVencedorasView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesVencedorasView].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U3]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U2]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U3Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U2Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U2]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U1]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U2Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U1Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U1]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_U1Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesVencedorasView].[PrecoCusto]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[PrecoCusto_Data]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[date]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Versao]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[date]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[date]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[date]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[date]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U3]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U2]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U3Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U2Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U2]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U1]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U2Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U1Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U1]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_U1Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_Data]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesVencedorasView].[StockCodigoEfetivo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[StockCodigo_Data]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[date]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[date]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[date]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[date]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[date]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesVencedorasView].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesVencedorasView].[Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesVencedorasView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[Partnumber]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Produtos].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step4c1_Finishing_ProductsUpdate].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step4c1_Finishing_ProductsUpdate].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="171" />
				<Property Name="Length" Value="4839" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This stored procedure will update Products table with recent processed information.&#xD;&#xA;&#x9;This SP will use CotacoesVencedoras view to support product updating..&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step4c1_Finishing_ProductsUpdate]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step4c2_Finishing_ProductsDetailUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	-- variables
	DECLARE @numberOfAffectedRows integer = 0;


	-- start a transaction scope
	BEGIN TRANSACTION


	BEGIN TRY

		/*
			Update Products Detail information
		*/
		

	
		-- set new content preocupation index (based on description and features from Quotations table - the new value..)
		UPDATE pd
		SET pd.IndicePreocupacaoConteudo = [dbo].[GetProdutoDetalheIndicePreocupacaoFunction](c.Descricao, c.Caracteristicas),
			pd.Versao = GETDATE()
		FROM [dbo].[ProdutosDetalhe] pd
			 INNER JOIN [dbo].[CotacoesAtuaisView] c
				   ON pd.FornecedorCodigo = c.FornecedorCodigo
					  AND pd.ProdutoCodigo = c.ProdutoCodigo
		-- process only rows that has changes on description or features..
		WHERE pd.AtualizacaoAutomaticaInativa = CAST('false' as bit)
			  AND (
					pd.Descricao <> c.Descricao
					OR pd.Caracteristicas <> c.Caracteristicas
				  )

		-- sum to @numberOfAffectedRows
		SET @numberOfAffectedRows += @@ROWCOUNT;





		-- description
		UPDATE pd
		SET pd.DescricaoPontuacao += 1,
			pd.Descricao = c.Descricao,
			pd.Versao = GETDATE()
		FROM [dbo].[ProdutosDetalhe] pd
			 INNER JOIN [dbo].[CotacoesAtuaisView] c
				   ON pd.FornecedorCodigo = c.FornecedorCodigo
					  AND pd.ProdutoCodigo = c.ProdutoCodigo
		-- process only rows that are settled to update automaticaly and need description update
		WHERE pd.AtualizacaoAutomaticaInativa = CAST('false' as bit)
			  AND pd.Descricao <> c.Descricao

		-- sum to @numberOfAffectedRows
		SET @numberOfAffectedRows += @@ROWCOUNT;





		-- features
		UPDATE pd
		SET pd.CaracteristicasPontuacao += 1,
			pd.Caracteristicas = c.Caracteristicas,
			pd.Versao = GETDATE()
		FROM [dbo].[ProdutosDetalhe] pd
			 INNER JOIN [dbo].[CotacoesAtuaisView] c
				   ON pd.FornecedorCodigo = c.FornecedorCodigo
					  AND pd.ProdutoCodigo = c.ProdutoCodigo
		-- process only rows that are settled to update automaticaly and need features update
		WHERE pd.AtualizacaoAutomaticaInativa = CAST('false' as bit)
			  AND pd.Caracteristicas <> c.Caracteristicas

		-- sum to @numberOfAffectedRows
		SET @numberOfAffectedRows += @@ROWCOUNT;




		-- link
		UPDATE pd
		SET pd.LinkPontuacao += 1,
			pd.Link = c.Link,
			pd.Versao = GETDATE()
		FROM [dbo].[ProdutosDetalhe] pd
			 INNER JOIN [dbo].[CotacoesAtuaisView] c
				   ON pd.FornecedorCodigo = c.FornecedorCodigo
					  AND pd.ProdutoCodigo = c.ProdutoCodigo
		-- process only rows that are settled to update automaticaly and need link update
		WHERE pd.AtualizacaoAutomaticaInativa = CAST('false' as bit)
			  AND pd.Link <> c.Link

		-- sum to @numberOfAffectedRows
		SET @numberOfAffectedRows += @@ROWCOUNT;




		-- image
		UPDATE pd
		SET pd.ImagemPontuacao += 1,
			pd.Imagem = c.Imagem,
			pd.Versao = GETDATE()
		FROM [dbo].[ProdutosDetalhe] pd
			 INNER JOIN [dbo].[CotacoesAtuaisView] c
				   ON pd.FornecedorCodigo = c.FornecedorCodigo
					  AND pd.ProdutoCodigo = c.ProdutoCodigo
		-- process only rows that are settled to update automaticaly and need image update
		WHERE pd.AtualizacaoAutomaticaInativa = CAST('false' as bit)
			  AND pd.Imagem <> c.Imagem

		-- sum to @numberOfAffectedRows
		SET @numberOfAffectedRows += @@ROWCOUNT;





		-- notify user manual update if needed
		UPDATE pd
		SET pd.AtualizacaoManualNecessaria = CAST('true' as bit),
			pd.Versao = GETDATE()
		FROM [dbo].[ProdutosDetalhe] pd
			 INNER JOIN [dbo].[CotacoesAtuaisView] c
				   ON pd.FornecedorCodigo = c.FornecedorCodigo
					  AND pd.ProdutoCodigo = c.ProdutoCodigo
		-- filter rows needing some update and configured to do not update automaticaly
		WHERE pd.AtualizacaoAutomaticaInativa = CAST('true' as bit)
			  AND (
					pd.Descricao <> c.Descricao
					OR pd.Caracteristicas <> c.Caracteristicas
					OR pd.Link <> c.Link
					OR pd.Imagem <> c.Imagem
				  )

		-- sum to @numberOfAffectedRows
		SET @numberOfAffectedRows += @@ROWCOUNT;



		-- commit all changes
		COMMIT TRANSACTION

		-- fill output @info with sucess message
		SET @Info = '[Step4c2_Finishing_ProductsDetailUpdate-01] Total of affected rows (one product detail could be updated by several instructions): ' + CAST(@numberOfAffectedRows as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH
		-- rollback transaction
		ROLLBACK TRANSACTION

		-- fill output @info with occurred error message
		SET @Info = '[Step4c2_Finishing_ProductsDetailUpdate-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[IndicePreocupacaoConteudo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoDetalheIndicePreocupacaoFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[Caracteristicas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[AtualizacaoAutomaticaInativa]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Caracteristicas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[DescricaoPontuacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Descricao]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[CaracteristicasPontuacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Caracteristicas]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[LinkPontuacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Link]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[Link]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Link]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[ImagemPontuacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Imagem]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[Imagem]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Imagem]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[AtualizacaoManualNecessaria]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step4c2_Finishing_ProductsDetailUpdate].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step4c2_Finishing_ProductsDetailUpdate].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="113" />
				<Property Name="Length" Value="4861" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This stored procedure will update Products Detail (ProdutosDetalhe) table with recent information.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step4c2_Finishing_ProductsDetailUpdate]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[Step4c3_Finishing_ProductsDetailInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[


	BEGIN TRY

		/*
			Insert Products Detail information
		*/
		INSERT [dbo].[ProdutosDetalhe]
			   (
				  -- pk
				   FornecedorCodigo,
				   ProdutoCodigo,
		   
				   -- description
				   Descricao,
				   DescricaoPontuacao,
				   DescricaoInativa,

				   -- features
				   Caracteristicas, 
				   CaracteristicasPontuacao,
				   CaracteristicasInativas,

				   -- link
				   Link,
				   LinkPontuacao,
				   LinkInativo,

				   -- imagem
				   Imagem,
				   ImagemPontuacao,
				   ImagemInativa,

				   -- others
				   AtualizacaoAutomaticaInativa,
				   AtualizacaoManualNecessaria,
				   IndicePreocupacaoConteudo,
				   Criacao,
				   Versao
				)


		SELECT 
			   -- pk
			   c.FornecedorCodigo,
			   c.ProdutoCodigo,

			   -- description
			   c.Descricao, 
			   f.DescricaoPontuacaoInicial,
			   f.DescricaoSugereInativo,

			   -- features
			   c.Caracteristicas,
			   f.CaracteristicasPontuacaoInicial,
			   f.CaracteristicasSugereInativo,

			   -- link
			   c.Link,
			   f.LinkPontuacaoInicial,
			   f.LinkSugereInativo,

			   -- image
			   c.Imagem,
			   f.ImagemPontuacaoInicial,
			   f.ImagemSugereInativo,

			   -- others
			   f.AtualizacaoAutomaticaInativaSugestao,
			   CAST('false' as bit),
			   [dbo].[GetProdutoDetalheIndicePreocupacaoFunction](c.Descricao, c.Caracteristicas),
			   GETDATE(),
			   GETDATE()

		FROM [dbo].[CotacoesAtuaisView] c
			 INNER JOIN (

							-- set of Actual Quotations not in ProdutosDetalhe
							SELECT DISTINCT FornecedorCodigo, ProdutoCodigo
							FROM [dbo].[CotacoesAtuaisView]
					
							EXCEPT
					
							SELECT FornecedorCodigo, ProdutoCodigo
							FROM [dbo].[ProdutosDetalhe]

						) nd
							ON c.FornecedorCodigo = nd.FornecedorCodigo
							   AND c.ProdutoCodigo = nd.ProdutoCodigo
			 INNER JOIN [dbo].[Fornecedores] f
				   ON c.FornecedorCodigo = f.Codigo




		-- fill output @info with sucess message
		SET @Info = '[Step4c3_Finishing_ProductsDetailInsert-01] Total of inserted Product Details: ' + CAST(@@ROWCOUNT as nvarchar);

		-- send true to output
		RETURN 1;

	END TRY

	BEGIN CATCH

		-- fill output @info with occurred error message
		SET @Info = '[Step4c3_Finishing_ProductsDetailInsert-02] ' + CAST(ERROR_NUMBER() as nvarchar) + ' - ' + ERROR_MESSAGE();

		-- send false to output
		RETURN 0;

	END CATCH

RETURN;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[DescricaoPontuacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[DescricaoInativa]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Caracteristicas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[CaracteristicasPontuacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[CaracteristicasInativas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Link]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[LinkPontuacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[LinkInativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Imagem]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[ImagemPontuacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[ImagemInativa]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[AtualizacaoAutomaticaInativa]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[AtualizacaoManualNecessaria]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[IndicePreocupacaoConteudo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ProdutosDetalhe].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[ProdutoCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[DescricaoPontuacaoInicial]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[DescricaoSugereInativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[Caracteristicas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[CaracteristicasPontuacaoInicial]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[CaracteristicasSugereInativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[Link]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[LinkPontuacaoInicial]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[LinkSugereInativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CotacoesAtuaisView].[Imagem]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ImagemPontuacaoInicial]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ImagemSugereInativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[AtualizacaoAutomaticaInativaSugestao]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetProdutoDetalheIndicePreocupacaoFunction]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Step4c3_Finishing_ProductsDetailInsert].[@Info]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[Step4c3_Finishing_ProductsDetailInsert].[@Info]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="89" />
				<Property Name="Length" Value="2655" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This stored procedure will insert Products Detail (ProdutosDetalhe) table.&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;CREATE PROCEDURE [dbo].[Step4c3_Finishing_ProductsDetailInsert]&#xD;&#xA;&#x9;@Info nvarchar(256) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[StockCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([Codigo]) FROM [dbo].[Stocks]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="542" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[StockCount]&#xD;&#xA;&#x9;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[StockDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Stocks] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Stocks] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D02] ' + 'O registo que pretende eliminar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].[Stocks] Where [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockDelete].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockDelete].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockDelete].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockDelete].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1522" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[StockDelete]&#xD;&#xA;&#x9;@Codigo nvarchar(128),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[StockInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Criacao smalldatetime, @Versao datetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Criacao = GETDATE()
	SET @Versao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[Stocks] ([Codigo], [Descricao], [DisponibilidadeNivel], [ValidadeP50_StockCodigo],
						[ValidadeP60_StockCodigo], [ValidadeP70_StockCodigo], [ValidadeP80_StockCodigo], [ValidadeP90_StockCodigo],
						[Notas], [Inativo], [Criacao], [Versao]) 
					VALUES ( @Codigo, @Descricao, @DisponibilidadeNivel, @ValidadeP50_StockCodigo, 
						@ValidadeP60_StockCodigo, @ValidadeP70_StockCodigo, @ValidadeP80_StockCodigo, @ValidadeP90_StockCodigo, 
						@Notas, @Inativo, @Criacao, @Versao);
		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[DisponibilidadeNivel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[ValidadeP50_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[ValidadeP60_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[ValidadeP70_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[ValidadeP80_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[ValidadeP90_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockInsert].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockInsert].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockInsert].[@DisponibilidadeNivel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockInsert].[@ValidadeP50_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockInsert].[@ValidadeP60_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockInsert].[@ValidadeP70_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockInsert].[@ValidadeP80_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockInsert].[@ValidadeP90_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockInsert].[@Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockInsert].[@Inativo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockInsert].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockInsert].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockInsert].[@DisponibilidadeNivel]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockInsert].[@ValidadeP50_StockCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockInsert].[@ValidadeP60_StockCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockInsert].[@ValidadeP70_StockCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockInsert].[@ValidadeP80_StockCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockInsert].[@ValidadeP90_StockCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockInsert].[@Notas]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockInsert].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1728" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[StockInsert]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Descricao nvarchar(50),&#xD;&#xA;&#x9;@DisponibilidadeNivel smallint,&#xD;&#xA;&#x9;@ValidadeP50_StockCodigo nvarchar(5),&#xD;&#xA;&#x9;@ValidadeP60_StockCodigo nvarchar(5),&#xD;&#xA;&#x9;@ValidadeP70_StockCodigo nvarchar(5),&#xD;&#xA;&#x9;@ValidadeP80_StockCodigo nvarchar(5),&#xD;&#xA;&#x9;@ValidadeP90_StockCodigo nvarchar(5),&#xD;&#xA;&#x9;@Notas nvarchar(256),&#xD;&#xA;&#x9;@Inativo bit&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[StockMatchingCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([Codigo]) FROM [dbo].[StocksMatching]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockMatchingCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockMatchingCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="558" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[StockMatchingCount]&#xD;&#xA;&#x9;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[StockMatchingDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[StocksMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[StocksMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D02] ' + 'O registo que pretende eliminar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].[StocksMatching] Where [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockMatchingDelete].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockMatchingDelete].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockMatchingDelete].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockMatchingDelete].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockMatchingDelete].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockMatchingDelete].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1716" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[StockMatchingDelete]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@Codigo nvarchar(128),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[StockMatchingInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Criacao smalldatetime, @Versao datetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Criacao = GETDATE()
	SET @Versao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[StocksMatching] ([FornecedorCodigo], [Codigo], [Descricao], [MapTo], [Inativo], [Criacao], [Versao]) 
					VALUES (@FornecedorCodigo, @Codigo, @Descricao, @MapTo, @Inativo, @Criacao, @Versao);
		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockMatchingInsert].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockMatchingInsert].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockMatchingInsert].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockMatchingInsert].[@MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockMatchingInsert].[@Inativo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockMatchingInsert].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockMatchingInsert].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockMatchingInsert].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockMatchingInsert].[@MapTo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockMatchingInsert].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1240" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[StockMatchingInsert]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@Codigo nvarchar(128),&#xD;&#xA;&#x9;@Descricao nvarchar(128),&#xD;&#xA;&#x9;@MapTo nvarchar(5),&#xD;&#xA;&#x9;@Inativo bit&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[StockMatchingSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT matching.[FornecedorCodigo], fornecedores.[Nome] as FornecedorNome, matching.[Codigo], matching.[Descricao], 
							matching.[MapTo], matching.[Inativo], matching.[Criacao], matching.[Versao]				
						FROM [dbo].[StocksMatching] matching 
						INNER JOIN [dbo].[Fornecedores] fornecedores
							ON matching.[FornecedorCodigo] = fornecedores.[Codigo] AND fornecedores.[INATIVO]='+'''FALSE'''
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockMatchingSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockMatchingSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockMatchingSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockMatchingSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1114" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[StockMatchingSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[StockMatchingUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[StocksMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[StocksMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U02] ' + 'O registo que pretende alterar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NovaVersao datetime, @NumeroLinhasAfetadas int

	SET @NovaVersao = GETDATE()


	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[StocksMatching] SET [Descricao] = @Descricao,
									[MapTo] = @MapTo,
									[Inativo] = @Inativo,
									[Versao] = @NovaVersao
								WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockMatchingUpdate].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockMatchingUpdate].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockMatchingUpdate].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockMatchingUpdate].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockMatchingUpdate].[@MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockMatchingUpdate].[@Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StocksMatching].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockMatchingUpdate].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockMatchingUpdate].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockMatchingUpdate].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockMatchingUpdate].[@MapTo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockMatchingUpdate].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockMatchingUpdate].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1960" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[StockMatchingUpdate]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@Codigo nvarchar(128),&#xD;&#xA;&#x9;@Descricao nvarchar(128),&#xD;&#xA;&#x9;@MapTo nvarchar(5),&#xD;&#xA;&#x9;@Inativo bit,&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Stocks]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Stocks].[Codigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Stocks].[Descricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Stocks].[DisponibilidadeNivel]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Stocks].[ValidadeP50_StockCodigo]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Stocks].[ValidadeP60_StockCodigo]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Stocks].[ValidadeP70_StockCodigo]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Stocks].[ValidadeP80_StockCodigo]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Stocks].[ValidadeP90_StockCodigo]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Stocks].[Notas]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Stocks].[Inativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Stocks].[Criacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Stocks].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="88" />
						<AttachedAnnotation Disambiguator="66" />
						<AttachedAnnotation Disambiguator="67" />
						<AttachedAnnotation Disambiguator="68" />
						<AttachedAnnotation Disambiguator="69" />
						<AttachedAnnotation Disambiguator="70" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[StockSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT stocks.[Codigo], stocks.[Descricao], stocks.[DisponibilidadeNivel],
							stocks.[ValidadeP50_StockCodigo] as ValidadeP50Codigo, 
							stocks.[ValidadeP60_StockCodigo] as ValidadeP60Codigo, 
							stocks.[ValidadeP70_StockCodigo] as ValidadeP70Codigo, 
							stocks.[ValidadeP80_StockCodigo] as ValidadeP80Codigo, 
							stocks.[ValidadeP90_StockCodigo] as ValidadeP90Codigo, 
							stocks.[Notas], stocks.[Inativo], stocks.[Criacao], stocks.[Versao]				
						FROM [dbo].[Stocks] stocks'
							
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1219" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[StockSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[StocksMatching]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[StocksMatching].[FornecedorCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[StocksMatching].[Codigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[StocksMatching].[Descricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[StocksMatching].[MapTo]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[StocksMatching].[Inativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[StocksMatching].[Criacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[StocksMatching].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="89" />
						<AttachedAnnotation Disambiguator="71" />
						<AttachedAnnotation Disambiguator="72" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[StockUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Stocks] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Stocks] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U02] ' + 'O registo que pretende alterar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NovaVersao datetime, @NumeroLinhasAfetadas int

	SET @NovaVersao = GETDATE()


	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[Stocks] SET [Descricao] = @Descricao,
									[DisponibilidadeNivel] = @DisponibilidadeNivel, 
									[ValidadeP50_StockCodigo] = @ValidadeP50_StockCodigo,
									[ValidadeP60_StockCodigo] = @ValidadeP60_StockCodigo, 
									[ValidadeP70_StockCodigo] = @ValidadeP70_StockCodigo, 
									[ValidadeP80_StockCodigo] = @ValidadeP80_StockCodigo, 
									[ValidadeP90_StockCodigo] = @ValidadeP90_StockCodigo,
									[Notas] = @Notas,
									[Inativo] = @Inativo,
									[Versao] = @NovaVersao
								WHERE [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockUpdate].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockUpdate].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockUpdate].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[DisponibilidadeNivel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockUpdate].[@DisponibilidadeNivel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[ValidadeP50_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockUpdate].[@ValidadeP50_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[ValidadeP60_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockUpdate].[@ValidadeP60_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[ValidadeP70_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockUpdate].[@ValidadeP70_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[ValidadeP80_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockUpdate].[@ValidadeP80_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[ValidadeP90_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockUpdate].[@ValidadeP90_StockCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockUpdate].[@Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StockUpdate].[@Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Stocks].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockUpdate].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockUpdate].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockUpdate].[@DisponibilidadeNivel]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockUpdate].[@ValidadeP50_StockCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockUpdate].[@ValidadeP60_StockCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockUpdate].[@ValidadeP70_StockCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockUpdate].[@ValidadeP80_StockCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockUpdate].[@ValidadeP90_StockCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockUpdate].[@Notas]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockUpdate].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StockUpdate].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="2381" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[StockUpdate]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Descricao nvarchar(50),&#xD;&#xA;&#x9;@DisponibilidadeNivel smallint,&#xD;&#xA;&#x9;@ValidadeP50_StockCodigo nvarchar(5),&#xD;&#xA;&#x9;@ValidadeP60_StockCodigo nvarchar(5),&#xD;&#xA;&#x9;@ValidadeP70_StockCodigo nvarchar(5),&#xD;&#xA;&#x9;@ValidadeP80_StockCodigo nvarchar(5),&#xD;&#xA;&#x9;@ValidadeP90_StockCodigo nvarchar(5),&#xD;&#xA;&#x9;@Notas nvarchar(256),&#xD;&#xA;&#x9;@Inativo bit,&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlScalarFunction" Name="[dbo].[StripHtmlTagsFunction]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[StripHtmlTagsFunction].[@text]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN

	-- variables
	DECLARE @start integer, @end integer, @length integer;

	-- set initial values
	SET @start = CHARINDEX('<', @text);			-- get position of first occurrence of <
	SET @end = CHARINDEX('>', @text, @start);	-- get position of first occurrence of > after @start
	SET @length = (@end - @start) + 1;

	-- iterate while there is at least one > and <
	WHILE @start > 0 AND @end > 0 AND @length > 0
	BEGIN
		
		-- replace set of text inside @text
		SET @text = STUFF(@text, @start, @length, '');
		
		-- prepare a new iteration
		SET @start = CHARINDEX('<', @text);
		SET @end = CHARINDEX('>', @text, @start);
		SET @length = (@end - @start) + 1;

	END

	-- remove extra long line feeding
	SET @text = REPLACE(@text, CHAR(10) + CHAR(13) + CHAR(10) + CHAR(13) + CHAR(10) + CHAR(13) + CHAR(10) + CHAR(13) + CHAR(10) + CHAR(13), CHAR(10) + CHAR(13));
	SET @text = REPLACE(@text, CHAR(10) + CHAR(13) + CHAR(10) + CHAR(13) + CHAR(10) + CHAR(13) + CHAR(10) + CHAR(13), CHAR(10) + CHAR(13));
	SET @text = REPLACE(@text, CHAR(10) + CHAR(13) + CHAR(10) + CHAR(13) + CHAR(10) + CHAR(13), CHAR(10) + CHAR(13));
	SET @text = REPLACE(@text, CHAR(10) + CHAR(13) + CHAR(10) + CHAR(13), CHAR(10) + CHAR(13));

	-- remove other html stuff
	SET @text = REPLACE(@text, '&nbsp;', '');
	SET @text = REPLACE(@text, '&tab;', '');
	SET @text = REPLACE(@text, '&newline;', '');
	SET @text = REPLACE(@text, '&quot;', '');
	SET @text = REPLACE(@text, '&num;', '');
	SET @text = REPLACE(@text, '&percnt;', '%');
	SET @text = REPLACE(@text, '&amp;', '&');
	SET @text = REPLACE(@text, '&apos;', '');
	SET @text = REPLACE(@text, '&comma;', ',');
	SET @text = REPLACE(@text, '&period;', '.');
	SET @text = REPLACE(@text, '&sol;', '/');
	SET @text = REPLACE(@text, '&colon;', ':');
	SET @text = REPLACE(@text, '&semi;', ';');
	SET @text = REPLACE(@text, '&plus;', '+');
	SET @text = REPLACE(@text, '&lt;', '<');
	SET @text = REPLACE(@text, '&equals;', '=');
	SET @text = REPLACE(@text, '&gt;', '>');
	SET @text = REPLACE(@text, '&quest;', '?');
	SET @text = REPLACE(@text, '&commat;', '@');
	SET @text = REPLACE(@text, '&bsol;', '\');
	SET @text = REPLACE(@text, '&reg;', '(R)');
	SET @text = REPLACE(@text, '&copy;', '(C)');
	SET @text = REPLACE(@text, '&deg;', 'º');

	-- clean leading spaces
	SET @text = LTRIM(RTRIM(@text));

	-- return stripped text
	RETURN @text;

END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="59" />
							<Property Name="Length" Value="2572" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="/*&#xD;&#xA;&#x9;This function strips all http tags from string&#xD;&#xA;*/&#xD;&#xA;&#xD;&#xA;CREATE FUNCTION [dbo].StripHtmlTagsFunction&#xD;&#xA;(&#xD;&#xA;&#x9;@text nvarchar(MAX)&#xD;&#xA;)&#xD;&#xA;RETURNS nvarchar(MAX)&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[StripHtmlTagsFunction].[@text]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Type">
				<Entry>
					<Element Type="SqlTypeSpecifier">
						<Property Name="IsMax" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<References ExternalSource="BuiltIns" Name="[nvarchar]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Subgrupos]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Subgrupos].[Codigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Subgrupos].[Descricao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Subgrupos].[GrupoCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Subgrupos].[Inativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Subgrupos].[Criacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Subgrupos].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="90" />
						<AttachedAnnotation Disambiguator="73" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[SubgruposClasses]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[SubgruposClasses].[SubgrupoCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[SubgruposClasses].[ClasseCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[SubgruposClasses].[Notas]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[SubgruposClasses].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="91" />
						<AttachedAnnotation Disambiguator="75" />
						<AttachedAnnotation Disambiguator="74" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[SupplementCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([Codigo]) FROM [dbo].[Complementos]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="553" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[SupplementCount]&#xD;&#xA;&#x9;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[SupplementDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Complementos] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Complementos] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D02] ' + 'O registo que pretende eliminar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].[Complementos] Where [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementDelete].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementDelete].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementDelete].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementDelete].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1543" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[SupplementDelete]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[SupplementInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Criacao smalldatetime, @Versao datetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Criacao = GETDATE()
	SET @Versao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[Complementos] ([Codigo], [Descricao], [TermoAcrescentar], [TermosRemover], [Inativo], [Criacao], [Versao]) 
					VALUES (@Codigo, @Descricao, @TermoAcrescentar, @TermosRemover, @Inativo, @Criacao, @Versao);
		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos].[TermoAcrescentar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos].[TermosRemover]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementInsert].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementInsert].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementInsert].[@TermoAcrescentar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementInsert].[@TermosRemover]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementInsert].[@Inativo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementInsert].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementInsert].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementInsert].[@TermoAcrescentar]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementInsert].[@TermosRemover]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementInsert].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1253" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [SupplementInsert]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Descricao nvarchar(50),&#xD;&#xA;&#x9;@TermoAcrescentar nvarchar(50),&#xD;&#xA;&#x9;@TermosRemover nvarchar(100),&#xD;&#xA;&#x9;@Inativo bit&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[SupplementMatchingCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([Codigo]) FROM [dbo].[ComplementosMatching]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementMatchingCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementMatchingCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="569" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[SupplementMatchingCount]&#xD;&#xA;&#x9;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[SupplementMatchingDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[ComplementosMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[ComplementosMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D02] ' + 'O registo que pretende eliminar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].[ComplementosMatching] Where [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementMatchingDelete].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementMatchingDelete].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementMatchingDelete].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementMatchingDelete].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementMatchingDelete].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementMatchingDelete].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1739" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[SupplementMatchingDelete]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@Codigo nvarchar(128),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[SupplementMatchingInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Criacao smalldatetime, @Versao datetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Criacao = GETDATE()
	SET @Versao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[ComplementosMatching] ([FornecedorCodigo], [Codigo], [Descricao], [MapTo], [Inativo], [Criacao], [Versao]) 
					VALUES (@FornecedorCodigo, @Codigo, @Descricao, @MapTo, @Inativo, @Criacao, @Versao);
		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementMatchingInsert].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementMatchingInsert].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementMatchingInsert].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementMatchingInsert].[@MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementMatchingInsert].[@Inativo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementMatchingInsert].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementMatchingInsert].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementMatchingInsert].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementMatchingInsert].[@MapTo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementMatchingInsert].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1251" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[SupplementMatchingInsert]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@Codigo nvarchar(128),&#xD;&#xA;&#x9;@Descricao nvarchar(128),&#xD;&#xA;&#x9;@MapTo nvarchar(5),&#xD;&#xA;&#x9;@Inativo bit&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[SupplementMatchingSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT matching.[FornecedorCodigo], fornecedores.[Nome] as FornecedorNome, matching.[Codigo], matching.[Descricao], 
							matching.[MapTo], matching.[Inativo], matching.[Criacao], matching.[Versao]				
						FROM [dbo].[ComplementosMatching] matching 
						INNER JOIN [dbo].[Fornecedores] fornecedores
							ON matching.[FornecedorCodigo] = fornecedores.[Codigo] AND fornecedores.[INATIVO]='+'''FALSE'''
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementMatchingSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementMatchingSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementMatchingSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementMatchingSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1125" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[SupplementMatchingSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[SupplementMatchingUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[ComplementosMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[ComplementosMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U02] ' + 'O registo que pretende alterar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NovaVersao datetime, @NumeroLinhasAfetadas int

	SET @NovaVersao = GETDATE()


	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[ComplementosMatching] SET [Descricao] = @Descricao,
									[MapTo] = @MapTo,
									[Inativo] = @Inativo,
									[Versao] = @NovaVersao
								WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementMatchingUpdate].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementMatchingUpdate].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementMatchingUpdate].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementMatchingUpdate].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementMatchingUpdate].[@MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementMatchingUpdate].[@Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ComplementosMatching].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementMatchingUpdate].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementMatchingUpdate].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementMatchingUpdate].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementMatchingUpdate].[@MapTo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementMatchingUpdate].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementMatchingUpdate].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1983" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[SupplementMatchingUpdate]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@Codigo nvarchar(128),&#xD;&#xA;&#x9;@Descricao nvarchar(128),&#xD;&#xA;&#x9;@MapTo nvarchar(5),&#xD;&#xA;&#x9;@Inativo bit,&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[SupplementSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT c.[Codigo], c.[Descricao], c.[TermoAcrescentar], c.[TermosRemover], c.[Inativo], c.[Criacao], c.[Versao]				
						FROM [dbo].[Complementos] c' 
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="858" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[SupplementSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[SupplementUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Complementos] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Complementos] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U02] ' + 'O registo que pretende alterar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NovaVersao datetime, @NumeroLinhasAfetadas int

	SET @NovaVersao = GETDATE()


	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[Complementos] SET [Descricao] = @Descricao,
									[TermoAcrescentar] = @TermoAcrescentar,
									[TermosRemover] = @TermosRemover,
									[Inativo] = @Inativo,
									[Versao] = @NovaVersao
								WHERE [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementUpdate].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementUpdate].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementUpdate].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos].[TermoAcrescentar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementUpdate].[@TermoAcrescentar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos].[TermosRemover]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementUpdate].[@TermosRemover]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplementUpdate].[@Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Complementos].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementUpdate].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementUpdate].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementUpdate].[@TermoAcrescentar]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementUpdate].[@TermosRemover]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementUpdate].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplementUpdate].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1896" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[SupplementUpdate]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Descricao nvarchar(50),&#xD;&#xA;&#x9;@TermoAcrescentar nvarchar(50),&#xD;&#xA;&#x9;@TermosRemover nvarchar(100),&#xD;&#xA;&#x9;@Inativo bit,&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[SupplierBrandCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([FornecedorCodigo]) FROM [dbo].[FornecedoresMarcas]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierBrandCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierBrandCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="572" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[SupplierBrandCount]&#xD;&#xA;&#x9;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[SupplierBrandDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [FornecedorCodigo] FROM [dbo].[FornecedoresMarcas] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [MarcaCodigo] = @MarcaCodigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [FornecedorCodigo] FROM [dbo].[FornecedoresMarcas] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [MarcaCodigo] = @MarcaCodigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D02] ' + 'O registo que pretende eliminar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].[FornecedoresMarcas] Where [FornecedorCodigo] = @FornecedorCodigo AND [MarcaCodigo] = @MarcaCodigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierBrandDelete].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierBrandDelete].[@MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierBrandDelete].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas].[MarcaCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierBrandDelete].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierBrandDelete].[@MarcaCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierBrandDelete].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1781" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[SupplierBrandDelete]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@MarcaCodigo nvarchar(5),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[SupplierBrandInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE  @Versao datetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Versao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[FornecedoresMarcas] ([FornecedorCodigo], [MarcaCodigo], [Confianca], [Notas], [Versao]) 
					VALUES (@FornecedorCodigo, @MarcaCodigo, @Confianca, @Notas, @Versao);
		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas].[Confianca]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas].[Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierBrandInsert].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierBrandInsert].[@MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierBrandInsert].[@Confianca]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierBrandInsert].[@Notas]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierBrandInsert].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierBrandInsert].[@MarcaCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierBrandInsert].[@Confianca]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierBrandInsert].[@Notas]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1143" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[SupplierBrandInsert]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@MarcaCodigo nvarchar(5),&#xD;&#xA;&#x9;@Confianca float,&#xD;&#xA;&#x9;@Notas nvarchar(256)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[SupplierBrandSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT fm.[FornecedorCodigo], fornecedores.[Nome] as FornecedorNome, fm.[MarcaCodigo], marcas.[Descricao] as MarcaDescricao, fm.[Confianca], 
							fm.[Notas], fm.[Versao]				
						FROM [dbo].[FornecedoresMarcas] fm 
						INNER JOIN [dbo].[Fornecedores] fornecedores
							ON fm.[FornecedorCodigo] = fornecedores.[Codigo] AND fornecedores.[INATIVO]='+'''FALSE'''+
						'INNER JOIN [dbo].[Marcas] marcas
							ON fm.[MarcaCodigo] = marcas.[Codigo] AND marcas.[INATIVO]='+'''FALSE'''
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierBrandSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierBrandSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierBrandSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierBrandSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1202" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[SupplierBrandSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[SupplierBrandUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [FornecedorCodigo] FROM [dbo].[FornecedoresMarcas] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [MarcaCodigo] = @MarcaCodigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [FornecedorCodigo] FROM [dbo].[FornecedoresMarcas] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [MarcaCodigo] = @MarcaCodigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U02] ' + 'O registo que pretende alterar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NovaVersao datetime, @NumeroLinhasAfetadas int

	SET @NovaVersao = GETDATE()


	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[FornecedoresMarcas] SET [Confianca] = @Confianca,
									[Notas] = @Notas,
									[Versao] = @NovaVersao
								WHERE [FornecedorCodigo] = @FornecedorCodigo AND [MarcaCodigo] = @MarcaCodigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierBrandUpdate].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas].[MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierBrandUpdate].[@MarcaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierBrandUpdate].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas].[Confianca]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierBrandUpdate].[@Confianca]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas].[Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierBrandUpdate].[@Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[FornecedoresMarcas].[MarcaCodigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierBrandUpdate].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierBrandUpdate].[@MarcaCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierBrandUpdate].[@Confianca]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierBrandUpdate].[@Notas]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierBrandUpdate].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1971" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[SupplierBrandUpdate]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@MarcaCodigo nvarchar(5),&#xD;&#xA;&#x9;@Confianca float,&#xD;&#xA;&#x9;@Notas nvarchar(256),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[SupplierCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([Codigo]) FROM [dbo].[Fornecedores]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="551" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[SupplierCount]&#xD;&#xA;&#x9;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[SupplierDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Fornecedores] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Fornecedores] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D02] ' + 'O registo que pretende eliminar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].[Fornecedores] Where [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierDelete].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierDelete].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierDelete].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierDelete].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1541" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[SupplierDelete]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[SupplierInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Criacao smalldatetime, @Versao datetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Criacao = GETDATE()
	SET @Versao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[Fornecedores] ([Codigo], [Nome], [Morada], [CodigoPostal], [LocalidadePostal], [Contribuinte], 
											[Vendedor], [Telefone], [Telemovel], [SMS], [Email], [AcessoOnlineAtivo], 
											[Username], [Password], [HorasValidadeSugestao], [ProdutosMatchingAutomatico], 
											[ProdutosCriacaoAutomatica], [DisponibilizaInfoProdutoDetalhe], 
											[DescricaoPontuacaoInicial], [CaracteristicasPontuacaoInicial], 
											[LinkPontuacaoInicial], [ImagemPontuacaoInicial], [DescricaoSugereInativo], 
											[CaracteristicasSugereInativo], [LinkSugereInativo], [ImagemSugereInativo], 
											[AtualizacaoAutomaticaInativaSugestao], [ProdutosConfiancaPreco], 
											[ProdutosConfiancaDisponibilidade], [IndiceConfianca], [Inativo], [Criacao], [Versao])
 
					VALUES (@Codigo, @Nome, @Morada, @CodigoPostal, @LocalidadePostal, @Contribuinte, 
											@Vendedor, @Telefone, @Telemovel, @SMS, @Email, @AcessoOnlineAtivo, 
											@Username, @Password, @HorasValidadeSugestao, @ProdutosMatchingAutomatico, 
											@ProdutosCriacaoAutomatica, @DisponibilizaInfoProdutoDetalhe, 
											@DescricaoPontuacaoInicial, @CaracteristicasPontuacaoInicial, 
											@LinkPontuacaoInicial, @ImagemPontuacaoInicial, @DescricaoSugereInativo, 
											@CaracteristicasSugereInativo, @LinkSugereInativo, @ImagemSugereInativo, 
											@AtualizacaoAutomaticaInativaSugestao, @ProdutosConfiancaPreco, 
											@ProdutosConfiancaDisponibilidade, @IndiceConfianca, @Inativo, @Criacao, @Versao);

		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Nome]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Morada]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[CodigoPostal]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[LocalidadePostal]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Contribuinte]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Vendedor]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Telefone]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Telemovel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[SMS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[AcessoOnlineAtivo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Username]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Password]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[HorasValidadeSugestao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ProdutosMatchingAutomatico]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ProdutosCriacaoAutomatica]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[DisponibilizaInfoProdutoDetalhe]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[DescricaoPontuacaoInicial]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[CaracteristicasPontuacaoInicial]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[LinkPontuacaoInicial]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ImagemPontuacaoInicial]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[DescricaoSugereInativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[CaracteristicasSugereInativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[LinkSugereInativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ImagemSugereInativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[AtualizacaoAutomaticaInativaSugestao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ProdutosConfiancaPreco]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ProdutosConfiancaDisponibilidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[IndiceConfianca]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@Nome]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@Morada]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@CodigoPostal]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@LocalidadePostal]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@Contribuinte]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@Vendedor]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@Telefone]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@Telemovel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@SMS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@AcessoOnlineAtivo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@Username]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@Password]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@HorasValidadeSugestao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@ProdutosMatchingAutomatico]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@ProdutosCriacaoAutomatica]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@DisponibilizaInfoProdutoDetalhe]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@DescricaoPontuacaoInicial]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@CaracteristicasPontuacaoInicial]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@LinkPontuacaoInicial]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@ImagemPontuacaoInicial]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@DescricaoSugereInativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@CaracteristicasSugereInativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@LinkSugereInativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@ImagemSugereInativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@AtualizacaoAutomaticaInativaSugestao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@ProdutosConfiancaPreco]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@ProdutosConfiancaDisponibilidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@IndiceConfianca]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierInsert].[@Inativo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@Nome]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@Morada]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="200" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@CodigoPostal]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="15" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@LocalidadePostal]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@Contribuinte]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@Vendedor]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@Telefone]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@Telemovel]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="15" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@SMS]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="15" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@Email]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@AcessoOnlineAtivo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@Username]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@Password]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@HorasValidadeSugestao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@ProdutosMatchingAutomatico]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@ProdutosCriacaoAutomatica]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@DisponibilizaInfoProdutoDetalhe]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@DescricaoPontuacaoInicial]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@CaracteristicasPontuacaoInicial]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@LinkPontuacaoInicial]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@ImagemPontuacaoInicial]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@DescricaoSugereInativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@CaracteristicasSugereInativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@LinkSugereInativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@ImagemSugereInativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@AtualizacaoAutomaticaInativaSugestao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@ProdutosConfiancaPreco]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@ProdutosConfiancaDisponibilidade]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@IndiceConfianca]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierInsert].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="3440" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[SupplierInsert]&#xD;&#xA;&#x9;@Codigo nvarchar(5), &#xD;&#xA;&#x9;@Nome nvarchar(50), &#xD;&#xA;&#x9;@Morada nvarchar(200), &#xD;&#xA;&#x9;@CodigoPostal nvarchar(15),&#xD;&#xA;&#x9;@LocalidadePostal nvarchar(50), &#xD;&#xA;&#x9;@Contribuinte nvarchar(20), &#xD;&#xA;&#x9;@Vendedor nvarchar(50), &#xD;&#xA;&#x9;@Telefone nvarchar(20), &#xD;&#xA;&#x9;@Telemovel nvarchar(15), &#xD;&#xA;&#x9;@SMS nvarchar(15), &#xD;&#xA;&#x9;@Email nvarchar(100), &#xD;&#xA;&#x9;@AcessoOnlineAtivo bit, &#xD;&#xA;&#x9;@Username nvarchar(20), &#xD;&#xA;&#x9;@Password nvarchar(20), &#xD;&#xA;&#x9;@HorasValidadeSugestao smallint, &#xD;&#xA;&#x9;@ProdutosMatchingAutomatico bit, &#xD;&#xA;&#x9;@ProdutosCriacaoAutomatica bit, &#xD;&#xA;&#x9;@DisponibilizaInfoProdutoDetalhe bit, &#xD;&#xA;&#x9;@DescricaoPontuacaoInicial smallint, &#xD;&#xA;&#x9;@CaracteristicasPontuacaoInicial smallint, &#xD;&#xA;&#x9;@LinkPontuacaoInicial smallint, &#xD;&#xA;&#x9;@ImagemPontuacaoInicial smallint, &#xD;&#xA;&#x9;@DescricaoSugereInativo bit, &#xD;&#xA;&#x9;@CaracteristicasSugereInativo bit, &#xD;&#xA;&#x9;@LinkSugereInativo bit, &#xD;&#xA;&#x9;@ImagemSugereInativo bit, &#xD;&#xA;&#x9;@AtualizacaoAutomaticaInativaSugestao bit, &#xD;&#xA;&#x9;@ProdutosConfiancaPreco float, &#xD;&#xA;&#x9;@ProdutosConfiancaDisponibilidade float, &#xD;&#xA;&#x9;@IndiceConfianca float, &#xD;&#xA;&#x9;@Inativo bit &#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[SupplierSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT f.[Codigo], f.[Nome], f.[Morada], 
							f.[CodigoPostal], f.[LocalidadePostal], 
							f.[Contribuinte], f.[Vendedor], 
							f.[Telefone], f.[Telemovel], 
							f.[SMS], f.[Email], 
							f.[AcessoOnlineAtivo], 
							f.[Username], f.[Password], 
							f.[HorasValidadeSugestao], 
							f.[ProdutosMatchingAutomatico], 
							f.[ProdutosCriacaoAutomatica], 
							f.[DisponibilizaInfoProdutoDetalhe], 
							f.[DescricaoPontuacaoInicial], 
							f.[CaracteristicasPontuacaoInicial], 
							f.[LinkPontuacaoInicial], 
							f.[ImagemPontuacaoInicial], 
							f.[DescricaoSugereInativo], 
							f.[CaracteristicasSugereInativo], 
							f.[LinkSugereInativo], 
							f.[ImagemSugereInativo], 
							f.[AtualizacaoAutomaticaInativaSugestao], 
							f.[ProdutosConfiancaPreco], 
							f.[ProdutosConfiancaDisponibilidade], 
							f.[Inativo], f.[Criacao], 
							f.[Versao] 
						FROM [dbo].[Fornecedores] f' 
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1665" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[SupplierSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[SupplierUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Fornecedores] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Fornecedores] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U02] ' + 'O registo que pretende alterar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NovaVersao datetime, @NumeroLinhasAfetadas int

	SET @NovaVersao = GETDATE()


	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[Fornecedores] SET [Nome]=@Nome, 
										[Morada]=@Morada, 
										[CodigoPostal]=@CodigoPostal, 
										[LocalidadePostal]=@LocalidadePostal, 
										[Contribuinte]=@Contribuinte, 
										[Vendedor]=@Vendedor, 
										[Telefone]=@Telefone, 
										[Telemovel]=@Telemovel, 
										[SMS]=@SMS, 
										[Email]=@Email, 
										[AcessoOnlineAtivo]=@AcessoOnlineAtivo, 
										[Username]=@Username, 
										[Password]=@Password, 
										[HorasValidadeSugestao]=@HorasValidadeSugestao, 
										[ProdutosMatchingAutomatico]=@ProdutosMatchingAutomatico, 
										[ProdutosCriacaoAutomatica]=@ProdutosCriacaoAutomatica, 
										[DisponibilizaInfoProdutoDetalhe]=@DisponibilizaInfoProdutoDetalhe, 
										[DescricaoPontuacaoInicial]=@DescricaoPontuacaoInicial, 
										[CaracteristicasPontuacaoInicial]=@CaracteristicasPontuacaoInicial, 
										[LinkPontuacaoInicial]=@LinkPontuacaoInicial, 
										[ImagemPontuacaoInicial]=@ImagemPontuacaoInicial, 
										[DescricaoSugereInativo]=@DescricaoSugereInativo, 
										[CaracteristicasSugereInativo]=@CaracteristicasSugereInativo, 
										[LinkSugereInativo]=@LinkSugereInativo, 
										[ImagemSugereInativo]=@ImagemSugereInativo, 
										[AtualizacaoAutomaticaInativaSugestao]=@AtualizacaoAutomaticaInativaSugestao, 
										[ProdutosConfiancaPreco]=@ProdutosConfiancaPreco, 
										[ProdutosConfiancaDisponibilidade]=@ProdutosConfiancaDisponibilidade, 
										[IndiceConfianca]=@IndiceConfianca, 
										[Inativo]=@Inativo,
										[Versao] = @NovaVersao
								WHERE [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Nome]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@Nome]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Morada]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@Morada]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[CodigoPostal]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@CodigoPostal]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[LocalidadePostal]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@LocalidadePostal]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Contribuinte]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@Contribuinte]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Vendedor]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@Vendedor]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Telefone]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@Telefone]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Telemovel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@Telemovel]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[SMS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@SMS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[AcessoOnlineAtivo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@AcessoOnlineAtivo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Username]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@Username]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Password]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@Password]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[HorasValidadeSugestao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@HorasValidadeSugestao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ProdutosMatchingAutomatico]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@ProdutosMatchingAutomatico]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ProdutosCriacaoAutomatica]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@ProdutosCriacaoAutomatica]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[DisponibilizaInfoProdutoDetalhe]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@DisponibilizaInfoProdutoDetalhe]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[DescricaoPontuacaoInicial]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@DescricaoPontuacaoInicial]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[CaracteristicasPontuacaoInicial]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@CaracteristicasPontuacaoInicial]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[LinkPontuacaoInicial]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@LinkPontuacaoInicial]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ImagemPontuacaoInicial]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@ImagemPontuacaoInicial]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[DescricaoSugereInativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@DescricaoSugereInativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[CaracteristicasSugereInativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@CaracteristicasSugereInativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[LinkSugereInativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@LinkSugereInativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ImagemSugereInativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@ImagemSugereInativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[AtualizacaoAutomaticaInativaSugestao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@AtualizacaoAutomaticaInativaSugestao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ProdutosConfiancaPreco]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@ProdutosConfiancaPreco]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[ProdutosConfiancaDisponibilidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@ProdutosConfiancaDisponibilidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[IndiceConfianca]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@IndiceConfianca]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[SupplierUpdate].[@Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Fornecedores].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@Nome]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@Morada]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="200" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@CodigoPostal]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="15" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@LocalidadePostal]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@Contribuinte]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@Vendedor]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@Telefone]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@Telemovel]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="15" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@SMS]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="15" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@Email]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@AcessoOnlineAtivo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@Username]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@Password]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@HorasValidadeSugestao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@ProdutosMatchingAutomatico]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@ProdutosCriacaoAutomatica]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@DisponibilizaInfoProdutoDetalhe]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@DescricaoPontuacaoInicial]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@CaracteristicasPontuacaoInicial]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@LinkPontuacaoInicial]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@ImagemPontuacaoInicial]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@DescricaoSugereInativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@CaracteristicasSugereInativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@LinkSugereInativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@ImagemSugereInativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@AtualizacaoAutomaticaInativaSugestao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@ProdutosConfiancaPreco]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@ProdutosConfiancaDisponibilidade]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@IndiceConfianca]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[SupplierUpdate].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="4153" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[SupplierUpdate]&#xD;&#xA;&#x9;@Codigo nvarchar(5), &#xD;&#xA;&#x9;@Nome nvarchar(50), &#xD;&#xA;&#x9;@Morada nvarchar(200), &#xD;&#xA;&#x9;@CodigoPostal nvarchar(15),&#xD;&#xA;&#x9;@LocalidadePostal nvarchar(50), &#xD;&#xA;&#x9;@Contribuinte nvarchar(20), &#xD;&#xA;&#x9;@Vendedor nvarchar(50), &#xD;&#xA;&#x9;@Telefone nvarchar(20), &#xD;&#xA;&#x9;@Telemovel nvarchar(15), &#xD;&#xA;&#x9;@SMS nvarchar(15), &#xD;&#xA;&#x9;@Email nvarchar(100), &#xD;&#xA;&#x9;@AcessoOnlineAtivo bit, &#xD;&#xA;&#x9;@Username nvarchar(20), &#xD;&#xA;&#x9;@Password nvarchar(20), &#xD;&#xA;&#x9;@HorasValidadeSugestao smallint, &#xD;&#xA;&#x9;@ProdutosMatchingAutomatico bit, &#xD;&#xA;&#x9;@ProdutosCriacaoAutomatica bit, &#xD;&#xA;&#x9;@DisponibilizaInfoProdutoDetalhe bit, &#xD;&#xA;&#x9;@DescricaoPontuacaoInicial smallint, &#xD;&#xA;&#x9;@CaracteristicasPontuacaoInicial smallint, &#xD;&#xA;&#x9;@LinkPontuacaoInicial smallint, &#xD;&#xA;&#x9;@ImagemPontuacaoInicial smallint, &#xD;&#xA;&#x9;@DescricaoSugereInativo bit, &#xD;&#xA;&#x9;@CaracteristicasSugereInativo bit, &#xD;&#xA;&#x9;@LinkSugereInativo bit, &#xD;&#xA;&#x9;@ImagemSugereInativo bit, &#xD;&#xA;&#x9;@AtualizacaoAutomaticaInativaSugestao bit, &#xD;&#xA;&#x9;@ProdutosConfiancaPreco float, &#xD;&#xA;&#x9;@ProdutosConfiancaDisponibilidade float, &#xD;&#xA;&#x9;@IndiceConfianca float, &#xD;&#xA;&#x9;@Inativo bit, &#xD;&#xA;&#x9;@Versao datetime &#xD;&#xA;&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[TaxCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([Codigo]) FROM [dbo].[Impostos]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="542" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[TaxCount]&#xD;&#xA;&#x9;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[TaxDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Impostos] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Impostos] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D02] ' + 'O registo que pretende eliminar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].[Impostos] Where [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Impostos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Impostos].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxDelete].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Impostos].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxDelete].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Impostos].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxDelete].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxDelete].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1524" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[TaxDelete]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[TaxInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Criacao smalldatetime, @Versao datetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Criacao = GETDATE()
	SET @Versao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[Impostos] ([Codigo], [Descricao], [DesignacaoFiscal], [Taxa], [Inativo], [Criacao], [Versao]) 
					VALUES (@Codigo, @Descricao, @DesignacaoFiscal, @Taxa, @Inativo, @Criacao, @Versao);
		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Impostos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Impostos].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Impostos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Impostos].[DesignacaoFiscal]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Impostos].[Taxa]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Impostos].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Impostos].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Impostos].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxInsert].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxInsert].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxInsert].[@DesignacaoFiscal]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxInsert].[@Taxa]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxInsert].[@Inativo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxInsert].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxInsert].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxInsert].[@DesignacaoFiscal]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxInsert].[@Taxa]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxInsert].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1213" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[TaxInsert]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Descricao nvarchar(50),&#xD;&#xA;&#x9;@DesignacaoFiscal nvarchar(50),&#xD;&#xA;&#x9;@Taxa float,&#xD;&#xA;&#x9;@Inativo bit&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[TaxMatchingCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([Codigo]) FROM [dbo].[ImpostosMatching]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxMatchingCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxMatchingCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="558" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[TaxMatchingCount]&#xD;&#xA;&#x9;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[TaxMatchingDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[ImpostosMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[ImpostosMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D02] ' + 'O registo que pretende eliminar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].[ImpostosMatching] Where [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxMatchingDelete].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxMatchingDelete].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxMatchingDelete].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxMatchingDelete].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxMatchingDelete].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxMatchingDelete].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1720" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[TaxMatchingDelete]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@Codigo nvarchar(128),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[TaxMatchingInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Criacao smalldatetime, @Versao datetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Criacao = GETDATE()
	SET @Versao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[ImpostosMatching] ([FornecedorCodigo], [Codigo], [Descricao], [MapTo], [Inativo], [Criacao], [Versao]) 
					VALUES (@FornecedorCodigo, @Codigo, @Descricao, @MapTo, @Inativo, @Criacao, @Versao);
		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxMatchingInsert].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxMatchingInsert].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxMatchingInsert].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxMatchingInsert].[@MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxMatchingInsert].[@Inativo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxMatchingInsert].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxMatchingInsert].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxMatchingInsert].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxMatchingInsert].[@MapTo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxMatchingInsert].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1240" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[TaxMatchingInsert]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@Codigo nvarchar(128),&#xD;&#xA;&#x9;@Descricao nvarchar(128),&#xD;&#xA;&#x9;@MapTo nvarchar(5),&#xD;&#xA;&#x9;@Inativo bit&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[TaxMatchingSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT matching.[FornecedorCodigo], fornecedores.[Nome] as FornecedorNome, matching.[Codigo], matching.[Descricao], 
							matching.[MapTo], matching.[Inativo], matching.[Criacao], matching.[Versao]				
						FROM [dbo].[ImpostosMatching] matching 
						INNER JOIN [dbo].[Fornecedores] fornecedores
							ON matching.[FornecedorCodigo] = fornecedores.[Codigo] AND fornecedores.[INATIVO]='+'''FALSE'''
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxMatchingSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxMatchingSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxMatchingSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxMatchingSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1114" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[TaxMatchingSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[TaxMatchingUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[ImpostosMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[ImpostosMatching] WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U02] ' + 'O registo que pretende alterar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NovaVersao datetime, @NumeroLinhasAfetadas int

	SET @NovaVersao = GETDATE()


	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[ImpostosMatching] SET [Descricao] = @Descricao,
									[MapTo] = @MapTo,
									[Inativo] = @Inativo,
									[Versao] = @NovaVersao
								WHERE [FornecedorCodigo] = @FornecedorCodigo AND [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxMatchingUpdate].[@FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxMatchingUpdate].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxMatchingUpdate].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxMatchingUpdate].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxMatchingUpdate].[@MapTo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxMatchingUpdate].[@Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[FornecedorCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ImpostosMatching].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxMatchingUpdate].[@FornecedorCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxMatchingUpdate].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxMatchingUpdate].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxMatchingUpdate].[@MapTo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxMatchingUpdate].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxMatchingUpdate].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1964" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[TaxMatchingUpdate]&#xD;&#xA;&#x9;@FornecedorCodigo nvarchar(5),&#xD;&#xA;&#x9;@Codigo nvarchar(128),&#xD;&#xA;&#x9;@Descricao nvarchar(128),&#xD;&#xA;&#x9;@MapTo nvarchar(5),&#xD;&#xA;&#x9;@Inativo bit,&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[TaxSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT i.[Codigo], i.[Descricao], i.[DesignacaoFiscal], i.[Taxa], i.[Inativo], i.[Criacao], i.[Versao]				
						FROM [dbo].[Impostos] i' 
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="838" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[TaxSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[TaxUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Impostos] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[Impostos] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U02] ' + 'O registo que pretende alterar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NovaVersao datetime, @NumeroLinhasAfetadas int

	SET @NovaVersao = GETDATE()


	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[Impostos] SET [Descricao] = @Descricao,
									[DesignacaoFiscal] = @DesignacaoFiscal,
									[Taxa] = @Taxa,
									[Inativo] = @Inativo,
									[Versao] = @NovaVersao
								WHERE [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Impostos]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Impostos].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxUpdate].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Impostos].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxUpdate].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Impostos].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxUpdate].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Impostos].[DesignacaoFiscal]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxUpdate].[@DesignacaoFiscal]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Impostos].[Taxa]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxUpdate].[@Taxa]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Impostos].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TaxUpdate].[@Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Impostos].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Impostos].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxUpdate].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxUpdate].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxUpdate].[@DesignacaoFiscal]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxUpdate].[@Taxa]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxUpdate].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TaxUpdate].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1842" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[TaxUpdate]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Descricao nvarchar(50),&#xD;&#xA;&#x9;@DesignacaoFiscal nvarchar(50),&#xD;&#xA;&#x9;@Taxa float,&#xD;&#xA;&#x9;@Inativo bit,&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[TermosPreocupantes]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TermosPreocupantes].[Termo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TermosPreocupantes].[Indice]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[tinyint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TermosPreocupantes].[Notas]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TermosPreocupantes].[Inativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TermosPreocupantes].[Criacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[TermosPreocupantes].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="92" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlUniqueConstraint" Name="[dbo].[UC_CotacoesAvisos]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[CotacoesAvisos].[FornecedorCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[CotacoesAvisos].[Data]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[CotacoesAvisos].[_ProdutoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[CotacoesAvisos].[_ComplementoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[CotacoesAvisos].[AvisoTipoCodigo]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[CotacoesAvisos]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="36" />
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[UserCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([Username]) FROM [dbo].[Utilizadores]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar
RETURN 0]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UserCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="559" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[UserCount]&#xD;&#xA;&#x9;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[UserDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [Username] FROM [dbo].[Utilizadores] WHERE [Username] = @Username)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Username] FROM [dbo].[Utilizadores] WHERE [Username] = @Username AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D02] ' + 'O registo que pretende eliminar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].[Utilizadores] Where [Username] = @Username

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[Username]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserDelete].[@Username]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserDelete].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[Username]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UserDelete].[@Username]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UserDelete].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1556" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[UserDelete]&#xD;&#xA;&#x9;@Username nvarchar(20),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[UserInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Criacao smalldatetime, @Versao datetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Criacao = GETDATE()
	SET @Versao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[Utilizadores] ([Username], [Password], [Nome], [Email], [Mobile], [Sms], [Administrador], [IdiomaCodigo], [Inativo], [Criacao], [Versao]) 
					VALUES (@Username, HASHBYTES('SHA2_512', @Password), @Nome, @Email, @Mobile, @Sms, @Administrador, @IdiomaCodigo, @Inativo, @Criacao, @Versao);
		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[Username]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[Password]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[Nome]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[Mobile]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[Sms]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[Administrador]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[IdiomaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserInsert].[@Username]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserInsert].[@Password]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserInsert].[@Nome]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserInsert].[@Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserInsert].[@Mobile]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserInsert].[@Sms]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserInsert].[@Administrador]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserInsert].[@IdiomaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserInsert].[@Inativo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UserInsert].[@Username]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UserInsert].[@Password]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UserInsert].[@Nome]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UserInsert].[@Email]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UserInsert].[@Mobile]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="15" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UserInsert].[@Sms]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="15" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UserInsert].[@Administrador]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UserInsert].[@IdiomaCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UserInsert].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1413" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[UserInsert]&#xD;&#xA;&#x9;@Username nvarchar(20),&#xD;&#xA;&#x9;@Password nvarchar(250),&#xD;&#xA;&#x9;@Nome nvarchar(50),&#xD;&#xA;&#x9;@Email nvarchar(100),&#xD;&#xA;&#x9;@Mobile nvarchar(15),&#xD;&#xA;&#x9;@Sms nvarchar(15),&#xD;&#xA;&#x9;@Administrador bit,&#xD;&#xA;&#x9;@IdiomaCodigo nvarchar(5),&#xD;&#xA;&#x9;@Inativo bit&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[UserSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT utilizadores.[Username], utilizadores.[Password], utilizadores.[Nome], utilizadores.[Email], utilizadores.[Mobile], utilizadores.[Sms], utilizadores.[Administrador], utilizadores.[IdiomaCodigo], utilizadores.[Inativo], utilizadores.[Criacao], utilizadores.[Versao]				
						FROM [dbo].[Utilizadores] utilizadores' 
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UserSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UserSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1023" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[UserSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[UserUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [Username] FROM [dbo].[Utilizadores] WHERE [Username] = @Username)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Username] FROM [dbo].[Utilizadores] WHERE [Username] = @Username AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U02] ' + 'O registo que pretende alterar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NovaVersao datetime, @NumeroLinhasAfetadas int

	SET @NovaVersao = GETDATE()


	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[Utilizadores] SET [Password] = HASHBYTES('SHA2_512', @Password),
									[Nome] = @Nome,
									[Email] = @Email,
									[Mobile] = @Mobile,
									[Sms] = @Sms,
									[Administrador] = @Administrador,
									[IdiomaCodigo] = @IdiomaCodigo,
									[Inativo] = @Inativo,
									[Versao] = @NovaVersao

								WHERE [Username] = @Username

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[Username]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserUpdate].[@Username]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserUpdate].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[Password]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserUpdate].[@Password]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[Nome]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserUpdate].[@Nome]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserUpdate].[@Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[Mobile]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserUpdate].[@Mobile]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[Sms]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserUpdate].[@Sms]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[Administrador]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserUpdate].[@Administrador]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[IdiomaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserUpdate].[@IdiomaCodigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UserUpdate].[@Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Utilizadores].[Username]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UserUpdate].[@Username]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UserUpdate].[@Password]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UserUpdate].[@Nome]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UserUpdate].[@Email]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UserUpdate].[@Mobile]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="15" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UserUpdate].[@Sms]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="15" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UserUpdate].[@Administrador]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UserUpdate].[@IdiomaCodigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UserUpdate].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UserUpdate].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="2108" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[UserUpdate]&#xD;&#xA;&#x9;@Username nvarchar(20),&#xD;&#xA;&#x9;@Password nvarchar(250),&#xD;&#xA;&#x9;@Nome nvarchar(50),&#xD;&#xA;&#x9;@Email nvarchar(100),&#xD;&#xA;&#x9;@Mobile nvarchar(15),&#xD;&#xA;&#x9;@Sms nvarchar(15),&#xD;&#xA;&#x9;@Administrador bit,&#xD;&#xA;&#x9;@IdiomaCodigo nvarchar(5),&#xD;&#xA;&#x9;@Inativo bit,&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Utilizadores]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Utilizadores].[Username]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Utilizadores].[Password]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Utilizadores].[Nome]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Utilizadores].[Email]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Utilizadores].[Mobile]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="15" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Utilizadores].[Sms]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="15" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Utilizadores].[Administrador]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Utilizadores].[IdiomaCodigo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Utilizadores].[Inativo]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Utilizadores].[Criacao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Utilizadores].[Versao]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="93" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="76" />
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[ViewProductSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT * FROM ProdutosAtuaisView'
							 
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ViewProductSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ViewProductSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ViewProductSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ViewProductSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="750" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[ViewProductSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[WarningTypeCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([Codigo]) FROM [dbo].[AvisosTipo]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WarningTypeCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WarningTypeCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="552" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[WarningTypeCount]&#xD;&#xA;&#x9;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[WarningTypeDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[AvisosTipo] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[AvisosTipo] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D02] ' + 'O registo que pretende eliminar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].[AvisosTipo] Where [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AvisosTipo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AvisosTipo].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WarningTypeDelete].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AvisosTipo].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WarningTypeDelete].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AvisosTipo].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WarningTypeDelete].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WarningTypeDelete].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1538" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[WarningTypeDelete]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[WarningTypeInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Criacao smalldatetime, @Versao datetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Criacao = GETDATE()
	SET @Versao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[AvisosTipo] ([Codigo], [Descricao], [Gravidade], [Notas], [Icon], [Inativo], [Criacao], [Versao]) 
					VALUES (@Codigo, @Descricao, @Gravidade, @Notas, @Icon, @Inativo, @Criacao, @Versao);
		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AvisosTipo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AvisosTipo].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AvisosTipo].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AvisosTipo].[Gravidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AvisosTipo].[Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AvisosTipo].[Icon]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AvisosTipo].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AvisosTipo].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AvisosTipo].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WarningTypeInsert].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WarningTypeInsert].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WarningTypeInsert].[@Gravidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WarningTypeInsert].[@Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WarningTypeInsert].[@Icon]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WarningTypeInsert].[@Inativo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WarningTypeInsert].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WarningTypeInsert].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WarningTypeInsert].[@Gravidade]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WarningTypeInsert].[@Notas]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WarningTypeInsert].[@Icon]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WarningTypeInsert].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1247" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[WarningTypeInsert]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Descricao nvarchar(128),&#xD;&#xA;&#x9;@Gravidade smallint,&#xD;&#xA;&#x9;@Notas nvarchar(256),&#xD;&#xA;&#x9;@Icon nvarchar(20),&#xD;&#xA;&#x9;@Inativo bit&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[WarningTypeSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT avisosTipo.[Codigo], avisosTipo.[Descricao], avisosTipo.[Gravidade], avisosTipo.[Notas], avisosTipo.[Icon], avisosTipo.[Inativo], avisosTipo.[Criacao], avisosTipo.[Versao]				
						FROM [dbo].[AvisosTipo] avisosTipo' 
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WarningTypeSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WarningTypeSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WarningTypeSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WarningTypeSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="933" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[WarningTypeSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[WarningTypeUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[AvisosTipo] WHERE [Codigo] = @Codigo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Codigo] FROM [dbo].[AvisosTipo] WHERE [Codigo] = @Codigo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U02] ' + 'O registo que pretende alterar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NovaVersao datetime, @NumeroLinhasAfetadas int

	SET @NovaVersao = GETDATE()


	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[AvisosTipo] SET [Descricao] = @Descricao,
										[Gravidade]=@Gravidade,
										[Notas]=@Notas,
										[Icon]=@Icon,
										[Inativo] = @Inativo,
										[Versao] = @NovaVersao
									WHERE [Codigo] = @Codigo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AvisosTipo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AvisosTipo].[Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WarningTypeUpdate].[@Codigo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AvisosTipo].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WarningTypeUpdate].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AvisosTipo].[Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WarningTypeUpdate].[@Descricao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AvisosTipo].[Gravidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WarningTypeUpdate].[@Gravidade]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AvisosTipo].[Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WarningTypeUpdate].[@Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AvisosTipo].[Icon]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WarningTypeUpdate].[@Icon]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AvisosTipo].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WarningTypeUpdate].[@Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AvisosTipo].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AvisosTipo].[Codigo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WarningTypeUpdate].[@Codigo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WarningTypeUpdate].[@Descricao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="128" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WarningTypeUpdate].[@Gravidade]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WarningTypeUpdate].[@Notas]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WarningTypeUpdate].[@Icon]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WarningTypeUpdate].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WarningTypeUpdate].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1891" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[WarningTypeUpdate]&#xD;&#xA;&#x9;@Codigo nvarchar(5),&#xD;&#xA;&#x9;@Descricao nvarchar(128),&#xD;&#xA;&#x9;@Gravidade smallint,&#xD;&#xA;&#x9;@Notas nvarchar(256),&#xD;&#xA;&#x9;@Icon nvarchar(20),&#xD;&#xA;&#x9;@Inativo bit,&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[WorryingTermCount]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @select nvarchar(1024), @where nvarchar(512), @sqlQuery nvarchar(2048)

	SET @select = 'SELECT Count([Termo]) FROM [dbo].[TermosPreocupantes]' 

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @sqlQuery = @select + @where


	EXEC(@sqlQuery)

RETURN  -- This SP must be used with ExecuteScalar]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WorryingTermCount].[@WhereClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WorryingTermCount].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="512" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="560" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[WorryingTermCount]&#xD;&#xA;&#x9;@WhereClause nvarchar(512) = ''&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[WorryingTermDelete]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O CODIGO EXISTE
	IF NOT EXISTS(SELECT [Termo] FROM [dbo].[TermosPreocupantes] WHERE [Termo] = @Termo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D01] ' + 'O registo que pretende eliminar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Termo] FROM [dbo].[TermosPreocupantes] WHERE [Termo] = @Termo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D02] ' + 'O registo que pretende eliminar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NumeroLinhasAfetadas int


	-- ELIMINAR O REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF
		 
		-- ELIMINAR REGISTO
		DELETE FROM [dbo].[TermosPreocupantes] Where [Termo] = @Termo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH
		
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-D10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TermosPreocupantes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TermosPreocupantes].[Termo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WorryingTermDelete].[@Termo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TermosPreocupantes].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WorryingTermDelete].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TermosPreocupantes].[Termo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WorryingTermDelete].[@Termo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WorryingTermDelete].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1554" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[WorryingTermDelete]&#xD;&#xA;&#x9;@Termo nvarchar(5),&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[WorryingTermInsert]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Criacao smalldatetime, @Versao datetime, @NumeroLinhasAfetadas int, @Erro nvarchar(255)

	SET @Criacao = GETDATE()
	SET @Versao = GETDATE()


	-- INSERÇÃO DO REGISTO
	BEGIN TRY
		 
		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- INSERIR REGISTO
		INSERT INTO [dbo].[TermosPreocupantes] ([Termo], [Indice], [Notas], [Inativo], [Criacao], [Versao]) 
					VALUES (@Termo, @Indice, @Notas, @Inativo, @Criacao, @Versao);
		
		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON),  e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS, DESFAZER TRANSACÇÃO
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-I10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[smalldatetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TermosPreocupantes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TermosPreocupantes].[Termo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TermosPreocupantes].[Indice]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TermosPreocupantes].[Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TermosPreocupantes].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TermosPreocupantes].[Criacao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TermosPreocupantes].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WorryingTermInsert].[@Termo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WorryingTermInsert].[@Indice]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WorryingTermInsert].[@Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WorryingTermInsert].[@Inativo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WorryingTermInsert].[@Termo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WorryingTermInsert].[@Indice]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[tinyint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WorryingTermInsert].[@Notas]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WorryingTermInsert].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1154" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[WorryingTermInsert]&#xD;&#xA;&#x9;@Termo nvarchar(50),&#xD;&#xA;&#x9;@Indice tinyint,&#xD;&#xA;&#x9;@Notas nvarchar(256),&#xD;&#xA;&#x9;@Inativo bit&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[WorryingTermSelect]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @select nvarchar(2048), @where nvarchar(1024), @orderBy nvarchar(256), @sqlQuery nvarchar(4000)
	

	SET @select = 'SELECT tp.[Termo], tp.[Indice], tp.[Notas], tp.[Inativo], tp.[Criacao], tp.[Versao]				
						FROM [dbo].[TermosPreocupantes] tp' 
	

	SET @where = LTRIM(RTRIM(@WhereClause))
	IF Len(@where) > 0
	BEGIN
		SET @where = ' WHERE ' + @where
	END


	SET @orderBy = LTRIM(RTRIM(@OrderByClause))
	IF LEN(@orderBy) > 0
	BEGIN
		SET @orderBy = ' ORDER BY ' + @orderBy
	END


	SET @sqlQuery = @select + @where + @orderBy  


	EXEC(@sqlQuery)


RETURN @@ROWCOUNT]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WorryingTermSelect].[@WhereClause]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WorryingTermSelect].[@OrderByClause]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WorryingTermSelect].[@WhereClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WorryingTermSelect].[@OrderByClause]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA['']]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="839" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[WorryingTermSelect]&#xD;&#xA;&#x9;@WhereClause nvarchar(1024) = '',&#x9;&#x9;&#x9;-- ex1: Codigo IN ('001', '002'); ex2: Descricao LIKE '_este'; ex3: Descricao LIKE '%est%'&#xD;&#xA;&#x9;@OrderByClause nvarchar(256) = ''&#x9;&#x9;&#x9;-- ex: Codigo desc&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[WorryingTermUpdate]">
			<Property Name="BodyScript">
				<Value><![CDATA[

	DECLARE @Erro nvarchar(255)


	-- VALIDAR SE O REGISTO EXISTE
	IF NOT EXISTS(SELECT [Termo] FROM [dbo].[TermosPreocupantes] WHERE [Termo] = @Termo)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U01] ' + 'O registo que pretende alterar não existe!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END

	-- VALIDAR SE A VERSÃO AINDA É A MESMA
	IF NOT EXISTS(SELECT [Termo] FROM [dbo].[TermosPreocupantes] WHERE [Termo] = @Termo AND [Versao] = @Versao)
	BEGIN
		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U02] ' + 'O registo que pretende alterar, já foi alterado desde que o abriu!';
		RAISERROR (@Erro, 15, 1)
		RETURN 0
	END


	-- TUDO OK PARA SEGUIR EM FRENTE
	DECLARE @NovaVersao datetime, @NumeroLinhasAfetadas int

	SET @NovaVersao = GETDATE()


	-- ALTERAÇÃO DO REGISTO
	BEGIN TRY

		-- INICIA CONTAGEM DE @@ROWCOUNT (para quando usado o ExecuteNonQuery())
		SET NOCOUNT OFF

		-- ALTERAR REGISTO
		UPDATE [dbo].[TermosPreocupantes] SET [Indice] = @Indice,
									[Notas] = @Notas,
									[Inativo] = @Inativo,
									[Versao] = @NovaVersao
								WHERE [Termo] = @Termo

		SET @NumeroLinhasAfetadas = @@ROWCOUNT -- GUARDAR O NUMERO DE LINHAS AFETADAS

		-- ACABA CONTAGEM DE @@ROWCOUNT
		SET NOCOUNT ON

		-- RETORNAR O NUMERO DE LINHAS AFETADAS
		-- Quando usado o ExecuteNonQuery é o @@ROWCOUNT que é lido (SET NOCOUNT OFF/ON), e não esta variável
		RETURN @NumeroLinhasAfetadas

	END TRY


	-- SE EXISTIRAM ERROS
	BEGIN CATCH

		-- DISPARAR UM ERRO
		SET @Erro = '[WhereToBuy-U10] ' + ERROR_MESSAGE();
		RAISERROR (@Erro, 15, 1)
		RETURN 0

	END CATCH]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TermosPreocupantes]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TermosPreocupantes].[Termo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WorryingTermUpdate].[@Termo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TermosPreocupantes].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WorryingTermUpdate].[@Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TermosPreocupantes].[Indice]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WorryingTermUpdate].[@Indice]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TermosPreocupantes].[Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WorryingTermUpdate].[@Notas]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TermosPreocupantes].[Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[WorryingTermUpdate].[@Inativo]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TermosPreocupantes].[Versao]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TermosPreocupantes].[Termo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WorryingTermUpdate].[@Termo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WorryingTermUpdate].[@Indice]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[tinyint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WorryingTermUpdate].[@Notas]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="256" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WorryingTermUpdate].[@Inativo]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[WorryingTermUpdate].[@Versao]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1786" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[WorryingTermUpdate]&#xD;&#xA;&#x9;@Termo nvarchar(50),&#xD;&#xA;&#x9;@Indice tinyint,&#xD;&#xA;&#x9;@Notas nvarchar(256),&#xD;&#xA;&#x9;@Inativo bit,&#xD;&#xA;&#x9;@Versao datetime&#xD;&#xA;AS" />
			</Annotation>
		</Element>
	</Model>
</DataSchemaModel>